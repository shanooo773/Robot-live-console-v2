{"version":3,"file":"vendors-node_modules_theia_notebook_lib_browser_service_notebook-model-resolver-service_js-no-a94865.js","mappings":"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AC,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC;QAC7F,CAAC;QACD,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,QAAQ,CAAC,CAAiB;QACtB,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC;IAC3C,CAAC;IAED,OAAO;;QACH,UAAI,CAAC,cAAc,0CAAE,UAAU,EAAE,CAAC;IACtC,CAAC;CACJ;AAnCY,0DAAuB;kCAAvB,uBAAuB;IADnC,0BAAU,GAAE;GACA,uBAAuB,CAmCnC;;;;;;;;;;;AC5DD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,KAA4D;AAC9D,EAAE,CACmG;AACrG,CAAC,uBAAuB;;AAExB;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,sBAAsB,sBAAsB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,UAAU;AACV;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX,UAAU;AACV;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA,mCAAmC;AACnC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAA0B,kBAAkB;AAC5C;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,0CAA0C;AAC1C;AACA;AACA,WAAW;AACX,oCAAoC;AACpC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,eAAe;AACf,cAAc;AACd;AACA;AACA,YAAY;AACZ;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,gBAAgB,uBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,eAAe;AACf;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uBAAuB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,mBAAmB;AACnB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf,cAAc;AACd;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,cAAc;AACd;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,wBAAwB,YAAY;AACpC;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,UAAU;AACV;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;ACpxDY;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;;AAEF,iBAAiB,mBAAO,CAAC,4EAAa;;AAEtC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kBAAe;AACf,oC;;;;;;;;;;;ACba;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;;AAEF,oDAAoD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,iCAAiC;;AAEhP,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,aAAa,mBAAO,CAAC,4CAAO;;AAE5B;;AAEA,iBAAiB,mBAAO,CAAC,sDAAY;;AAErC,wBAAwB,mBAAO,CAAC,yFAAmB;;AAEnD;;AAEA,uCAAuC,uCAAuC;;AAE9E,+CAA+C,iBAAiB,qBAAqB,oCAAoC,6DAA6D,sBAAsB;;AAE5M,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,mCAAmC;AACtD;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,kBAAe;;;AAGf;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC","sources":["webpack:///./node_modules/@theia/notebook/src/browser/contributions/cell-operations.ts?","webpack:///./node_modules/@theia/notebook/src/browser/contributions/notebook-actions-contribution.ts?","webpack:///./node_modules/@theia/notebook/src/browser/contributions/notebook-cell-actions-contribution.ts?","webpack:///./node_modules/@theia/notebook/src/browser/contributions/notebook-context-keys.ts?","webpack:///./node_modules/@theia/notebook/src/browser/contributions/notebook-preferences.ts?","webpack:///./node_modules/@theia/notebook/src/browser/notebook-editor-widget.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/notebook-open-handler.ts?","webpack:///./node_modules/@theia/notebook/src/browser/notebook-output-utils.ts?","webpack:///./node_modules/@theia/notebook/src/browser/notebook-renderer-registry.ts?","webpack:///./node_modules/@theia/notebook/src/browser/notebook-type-registry.ts?","webpack:///./node_modules/@theia/notebook/src/browser/renderers/cell-output-webview.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-cell-editor-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-cell-status-bar-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-clipboard-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-context-manager.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-editor-widget-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-execution-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-execution-state-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-kernel-history-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-kernel-quick-pick-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-kernel-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-model-resolver-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-monaco-text-model-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-options.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-renderer-messaging-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/service/notebook-service.ts?","webpack:///./node_modules/@theia/notebook/src/browser/view-model/notebook-cell-model.ts?","webpack:///./node_modules/@theia/notebook/src/browser/view-model/notebook-cell-output-model.ts?","webpack:///./node_modules/@theia/notebook/src/browser/view-model/notebook-model.ts?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-cell-editor.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-cell-list-view.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-cell-toolbar-factory.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-cell-toolbar.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-code-cell-view.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-find-widget.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-main-toolbar.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-markdown-cell-view.tsx?","webpack:///./node_modules/@theia/notebook/src/browser/view/notebook-viewport-service.ts?","webpack:///./node_modules/advanced-mark.js/dist/mark.js?","webpack:///./node_modules/react-perfect-scrollbar/lib/index.js?","webpack:///./node_modules/react-perfect-scrollbar/lib/scrollbar.js?"],"sourcesContent":["// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { CellEditType, CellKind } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\n\n/**\n * a collection of different reusable notbook cell operations\n */\n\nexport function changeCellType(notebookModel: NotebookModel, cell: NotebookCellModel, type: CellKind, language?: string): void {\n    if (cell.cellKind === type) {\n        return;\n    }\n    if (type === CellKind.Markup) {\n        language = 'markdown';\n    } else {\n        language ??= cell.language;\n    }\n    notebookModel.applyEdits([{\n        editType: CellEditType.Replace,\n        index: notebookModel.cells.indexOf(cell),\n        count: 1,\n        cells: [{\n            ...cell.getData(),\n            cellKind: type,\n            language\n        }]\n    }], true);\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Command, CommandContribution, CommandHandler, CommandRegistry, MenuContribution, MenuModelRegistry, nls, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ApplicationShell, codicon, KeybindingContribution, KeybindingRegistry } from '@theia/core/lib/browser';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from '../service/notebook-service';\nimport { CellEditType, CellKind, NotebookCommand } from '../../common';\nimport { NotebookKernelQuickPickService } from '../service/notebook-kernel-quick-pick-service';\nimport { NotebookExecutionService } from '../service/notebook-execution-service';\nimport { NotebookEditorWidgetService } from '../service/notebook-editor-widget-service';\nimport {\n    NOTEBOOK_CELL_CURSOR_FIRST_LINE, NOTEBOOK_CELL_CURSOR_LAST_LINE,\n    NOTEBOOK_CELL_FOCUSED, NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_HAS_OUTPUTS, NOTEBOOK_OUTPUT_FOCUSED\n} from './notebook-context-keys';\nimport { NotebookClipboardService } from '../service/notebook-clipboard-service';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\n\nexport namespace NotebookCommands {\n    export const ADD_NEW_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-cell',\n        iconClass: codicon('add')\n    });\n\n    export const ADD_NEW_MARKDOWN_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-markdown-cell',\n        iconClass: codicon('add'),\n        tooltip: nls.localizeByDefault('Add Markdown Cell')\n    } as NotebookCommand);\n\n    export const ADD_NEW_CODE_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-code-cell',\n        iconClass: codicon('add'),\n        tooltip: nls.localizeByDefault('Add Code Cell')\n    } as NotebookCommand);\n\n    export const SELECT_KERNEL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.selectKernel',\n        category: 'Notebook',\n        iconClass: codicon('server-environment')\n    });\n\n    export const EXECUTE_NOTEBOOK_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.execute',\n        category: 'Notebook',\n        iconClass: codicon('run-all')\n    });\n\n    export const CLEAR_ALL_OUTPUTS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.clear-all-outputs',\n        category: 'Notebook',\n        iconClass: codicon('clear-all')\n    });\n\n    export const CHANGE_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.change-selected-cell',\n        category: 'Notebook',\n    });\n\n    export const CUT_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.cut',\n        category: 'Notebook',\n    });\n\n    export const COPY_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.copy',\n        category: 'Notebook',\n    });\n\n    export const PASTE_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.paste',\n        category: 'Notebook',\n    });\n\n    export const NOTEBOOK_FIND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.find',\n        category: 'Notebook',\n    });\n\n    export const CENTER_ACTIVE_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.centerActiveCell',\n        category: 'Notebook',\n    });\n}\n\nexport enum CellChangeDirection {\n    Up = 'up',\n    Down = 'down'\n}\n\n@injectable()\nexport class NotebookActionsContribution implements CommandContribution, MenuContribution, KeybindingContribution {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(NotebookKernelQuickPickService)\n    protected notebookKernelQuickPickService: NotebookKernelQuickPickService;\n\n    @inject(NotebookExecutionService)\n    protected notebookExecutionService: NotebookExecutionService;\n\n    @inject(ApplicationShell)\n    protected shell: ApplicationShell;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorWidgetService: NotebookEditorWidgetService;\n\n    @inject(NotebookClipboardService)\n    protected notebookClipboardService: NotebookClipboardService;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    registerCommands(commands: CommandRegistry): void {\n        commands.registerCommand(NotebookCommands.ADD_NEW_CELL_COMMAND, {\n            execute: (notebookModel: NotebookModel, cellKind: CellKind = CellKind.Markup, index?: number | 'above' | 'below', focusContainer?: boolean) => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n\n                let insertIndex: number = 0;\n                if (typeof index === 'number' && index >= 0) {\n                    insertIndex = index;\n                } else if (notebookModel.selectedCell && typeof index === 'string') {\n                    // if index is -1 insert below otherwise at the index of the selected cell which is above the selected.\n                    insertIndex = notebookModel.cells.indexOf(notebookModel.selectedCell) + (index === 'below' ? 1 : 0);\n                }\n\n                let cellLanguage: string = 'markdown';\n                if (cellKind === CellKind.Code) {\n                    cellLanguage = this.notebookService.getCodeCellLanguage(notebookModel);\n                }\n\n                notebookModel.applyEdits([{\n                    editType: CellEditType.Replace,\n                    index: insertIndex,\n                    count: 0,\n                    cells: [{\n                        cellKind,\n                        language: cellLanguage,\n                        source: '',\n                        outputs: [],\n                        metadata: {},\n                    }]\n                }], true);\n                if (focusContainer) {\n                    notebookModel.selectedCell?.requestBlurEditor();\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.ADD_NEW_MARKDOWN_CELL_COMMAND, this.editableCommandHandler(\n            notebookModel => commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, notebookModel, CellKind.Markup, 'below')\n        ));\n\n        commands.registerCommand(NotebookCommands.ADD_NEW_CODE_CELL_COMMAND, this.editableCommandHandler(\n            notebookModel => commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, notebookModel, CellKind.Code, 'below')\n        ));\n\n        commands.registerCommand(NotebookCommands.SELECT_KERNEL_COMMAND, this.editableCommandHandler(\n            notebookModel => this.notebookKernelQuickPickService.showQuickPick(notebookModel)\n        ));\n\n        commands.registerCommand(NotebookCommands.EXECUTE_NOTEBOOK_COMMAND, this.editableCommandHandler(\n            notebookModel => this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells)\n        ));\n\n        commands.registerCommand(NotebookCommands.CLEAR_ALL_OUTPUTS_COMMAND, this.editableCommandHandler(\n            notebookModel => notebookModel.applyEdits(notebookModel.cells.map(cell => ({\n                editType: CellEditType.Output,\n                handle: cell.handle, deleteCount: cell.outputs.length, outputs: []\n            })), false)\n        ));\n\n        commands.registerCommand(NotebookCommands.CHANGE_SELECTED_CELL,\n            {\n                execute: (change: number | CellChangeDirection) => {\n                    const focusedEditor = this.notebookEditorWidgetService.focusedEditor;\n                    const model = focusedEditor?.model;\n                    if (model && typeof change === 'number') {\n                        model.setSelectedCell(model.cells[change]);\n                    } else if (model && model.selectedCell) {\n                        const currentIndex = model.cells.indexOf(model.selectedCell);\n                        const shouldFocusEditor = this.contextKeyService.match('editorTextFocus');\n\n                        if (change === CellChangeDirection.Up && currentIndex > 0) {\n                            model.setSelectedCell(model.cells[currentIndex - 1]);\n                            if ((model.selectedCell?.cellKind === CellKind.Code\n                                || (model.selectedCell?.cellKind === CellKind.Markup && model.selectedCell?.editing)) && shouldFocusEditor) {\n                                model.selectedCell.requestFocusEditor('lastLine');\n                            }\n                        } else if (change === CellChangeDirection.Down && currentIndex < model.cells.length - 1) {\n                            model.setSelectedCell(model.cells[currentIndex + 1]);\n                            if ((model.selectedCell?.cellKind === CellKind.Code\n                                || (model.selectedCell?.cellKind === CellKind.Markup && model.selectedCell?.editing)) && shouldFocusEditor) {\n                                model.selectedCell.requestFocusEditor();\n                            }\n                        }\n\n                        if (model.selectedCell.cellKind === CellKind.Markup) {\n                            // since were losing focus from the cell editor, we need to focus the notebook editor again\n                            focusedEditor?.node.focus();\n                        }\n                    }\n                }\n            }\n        );\n        commands.registerCommand({ id: 'list.focusUp' }, {\n            execute: () => commands.executeCommand(NotebookCommands.CHANGE_SELECTED_CELL.id, CellChangeDirection.Up)\n        });\n        commands.registerCommand({ id: 'list.focusDown' }, {\n            execute: () => commands.executeCommand(NotebookCommands.CHANGE_SELECTED_CELL.id, CellChangeDirection.Down)\n        });\n\n        commands.registerCommand(NotebookCommands.CUT_SELECTED_CELL, this.editableCommandHandler(\n            () => {\n                const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                const selectedCell = model?.selectedCell;\n                if (selectedCell) {\n                    model.applyEdits([{ editType: CellEditType.Replace, index: model.cells.indexOf(selectedCell), count: 1, cells: [] }], true);\n                    this.notebookClipboardService.copyCell(selectedCell);\n                }\n            }));\n\n        commands.registerCommand(NotebookCommands.COPY_SELECTED_CELL, {\n            execute: () => {\n                const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                const selectedCell = model?.selectedCell;\n                if (selectedCell) {\n                    this.notebookClipboardService.copyCell(selectedCell);\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.PASTE_CELL, {\n            isEnabled: () => !Boolean(this.notebookEditorWidgetService.focusedEditor?.model?.readOnly),\n            isVisible: () => !Boolean(this.notebookEditorWidgetService.focusedEditor?.model?.readOnly),\n            execute: (position?: 'above') => {\n                const copiedCell = this.notebookClipboardService.getCell();\n                if (copiedCell) {\n                    const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                    const insertIndex = model?.selectedCell ? model.cells.indexOf(model.selectedCell) + (position === 'above' ? 0 : 1) : 0;\n                    model?.applyEdits([{ editType: CellEditType.Replace, index: insertIndex, count: 0, cells: [copiedCell] }], true);\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.NOTEBOOK_FIND, {\n            execute: () => {\n                this.notebookEditorWidgetService.focusedEditor?.showFindWidget();\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.CENTER_ACTIVE_CELL, {\n            execute: (editor?: NotebookEditorWidget) => {\n                const model = editor ? editor.model : this.notebookEditorWidgetService.focusedEditor?.model;\n                model?.selectedCell?.requestCenterEditor();\n            }\n        });\n\n    }\n\n    protected editableCommandHandler(execute: (notebookModel: NotebookModel) => void): CommandHandler {\n        return {\n            isEnabled: (item: URI | NotebookModel) => this.withModel(item, model => !Boolean(model?.readOnly), false),\n            isVisible: (item: URI | NotebookModel) => this.withModel(item, model => !Boolean(model?.readOnly), false),\n            execute: (uri: URI | NotebookModel) => {\n                this.withModel(uri, execute, undefined);\n            }\n        };\n    }\n\n    protected withModel<T>(item: URI | NotebookModel, execute: (notebookModel: NotebookModel) => T, defaultValue: T): T {\n        if (item instanceof URI) {\n            const model = this.notebookService.getNotebookEditorModel(item);\n            if (!model) {\n                return defaultValue;\n            }\n            item = model;\n        }\n        return execute(item);\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        // independent submenu for plugins to add commands\n        menus.registerSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR, 'Notebook Main Toolbar');\n        // Add Notebook Cell items\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP, {\n            commandId: NotebookCommands.ADD_NEW_CODE_CELL_COMMAND.id,\n            label: nls.localizeByDefault('Code'),\n            icon: codicon('add'),\n        });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP, {\n            commandId: NotebookCommands.ADD_NEW_MARKDOWN_CELL_COMMAND.id,\n            label: nls.localizeByDefault('Markdown'),\n            icon: codicon('add'),\n        });\n\n        // Execution related items\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP, {\n            commandId: NotebookCommands.EXECUTE_NOTEBOOK_COMMAND.id,\n            label: nls.localizeByDefault('Run All'),\n            icon: codicon('run-all'),\n            order: '10'\n        });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP, {\n            commandId: NotebookCommands.CLEAR_ALL_OUTPUTS_COMMAND.id,\n            label: nls.localizeByDefault('Clear All Outputs'),\n            icon: codicon('clear-all'),\n            order: '30',\n            when: NOTEBOOK_HAS_OUTPUTS\n        });\n\n        menus.registerSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU, '');\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        keybindings.registerKeybindings(\n            {\n                command: NotebookCommands.CHANGE_SELECTED_CELL.id,\n                keybinding: 'up',\n                args: CellChangeDirection.Up,\n                when: `(!editorTextFocus || ${NOTEBOOK_CELL_CURSOR_FIRST_LINE}) && !suggestWidgetVisible && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.CHANGE_SELECTED_CELL.id,\n                keybinding: 'down',\n                args: CellChangeDirection.Down,\n                when: `(!editorTextFocus || ${NOTEBOOK_CELL_CURSOR_LAST_LINE}) && !suggestWidgetVisible && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.CUT_SELECTED_CELL.id,\n                keybinding: 'ctrlcmd+x',\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && !inputFocus && !${NOTEBOOK_OUTPUT_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.COPY_SELECTED_CELL.id,\n                keybinding: 'ctrlcmd+c',\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && !inputFocus && !${NOTEBOOK_OUTPUT_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.PASTE_CELL.id,\n                keybinding: 'ctrlcmd+v',\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && !inputFocus && !${NOTEBOOK_OUTPUT_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.NOTEBOOK_FIND.id,\n                keybinding: 'ctrlcmd+f',\n                when: `${NOTEBOOK_EDITOR_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.CENTER_ACTIVE_CELL.id,\n                keybinding: 'ctrlcmd+l',\n                when: `${NOTEBOOK_EDITOR_FOCUSED}`\n            }\n        );\n    }\n\n}\n\nexport namespace NotebookMenus {\n    export const NOTEBOOK_MAIN_TOOLBAR = ['notebook', 'toolbar'];\n    export const NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP = [...NOTEBOOK_MAIN_TOOLBAR, 'cell-add-group'];\n    export const NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP = [...NOTEBOOK_MAIN_TOOLBAR, 'cell-execution-group'];\n    export const NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU = ['notebook-main-toolbar-hidden-items-context-menu'];\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Command, CommandContribution, CommandHandler, CommandRegistry, MenuContribution, MenuModelRegistry, nls } from '@theia/core';\nimport { codicon, Key, KeybindingContribution, KeybindingRegistry, KeyCode, KeyModifier } from '@theia/core/lib/browser';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport {\n    NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, NOTEBOOK_CELL_TYPE,\n    NotebookContextKeys, NOTEBOOK_CELL_EXECUTING, NOTEBOOK_EDITOR_FOCUSED,\n    NOTEBOOK_CELL_FOCUSED,\n    NOTEBOOK_CELL_LIST_FOCUSED\n} from './notebook-context-keys';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookExecutionService } from '../service/notebook-execution-service';\nimport { NotebookCellOutputModel } from '../view-model/notebook-cell-output-model';\nimport { CellData, CellEditType, CellKind } from '../../common';\nimport { NotebookEditorWidgetService } from '../service/notebook-editor-widget-service';\nimport { NotebookCommands } from './notebook-actions-contribution';\nimport { changeCellType } from './cell-operations';\nimport { EditorLanguageQuickPickService } from '@theia/editor/lib/browser/editor-language-quick-pick-service';\nimport { NotebookService } from '../service/notebook-service';\nimport { Selection } from '@theia/monaco-editor-core/esm/vs/editor/common/core/selection';\nimport { Range } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { NOTEBOOK_EDITOR_ID_PREFIX } from '../notebook-editor-widget';\n\nexport namespace NotebookCellCommands {\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const EDIT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.edit',\n        category: 'Notebook',\n        iconClass: codicon('edit')\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const STOP_EDIT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.stop-edit',\n        category: 'Notebook',\n        iconClass: codicon('check')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const DELETE_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.delete',\n        iconClass: codicon('trash')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const SPLIT_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.split',\n        iconClass: codicon('split-vertical'),\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const EXECUTE_SINGLE_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.execute-cell',\n        category: 'Notebook',\n        label: 'Execute Cell',\n        iconClass: codicon('play'),\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.execute-cell-and-focus-next',\n        label: 'Execute Notebook Cell and Select Below',\n        category: 'Notebook',\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const EXECUTE_SINGLE_CELL_AND_INSERT_BELOW_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.execute-cell-and-insert-below',\n        label: 'Execute Notebook Cell and Insert Below',\n        category: 'Notebook',\n    });\n\n    export const EXECUTE_ABOVE_CELLS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebookActions.executeAbove',\n        label: 'Execute Above Cells',\n        iconClass: codicon('run-above')\n    });\n\n    export const EXECUTE_CELL_AND_BELOW_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebookActions.executeBelow',\n        label: 'Execute Cell and Below',\n        iconClass: codicon('run-below')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const STOP_CELL_EXECUTION_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.stop-cell-execution',\n        iconClass: codicon('stop'),\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const CLEAR_OUTPUTS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.clear-outputs',\n        category: 'Notebook',\n        label: 'Clear Cell Outputs',\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel | undefined, output: NotebookCellOutputModel */\n    export const CHANGE_OUTPUT_PRESENTATION_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.change-presentation',\n        category: 'Notebook',\n        label: 'Change Presentation',\n    });\n\n    export const INSERT_NEW_CELL_ABOVE_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.insertCodeCellAboveAndFocusContainer',\n        label: 'Insert Code Cell Above and Focus Container'\n    });\n\n    export const INSERT_NEW_CELL_BELOW_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.insertCodeCellBelowAndFocusContainer',\n        label: 'Insert Code Cell Below and Focus Container'\n    });\n\n    export const INSERT_MARKDOWN_CELL_ABOVE_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.insertMarkdownCellAbove',\n        label: 'Insert Markdown Cell Above'\n    });\n    export const INSERT_MARKDOWN_CELL_BELOW_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.insertMarkdownCellBelow',\n        label: 'Insert Markdown Cell Below'\n    });\n\n    export const TO_CODE_CELL_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.changeToCode',\n        category: 'Notebook',\n        label: 'Change Cell to Code'\n    });\n\n    export const TO_MARKDOWN_CELL_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.changeToMarkdown',\n        category: 'Notebook',\n        label: 'Change Cell to Markdown'\n    });\n\n    export const TOGGLE_CELL_OUTPUT = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.toggleOutputs',\n        category: 'Notebook',\n        label: 'Collapse Cell Output',\n    });\n\n    export const CHANGE_CELL_LANGUAGE = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.changeLanguage',\n        category: 'Notebook',\n        label: 'Change Cell Language',\n    });\n\n    export const TOGGLE_LINE_NUMBERS = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.toggleLineNumbers',\n        category: 'Notebook',\n        label: 'Show Cell Line Numbers',\n    });\n\n}\n\n@injectable()\nexport class NotebookCellActionContribution implements MenuContribution, CommandContribution, KeybindingContribution {\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(NotebookExecutionService)\n    protected notebookExecutionService: NotebookExecutionService;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorWidgetService: NotebookEditorWidgetService;\n\n    @inject(EditorLanguageQuickPickService)\n    protected languageQuickPickService: EditorLanguageQuickPickService;\n\n    @postConstruct()\n    protected init(): void {\n        NotebookContextKeys.initNotebookContextKeys(this.contextKeyService);\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EDIT_COMMAND.id,\n            icon: NotebookCellCommands.EDIT_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'markdown' && !${NOTEBOOK_CELL_MARKDOWN_EDIT_MODE}`,\n            label: nls.localizeByDefault('Edit Cell'),\n            order: '10'\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n            icon: NotebookCellCommands.STOP_EDIT_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'markdown' && ${NOTEBOOK_CELL_MARKDOWN_EDIT_MODE}`,\n            label: nls.localizeByDefault('Stop Editing Cell'),\n            order: '10'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'code'`,\n            label: nls.localizeByDefault('Execute Above Cells'),\n            order: '10'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'code'`,\n            label: nls.localizeByDefault('Execute Cell and Below'),\n            order: '20'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.SPLIT_CELL_COMMAND.id,\n            icon: NotebookCellCommands.SPLIT_CELL_COMMAND.iconClass,\n            label: nls.localizeByDefault('Split Cell'),\n            order: '20'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.DELETE_COMMAND.id,\n            icon: NotebookCellCommands.DELETE_COMMAND.iconClass,\n            label: nls.localizeByDefault('Delete Cell'),\n            order: '999'\n        });\n\n        menus.registerSubmenu(\n            NotebookCellActionContribution.ADDITIONAL_ACTION_MENU,\n            nls.localizeByDefault('More'),\n            {\n                sortString: '30',\n                icon: codicon('ellipsis')\n            }\n        );\n\n        menus.registerSubmenu(NotebookCellActionContribution.CONTRIBUTED_CELL_ACTION_MENU, '');\n        // since contributions are adding to an independent submenu we have to manually add it to the more submenu\n        menus.linkCompoundMenuNode({\n            newParentPath: NotebookCellActionContribution.ADDITIONAL_ACTION_MENU,\n            submenuPath: NotebookCellActionContribution.CONTRIBUTED_CELL_ACTION_MENU\n        });\n\n        // code cell sidebar menu\n        menus.registerMenuAction(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.iconClass,\n            label: nls.localizeByDefault('Execute Cell'),\n            when: `!${NOTEBOOK_CELL_EXECUTING}`\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND.id,\n            icon: NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND.iconClass,\n            label: nls.localizeByDefault('Stop Cell Execution'),\n            when: NOTEBOOK_CELL_EXECUTING\n        });\n\n        // Notebook Cell extra execution options\n        menus.registerSubmenu(NotebookCellActionContribution.CONTRIBUTED_CELL_EXECUTION_MENU,\n            nls.localizeByDefault('More...'),\n            { icon: codicon('chevron-down') });\n        // menus.getMenu(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU).addNode(menus.getMenuNode(NotebookCellActionContribution.CONTRIBUTED_CELL_EXECUTION_MENU));\n\n        // code cell output sidebar menu\n        menus.registerSubmenu(\n            NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU,\n            nls.localizeByDefault('More'),\n            { icon: codicon('ellipsis') }\n        );\n        menus.registerMenuAction(NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.CLEAR_OUTPUTS_COMMAND.id,\n            label: nls.localizeByDefault('Clear Cell Outputs'),\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND.id,\n            label: nls.localizeByDefault('Change Presentation'),\n        });\n\n    }\n\n    registerCommands(commands: CommandRegistry): void {\n        commands.registerCommand(NotebookCellCommands.EDIT_COMMAND, this.editableCellCommandHandler((_, cell) => cell.requestFocusEditor()));\n        commands.registerCommand(NotebookCellCommands.STOP_EDIT_COMMAND, { execute: (_, cell: NotebookCellModel) => (cell ?? this.getSelectedCell()).requestBlurEditor() });\n        commands.registerCommand(NotebookCellCommands.DELETE_COMMAND,\n            this.editableCellCommandHandler((notebookModel, cell) => {\n                notebookModel.applyEdits([{\n                    editType: CellEditType.Replace,\n                    index: notebookModel.cells.indexOf(cell),\n                    count: 1,\n                    cells: []\n                }]\n                    , true);\n            }));\n        commands.registerCommand(NotebookCellCommands.SPLIT_CELL_COMMAND, this.editableCellCommandHandler(\n            async (notebookModel, cell) => {\n                // selection (0,0,0,0) should also be used in !cell.editing mode, but `cell.editing`\n                // is not properly implemented for Code cells.\n                const cellSelection: Range = cell.selection ?? { start: { line: 0, character: 0 }, end: { line: 0, character: 0 } };\n                const textModel = await cell.resolveTextModel();\n\n                // Create new cell with the text after the cursor\n                const splitOffset = textModel.offsetAt({\n                    line: cellSelection.start.line,\n                    character: cellSelection.start.character\n                });\n                const newCell: CellData = {\n                    cellKind: cell.cellKind,\n                    language: cell.language,\n                    outputs: [],\n                    source: textModel.getText().substring(splitOffset),\n                };\n\n                // add new cell below\n                const index = notebookModel.cells.indexOf(cell);\n                notebookModel.applyEdits([{ editType: CellEditType.Replace, index: index + 1, count: 0, cells: [newCell] }], true);\n\n                // update current cell text (undo-able)\n                const selection = new Selection(cellSelection.start.line + 1, cellSelection.start.character + 1, cellSelection.end.line + 1, cellSelection.end.character + 1);\n                const endPosition = textModel.positionAt(textModel.getText().length);\n                const deleteOp = {\n                    range: {\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: selection.startColumn,\n                        endLineNumber: endPosition.line + 1,\n                        endColumn: endPosition.character + 1\n                    },\n                    // eslint-disable-next-line no-null/no-null\n                    text: null\n                };\n                // Create a new undo/redo stack entry\n                textModel.textEditorModel.pushStackElement();\n                textModel.textEditorModel.pushEditOperations([selection], [deleteOp], () => [selection]);\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                this.notebookExecutionService.executeNotebookCells(notebookModel, [cell]);\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                if (cell.cellKind === CellKind.Code) {\n                    commands.executeCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id, notebookModel, cell);\n                } else {\n                    commands.executeCommand(NotebookCellCommands.STOP_EDIT_COMMAND.id, notebookModel, cell);\n                }\n                const index = notebookModel.cells.indexOf(cell);\n                if (index < notebookModel.cells.length - 1) {\n                    notebookModel.setSelectedCell(notebookModel.cells[index + 1]);\n                } else if (cell.cellKind === CellKind.Code) {\n                    commands.executeCommand(NotebookCellCommands.INSERT_NEW_CELL_BELOW_COMMAND.id);\n                } else {\n                    commands.executeCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_BELOW_COMMAND.id);\n                }\n            })\n        );\n        commands.registerCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_INSERT_BELOW_COMMAND, this.editableCellCommandHandler(\n            async (notebookModel, cell) => {\n                if (cell.cellKind === CellKind.Code) {\n                    await commands.executeCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id, notebookModel, cell);\n                }\n                await commands.executeCommand(NotebookCellCommands.STOP_EDIT_COMMAND.id, notebookModel, cell);\n\n                if (cell.cellKind === CellKind.Code) {\n                    await commands.executeCommand(NotebookCellCommands.INSERT_NEW_CELL_BELOW_COMMAND.id);\n                } else {\n                    await commands.executeCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_BELOW_COMMAND.id);\n                }\n\n                const index = notebookModel.cells.indexOf(cell);\n                notebookModel.setSelectedCell(notebookModel.cells[index + 1]);\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                const index = notebookModel.cells.indexOf(cell);\n                if (index > 0) {\n                    this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells.slice(0, index).filter(c => c.cellKind === CellKind.Code));\n                }\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                const index = notebookModel.cells.indexOf(cell);\n                if (index >= 0) {\n                    this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells.slice(index).filter(c => c.cellKind === CellKind.Code));\n                }\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND, {\n            execute: (notebookModel: NotebookModel, cell: NotebookCellModel) => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                cell = cell ?? this.getSelectedCell();\n                this.notebookExecutionService.cancelNotebookCells(notebookModel, [cell]);\n            }\n        });\n        commands.registerCommand(NotebookCellCommands.CLEAR_OUTPUTS_COMMAND, this.editableCellCommandHandler(\n            (notebook, cell) => (notebook ?? this.notebookEditorWidgetService.focusedEditor?.model)?.applyEdits([{\n                editType: CellEditType.Output,\n                handle: cell.handle,\n                outputs: [],\n                deleteCount: cell.outputs.length,\n                append: false\n            }], true)\n        ));\n        commands.registerCommand(NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND, this.editableCellCommandHandler(\n            (notebook, cell, output) => {\n                this.notebookEditorWidgetService.getNotebookEditor(NOTEBOOK_EDITOR_ID_PREFIX + notebook.uri.toString())?.requestOuputPresentationChange(cell.handle, output);\n            }\n        ));\n\n        const insertCommand = (type: CellKind, index: number | 'above' | 'below', focusContainer: boolean): CommandHandler => this.editableCellCommandHandler(() =>\n            commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, undefined, type, index, focusContainer)\n        );\n        commands.registerCommand(NotebookCellCommands.INSERT_NEW_CELL_ABOVE_COMMAND, insertCommand(CellKind.Code, 'above', true));\n        commands.registerCommand(NotebookCellCommands.INSERT_NEW_CELL_BELOW_COMMAND, insertCommand(CellKind.Code, 'below', true));\n        commands.registerCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_ABOVE_COMMAND, insertCommand(CellKind.Markup, 'above', false));\n        commands.registerCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_BELOW_COMMAND, insertCommand(CellKind.Markup, 'below', false));\n\n        commands.registerCommand(NotebookCellCommands.TO_CODE_CELL_COMMAND, this.editableCellCommandHandler((notebookModel, cell) => {\n            changeCellType(notebookModel, cell, CellKind.Code, this.notebookService.getCodeCellLanguage(notebookModel));\n        }));\n        commands.registerCommand(NotebookCellCommands.TO_MARKDOWN_CELL_COMMAND, this.editableCellCommandHandler((notebookModel, cell) => {\n            changeCellType(notebookModel, cell, CellKind.Markup);\n        }));\n\n        commands.registerCommand(NotebookCellCommands.TOGGLE_CELL_OUTPUT, {\n            execute: () => {\n                const selectedCell = this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                if (selectedCell) {\n                    selectedCell.outputVisible = !selectedCell.outputVisible;\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCellCommands.CHANGE_CELL_LANGUAGE, {\n            isVisible: () => !!this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell,\n            execute: async (notebook?: NotebookModel, cell?: NotebookCellModel) => {\n                const selectedCell = cell ?? this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                const activeNotebook = notebook ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                if (!selectedCell || !activeNotebook) {\n                    return;\n                }\n                const language = await this.languageQuickPickService.pickEditorLanguage(selectedCell.language);\n                if (!language?.value || language.value === 'autoDetect' || language.value.id === selectedCell.language) {\n                    return;\n                }\n                const isMarkdownCell = selectedCell.cellKind === CellKind.Markup;\n                const isMarkdownLanguage = language.value.id === 'markdown';\n                if (isMarkdownLanguage) {\n                    changeCellType(activeNotebook, selectedCell, CellKind.Markup, language.value.id);\n                } else {\n                    if (isMarkdownCell) {\n                        changeCellType(activeNotebook, selectedCell, CellKind.Code, language.value.id);\n                    } else {\n                        this.notebookEditorWidgetService.focusedEditor?.model?.applyEdits([{\n                            editType: CellEditType.CellLanguage,\n                            index: activeNotebook.cells.indexOf(selectedCell),\n                            language: language.value.id\n                        }], true);\n                    }\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCellCommands.TOGGLE_LINE_NUMBERS, {\n            execute: () => {\n                const selectedCell = this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                if (selectedCell) {\n                    const currentLineNumber = selectedCell.editorOptions?.lineNumbers;\n                    selectedCell.editorOptions = { ...selectedCell.editorOptions, lineNumbers: !currentLineNumber || currentLineNumber === 'off' ? 'on' : 'off' };\n                }\n            }\n        });\n\n    }\n\n    protected editableCellCommandHandler(execute: (notebookModel: NotebookModel, cell: NotebookCellModel, output?: NotebookCellOutputModel) => void): CommandHandler {\n        return {\n            isEnabled: (notebookModel: NotebookModel) => !Boolean(notebookModel?.readOnly),\n            isVisible: (notebookModel: NotebookModel) => !Boolean(notebookModel?.readOnly),\n            execute: (notebookModel: NotebookModel, cell: NotebookCellModel, output?: NotebookCellOutputModel) => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                cell = cell ?? this.getSelectedCell();\n                execute(notebookModel, cell, output);\n            }\n        };\n    }\n\n    protected getSelectedCell(): NotebookCellModel | undefined {\n        return this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        keybindings.registerKeybindings(\n            {\n                command: NotebookCellCommands.EDIT_COMMAND.id,\n                keybinding: 'Enter',\n                when: `!editorTextFocus && !inputFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.Alt, KeyModifier.CtrlCmd] }).toString(),\n                when: `editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'markdown'`,\n            },\n            {\n                command: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n                keybinding: 'esc',\n                when: `editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && !suggestWidgetVisible`,\n            },\n            {\n                command: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.CtrlCmd] }).toString(),\n                when: `${NOTEBOOK_CELL_LIST_FOCUSED} && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.Shift] }).toString(),\n                when: `${NOTEBOOK_CELL_LIST_FOCUSED} && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_INSERT_BELOW_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `${NOTEBOOK_CELL_LIST_FOCUSED} && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.CLEAR_OUTPUTS_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.KEY_O, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.KEY_P, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.TO_CODE_CELL_COMMAND.id,\n                keybinding: 'Y',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'markdown'`,\n            },\n            {\n                command: NotebookCellCommands.TO_MARKDOWN_CELL_COMMAND.id,\n                keybinding: 'M',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.SPLIT_CELL_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.MINUS, modifiers: [KeyModifier.CtrlCmd, KeyModifier.Shift] }).toString(),\n                when: `editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            }\n        );\n    }\n}\n\nexport namespace NotebookCellActionContribution {\n    export const ACTION_MENU = ['notebook-cell-actions-menu'];\n    export const ADDITIONAL_ACTION_MENU = [...ACTION_MENU, 'more'];\n    export const CONTRIBUTED_CELL_ACTION_MENU = ['notebook/cell/title'];\n    export const CONTRIBUTED_CELL_EXECUTION_MENU = ['notebook/cell/execute'];\n    export const CODE_CELL_SIDEBAR_MENU = ['code-cell-sidebar-menu'];\n    export const OUTPUT_SIDEBAR_MENU = ['code-cell-output-sidebar-menu'];\n    export const ADDITIONAL_OUTPUT_SIDEBAR_MENU = [...OUTPUT_SIDEBAR_MENU, 'more'];\n\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\nexport type NotebookCellExecutionStateContext = 'idle' | 'pending' | 'executing' | 'succeeded' | 'failed';\n\n/**\n * Context Keys for the Notebook Editor as defined by vscode in https://github.com/microsoft/vscode/blob/main/src/vs/workbench/contrib/notebook/common/notebookContextKeys.ts\n */\nexport const HAS_OPENED_NOTEBOOK = 'userHasOpenedNotebook';\nexport const KEYBINDING_CONTEXT_NOTEBOOK_FIND_WIDGET_FOCUSED = 'notebookFindWidgetFocused';\nexport const NOTEBOOK_EDITOR_FOCUSED = 'notebookEditorFocused';\nexport const NOTEBOOK_CELL_LIST_FOCUSED = 'notebookCellListFocused';\nexport const NOTEBOOK_OUTPUT_FOCUSED = 'notebookOutputFocused';\nexport const NOTEBOOK_OUTPUT_INPUT_FOCUSED = 'notebookOutputInputFocused';\nexport const NOTEBOOK_EDITOR_EDITABLE = 'notebookEditable';\nexport const NOTEBOOK_HAS_RUNNING_CELL = 'notebookHasRunningCell';\nexport const NOTEBOOK_USE_CONSOLIDATED_OUTPUT_BUTTON = 'notebookUseConsolidatedOutputButton';\nexport const NOTEBOOK_BREAKPOINT_MARGIN_ACTIVE = 'notebookBreakpointMargin';\nexport const NOTEBOOK_CELL_TOOLBAR_LOCATION = 'notebookCellToolbarLocation';\nexport const NOTEBOOK_CURSOR_NAVIGATION_MODE = 'notebookCursorNavigationMode';\nexport const NOTEBOOK_LAST_CELL_FAILED = 'notebookLastCellFailed';\nexport const NOTEBOOK_VIEW_TYPE = 'notebookType';\nexport const NOTEBOOK_CELL_TYPE = 'notebookCellType';\nexport const NOTEBOOK_CELL_EDITABLE = 'notebookCellEditable';\nexport const NOTEBOOK_CELL_FOCUSED = 'notebookCellFocused';\nexport const NOTEBOOK_CELL_EDITOR_FOCUSED = 'notebookCellEditorFocused';\nexport const NOTEBOOK_CELL_MARKDOWN_EDIT_MODE = 'notebookCellMarkdownEditMode';\nexport const NOTEBOOK_CELL_LINE_NUMBERS = 'notebookCellLineNumbers';\nexport const NOTEBOOK_CELL_EXECUTION_STATE = 'notebookCellExecutionState';\nexport const NOTEBOOK_CELL_EXECUTING = 'notebookCellExecuting';\nexport const NOTEBOOK_CELL_HAS_OUTPUTS = 'notebookCellHasOutputs';\nexport const NOTEBOOK_CELL_INPUT_COLLAPSED = 'notebookCellInputIsCollapsed';\nexport const NOTEBOOK_CELL_OUTPUT_COLLAPSED = 'notebookCellOutputIsCollapsed';\nexport const NOTEBOOK_CELL_RESOURCE = 'notebookCellResource';\nexport const NOTEBOOK_KERNEL = 'notebookKernel';\nexport const NOTEBOOK_KERNEL_COUNT = 'notebookKernelCount';\nexport const NOTEBOOK_KERNEL_SOURCE_COUNT = 'notebookKernelSourceCount';\nexport const NOTEBOOK_KERNEL_SELECTED = 'notebookKernelSelected';\nexport const NOTEBOOK_INTERRUPTIBLE_KERNEL = 'notebookInterruptibleKernel';\nexport const NOTEBOOK_MISSING_KERNEL_EXTENSION = 'notebookMissingKernelExtension';\nexport const NOTEBOOK_HAS_OUTPUTS = 'notebookHasOutputs';\n\nexport const NOTEBOOK_CELL_CURSOR_FIRST_LINE = 'cellEditorCursorPositionFirstLine';\nexport const NOTEBOOK_CELL_CURSOR_LAST_LINE = 'cellEditorCursorPositionLastLine';\n\nexport namespace NotebookContextKeys {\n    export function initNotebookContextKeys(service: ContextKeyService): void {\n        service.createKey(HAS_OPENED_NOTEBOOK, false);\n        service.createKey(KEYBINDING_CONTEXT_NOTEBOOK_FIND_WIDGET_FOCUSED, false);\n\n        // // Is Notebook\n        // export const NOTEBOOK_IS_ACTIVE_EDITOR = ContextKeyExpr.equals('activeEditor', NOTEBOOK_EDITOR_ID);\n        // export const INTERACTIVE_WINDOW_IS_ACTIVE_EDITOR = ContextKeyExpr.equals('activeEditor', INTERACTIVE_WINDOW_EDITOR_ID);\n\n        // Editor keys\n        service.createKey(NOTEBOOK_EDITOR_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_LIST_FOCUSED, false);\n        service.createKey(NOTEBOOK_OUTPUT_FOCUSED, false);\n        service.createKey(NOTEBOOK_OUTPUT_INPUT_FOCUSED, false);\n        service.createKey(NOTEBOOK_EDITOR_EDITABLE, true);\n        service.createKey(NOTEBOOK_HAS_RUNNING_CELL, false);\n        service.createKey(NOTEBOOK_USE_CONSOLIDATED_OUTPUT_BUTTON, false);\n        service.createKey(NOTEBOOK_BREAKPOINT_MARGIN_ACTIVE, false);\n        service.createKey(NOTEBOOK_CELL_TOOLBAR_LOCATION, 'left');\n        service.createKey(NOTEBOOK_CURSOR_NAVIGATION_MODE, false);\n        service.createKey(NOTEBOOK_LAST_CELL_FAILED, false);\n\n        // Cell keys\n        service.createKey(NOTEBOOK_VIEW_TYPE, undefined);\n        service.createKey(NOTEBOOK_CELL_TYPE, undefined);\n        service.createKey(NOTEBOOK_CELL_EDITABLE, false);\n        service.createKey(NOTEBOOK_CELL_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_EDITOR_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, false);\n        service.createKey(NOTEBOOK_CELL_LINE_NUMBERS, 'inherit');\n        service.createKey(NOTEBOOK_CELL_EXECUTION_STATE, undefined);\n        service.createKey(NOTEBOOK_CELL_EXECUTING, false);\n        service.createKey(NOTEBOOK_CELL_HAS_OUTPUTS, false);\n        service.createKey(NOTEBOOK_CELL_INPUT_COLLAPSED, false);\n        service.createKey(NOTEBOOK_CELL_OUTPUT_COLLAPSED, false);\n        service.createKey(NOTEBOOK_CELL_RESOURCE, '');\n        service.createKey(NOTEBOOK_CELL_CURSOR_FIRST_LINE, false);\n        service.createKey(NOTEBOOK_CELL_CURSOR_LAST_LINE, false);\n\n        // Kernels\n        service.createKey(NOTEBOOK_KERNEL, undefined);\n        service.createKey(NOTEBOOK_KERNEL_COUNT, 0);\n        service.createKey(NOTEBOOK_KERNEL_SOURCE_COUNT, 0);\n        service.createKey(NOTEBOOK_KERNEL_SELECTED, false);\n        service.createKey(NOTEBOOK_INTERRUPTIBLE_KERNEL, false);\n        service.createKey(NOTEBOOK_MISSING_KERNEL_EXTENSION, false);\n        service.createKey(NOTEBOOK_HAS_OUTPUTS, false);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { nls } from '@theia/core';\nimport { interfaces } from '@theia/core/shared/inversify';\nimport { PreferenceContribution, PreferenceSchema } from '@theia/core/lib/browser';\n\nexport namespace NotebookPreferences {\n    export const NOTEBOOK_LINE_NUMBERS = 'notebook.lineNumbers';\n    export const OUTPUT_LINE_HEIGHT = 'notebook.output.lineHeight';\n    export const OUTPUT_FONT_SIZE = 'notebook.output.fontSize';\n    export const OUTPUT_FONT_FAMILY = 'notebook.output.fontFamily';\n    export const OUTPUT_SCROLLING = 'notebook.output.scrolling';\n    export const OUTPUT_WORD_WRAP = 'notebook.output.wordWrap';\n    export const OUTPUT_LINE_LIMIT = 'notebook.output.textLineLimit';\n}\n\nexport const notebookPreferenceSchema: PreferenceSchema = {\n    properties: {\n        [NotebookPreferences.NOTEBOOK_LINE_NUMBERS]: {\n            type: 'string',\n            enum: ['on', 'off'],\n            default: 'off',\n            description: nls.localizeByDefault('Controls the display of line numbers in the cell editor.')\n        },\n        [NotebookPreferences.OUTPUT_LINE_HEIGHT]: {\n            // eslint-disable-next-line max-len\n            markdownDescription: nls.localizeByDefault('Line height of the output text within notebook cells.\\n - When set to 0, editor line height is used.\\n - Values between 0 and 8 will be used as a multiplier with the font size.\\n - Values greater than or equal to 8 will be used as effective values.'),\n            type: 'number',\n            default: 0,\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_FONT_SIZE]: {\n            markdownDescription: nls.localizeByDefault('Font size for the output text within notebook cells. When set to 0, {0} is used.', '`#editor.fontSize#`'),\n            type: 'number',\n            default: 0,\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_FONT_FAMILY]: {\n            markdownDescription: nls.localizeByDefault('The font family of the output text within notebook cells. When set to empty, the {0} is used.', '`#editor.fontFamily#`'),\n            type: 'string',\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_SCROLLING]: {\n            markdownDescription: nls.localizeByDefault('Initially render notebook outputs in a scrollable region when longer than the limit.'),\n            type: 'boolean',\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            default: false\n        },\n        [NotebookPreferences.OUTPUT_WORD_WRAP]: {\n            markdownDescription: nls.localizeByDefault('Controls whether the lines in output should wrap.'),\n            type: 'boolean',\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            default: false\n        },\n        [NotebookPreferences.OUTPUT_LINE_LIMIT]: {\n            markdownDescription: nls.localizeByDefault(\n                'Controls how many lines of text are displayed in a text output. If {0} is enabled, this setting is used to determine the scroll height of the output.',\n                '`#notebook.output.scrolling#`'),\n            type: 'number',\n            default: 30,\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            minimum: 1,\n        },\n\n    }\n};\n\nexport const NotebookPreferenceContribution = Symbol('NotebookPreferenceContribution');\n\nexport function bindNotebookPreferences(bind: interfaces.Bind): void {\n    // We don't need a NotebookPreferenceConfiguration class, so there's no preference proxy to bind\n    bind(NotebookPreferenceContribution).toConstantValue({ schema: notebookPreferenceSchema });\n    bind(PreferenceContribution).toService(NotebookPreferenceContribution);\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { CommandRegistry, MenuModelRegistry, URI, nls } from '@theia/core';\nimport { ReactWidget, Navigatable, SaveableSource, Message, DelegatingSaveable, lock, unlock, animationFrame, codicon } from '@theia/core/lib/browser';\nimport { ReactNode } from '@theia/core/shared/react';\nimport { CellKind, NotebookCellsChangeType } from '../common';\nimport { CellRenderer as CellRenderer, NotebookCellListView } from './view/notebook-cell-list-view';\nimport { NotebookCodeCellRenderer } from './view/notebook-code-cell-view';\nimport { NotebookMarkdownCellRenderer } from './view/notebook-markdown-cell-view';\nimport { NotebookModel } from './view-model/notebook-model';\nimport { NotebookCellToolbarFactory } from './view/notebook-cell-toolbar-factory';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { Emitter } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { NotebookEditorWidgetService } from './service/notebook-editor-widget-service';\nimport { NotebookMainToolbarRenderer } from './view/notebook-main-toolbar';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\nimport { NotebookContextManager } from './service/notebook-context-manager';\nimport { NotebookViewportService } from './view/notebook-viewport-service';\nimport { NotebookCellCommands } from './contributions/notebook-cell-actions-contribution';\nimport { NotebookFindWidget } from './view/notebook-find-widget';\nimport debounce = require('lodash/debounce');\nimport { CellOutputWebview, CellOutputWebviewFactory } from './renderers/cell-output-webview';\nimport { NotebookCellOutputModel } from './view-model/notebook-cell-output-model';\nconst PerfectScrollbar = require('react-perfect-scrollbar');\n\nexport const NotebookEditorWidgetContainerFactory = Symbol('NotebookEditorWidgetContainerFactory');\n\nexport function createNotebookEditorWidgetContainer(parent: interfaces.Container, props: NotebookEditorProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookEditorProps).toConstantValue(props);\n\n    const cellOutputWebviewFactory: CellOutputWebviewFactory = parent.get(CellOutputWebviewFactory);\n    child.bind(CellOutputWebview).toConstantValue(cellOutputWebviewFactory());\n\n    child.bind(NotebookContextManager).toSelf().inSingletonScope();\n    child.bind(NotebookMainToolbarRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookCellToolbarFactory).toSelf().inSingletonScope();\n    child.bind(NotebookCodeCellRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookMarkdownCellRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookViewportService).toSelf().inSingletonScope();\n\n    child.bind(NotebookEditorWidget).toSelf();\n\n    return child;\n}\n\nexport const NotebookEditorProps = Symbol('NotebookEditorProps');\n\ninterface RenderMessage {\n    rendererId: string;\n    message: unknown;\n}\n\nexport interface NotebookEditorProps {\n    uri: URI,\n    readonly notebookType: string,\n    notebookData: Promise<NotebookModel>\n    error?: Promise<string>\n}\nexport const NOTEBOOK_EDITOR_ID_PREFIX = 'notebook:';\n\n@injectable()\nexport class NotebookEditorWidget extends ReactWidget implements Navigatable, SaveableSource {\n    static readonly ID = 'notebook';\n\n    readonly saveable = new DelegatingSaveable();\n\n    @inject(NotebookCellToolbarFactory)\n    protected readonly cellToolbarFactory: NotebookCellToolbarFactory;\n\n    @inject(CommandRegistry)\n    protected commandRegistry: CommandRegistry;\n\n    @inject(MenuModelRegistry)\n    protected menuRegistry: MenuModelRegistry;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorService: NotebookEditorWidgetService;\n\n    @inject(NotebookMainToolbarRenderer)\n    protected notebookMainToolbarRenderer: NotebookMainToolbarRenderer;\n\n    @inject(NotebookContextManager)\n    protected notebookContextManager: NotebookContextManager;\n\n    @inject(NotebookCodeCellRenderer)\n    protected codeCellRenderer: NotebookCodeCellRenderer;\n    @inject(NotebookMarkdownCellRenderer)\n    protected markdownCellRenderer: NotebookMarkdownCellRenderer;\n    @inject(NotebookEditorProps)\n    protected readonly props: NotebookEditorProps;\n\n    @inject(NotebookViewportService)\n    protected readonly viewportService: NotebookViewportService;\n\n    @inject(CellOutputWebview)\n    protected readonly cellOutputWebview: CellOutputWebview;\n\n    protected readonly onDidChangeModelEmitter = new Emitter<void>();\n    readonly onDidChangeModel = this.onDidChangeModelEmitter.event;\n\n    protected readonly onDidChangeReadOnlyEmitter = new Emitter<boolean | MarkdownString>();\n    readonly onDidChangeReadOnly = this.onDidChangeReadOnlyEmitter.event;\n\n    protected readonly onPostKernelMessageEmitter = new Emitter<unknown>();\n    readonly onPostKernelMessage = this.onPostKernelMessageEmitter.event;\n\n    protected readonly onDidPostKernelMessageEmitter = new Emitter<unknown>();\n    readonly onDidPostKernelMessage = this.onDidPostKernelMessageEmitter.event;\n\n    protected readonly onPostRendererMessageEmitter = new Emitter<RenderMessage>();\n    readonly onPostRendererMessage = this.onPostRendererMessageEmitter.event;\n\n    protected readonly onDidReceiveKernelMessageEmitter = new Emitter<unknown>();\n    readonly onDidReceiveKernelMessage = this.onDidReceiveKernelMessageEmitter.event;\n\n    protected readonly onDidChangeOutputInputFocusEmitter = new Emitter<boolean>();\n    readonly onDidChangeOutputInputFocus = this.onDidChangeOutputInputFocusEmitter.event;\n\n    protected readonly renderers = new Map<CellKind, CellRenderer>();\n    protected _model?: NotebookModel;\n    protected error?: string;\n    protected _ready: Deferred<NotebookModel> = new Deferred();\n    protected _findWidgetVisible = false;\n    protected _findWidgetRef = React.createRef<NotebookFindWidget>();\n    protected scrollBarRef = React.createRef<{ updateScroll(): void }>();\n    protected debounceFind = debounce(() => {\n        this._findWidgetRef.current?.search({});\n    }, 30, {\n        trailing: true,\n        maxWait: 100,\n        leading: false\n    });\n\n    get notebookType(): string {\n        return this.props.notebookType;\n    }\n\n    get ready(): Promise<NotebookModel> {\n        return this._ready.promise;\n    }\n\n    get model(): NotebookModel | undefined {\n        return this._model;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.id = NOTEBOOK_EDITOR_ID_PREFIX + this.props.uri.toString();\n\n        this.scrollOptions = {\n            suppressScrollY: true\n        };\n\n        this.title.closable = true;\n        this.update();\n\n        this.toDispose.push(this.onDidChangeModelEmitter);\n        this.toDispose.push(this.onDidChangeReadOnlyEmitter);\n\n        this.renderers.set(CellKind.Markup, this.markdownCellRenderer);\n        this.renderers.set(CellKind.Code, this.codeCellRenderer);\n        this._ready.resolve(this.waitForData());\n        this.ready.then(model => {\n            if (model.cells.length === 1 && model.cells[0].source === '') {\n                this.commandRegistry.executeCommand(NotebookCellCommands.EDIT_COMMAND.id, model, model.cells[0]);\n                model.setSelectedCell(model.cells[0]);\n            }\n            model.onDidChangeContent(changeEvents => {\n                const cellEvent = changeEvents.filter(event => event.kind === NotebookCellsChangeType.Move || event.kind === NotebookCellsChangeType.ModelChange);\n                if (cellEvent.length > 0) {\n                    this.cellOutputWebview.cellsChanged(cellEvent);\n                }\n            });\n        });\n        this.props.error?.then(error => {\n            this.error = error;\n            this.update();\n        });\n    }\n\n    protected async waitForData(): Promise<NotebookModel> {\n        this._model = await this.props.notebookData;\n        this.cellOutputWebview.init(this._model, this);\n        this.saveable.delegate = this._model;\n        this.toDispose.push(this._model);\n        this.toDispose.push(this._model.onDidChangeContent(() => {\n            // Update the scroll bar content after the content has changed\n            // Wait one frame to ensure that the content has been rendered\n            animationFrame().then(() => this.scrollBarRef.current?.updateScroll());\n        }));\n        this.toDispose.push(this._model.onContentChanged(() => {\n            if (this._findWidgetVisible) {\n                this.debounceFind();\n            }\n        }));\n        this.toDispose.push(this._model.onDidChangeReadOnly(readOnly => {\n            if (readOnly) {\n                lock(this.title);\n            } else {\n                unlock(this.title);\n            }\n            this.onDidChangeReadOnlyEmitter.fire(readOnly);\n            this.update();\n        }));\n        if (this._model.readOnly) {\n            lock(this.title);\n        }\n        // Ensure that the model is loaded before adding the editor\n        this.notebookEditorService.addNotebookEditor(this);\n        this._model.selectedCell = this._model.cells[0];\n        this.update();\n        this.notebookContextManager.init(this);\n        return this._model;\n    }\n\n    protected override onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        (this.node.getElementsByClassName('theia-notebook-main-container')[0] as HTMLDivElement)?.focus();\n    }\n\n    getResourceUri(): URI | undefined {\n        return this.props.uri;\n    }\n\n    createMoveToUri(resourceUri: URI): URI | undefined {\n        return this.model?.uri.withPath(resourceUri.path);\n    }\n\n    undo(): void {\n        this._model?.undo();\n    }\n\n    redo(): void {\n        this._model?.redo();\n    }\n\n    protected render(): ReactNode {\n        if (this._model) {\n            return <div className='theia-notebook-main-container' tabIndex={-1}>\n                <div className='theia-notebook-overlay'>\n                    <NotebookFindWidget\n                        ref={this._findWidgetRef}\n                        hidden={!this._findWidgetVisible}\n                        onClose={() => {\n                            this._findWidgetVisible = false;\n                            this._model?.findMatches({\n                                activeFilters: [],\n                                matchCase: false,\n                                regex: false,\n                                search: '',\n                                wholeWord: false\n                            });\n                            this.update();\n                        }}\n                        onSearch={options => this._model?.findMatches(options) ?? []}\n                        onReplace={(matches, replaceText) => this._model?.replaceAll(matches, replaceText)}\n                    />\n                </div>\n                {this.notebookMainToolbarRenderer.render(this._model, this.node)}\n                <div\n                    className='theia-notebook-viewport'\n                    ref={(ref: HTMLDivElement) => this.viewportService.viewportElement = ref}\n                >\n                    <PerfectScrollbar className='theia-notebook-scroll-container'\n                        ref={this.scrollBarRef}\n                        onScrollY={(e: HTMLDivElement) => this.viewportService.onScroll(e)}>\n                        <div className='theia-notebook-scroll-area'>\n                            {this.cellOutputWebview.render()}\n                            <NotebookCellListView renderers={this.renderers}\n                                notebookModel={this._model}\n                                notebookContext={this.notebookContextManager}\n                                toolbarRenderer={this.cellToolbarFactory}\n                                commandRegistry={this.commandRegistry}\n                                menuRegistry={this.menuRegistry} />\n                        </div>\n                    </PerfectScrollbar>\n                </div>\n            </div>;\n        } else if (this.error) {\n            return <div className='theia-notebook-main-container error-message' tabIndex={-1}>\n                <span className={codicon('error')}></span>\n                <h3>{nls.localizeByDefault('The editor could not be opened because the file was not found.')}</h3>\n            </div>;\n        } else {\n            return <div className='theia-notebook-main-container' tabIndex={-1}>\n                <div className='theia-notebook-main-loading-indicator'></div>\n            </div>;\n        }\n    }\n\n    protected override onCloseRequest(msg: Message): void {\n        super.onCloseRequest(msg);\n        this.notebookEditorService.removeNotebookEditor(this);\n    }\n\n    requestOuputPresentationChange(cellHandle: number, output?: NotebookCellOutputModel): void {\n        if (output) {\n            this.cellOutputWebview.requestOutputPresentationUpdate(cellHandle, output);\n        }\n    }\n\n    postKernelMessage(message: unknown): void {\n        this.onDidPostKernelMessageEmitter.fire(message);\n    }\n\n    postRendererMessage(rendererId: string, message: unknown): void {\n        this.onPostRendererMessageEmitter.fire({ rendererId, message });\n    }\n\n    recieveKernelMessage(message: unknown): void {\n        this.onDidReceiveKernelMessageEmitter.fire(message);\n    }\n\n    outputInputFocusChanged(focused: boolean): void {\n        this.onDidChangeOutputInputFocusEmitter.fire(focused);\n    }\n\n    showFindWidget(): void {\n        if (!this._findWidgetVisible) {\n            this._findWidgetVisible = true;\n            this.update();\n        }\n        this._findWidgetRef.current?.focusSearch(this._model?.selectedText);\n    }\n\n    override dispose(): void {\n        this.cellOutputWebview.dispose();\n        this.notebookContextManager.dispose();\n        this.onDidChangeModelEmitter.dispose();\n        this.onDidPostKernelMessageEmitter.dispose();\n        this.onDidReceiveKernelMessageEmitter.dispose();\n        this.onPostRendererMessageEmitter.dispose();\n        this.onDidChangeOutputInputFocusEmitter.dispose();\n        this.viewportService.dispose();\n        this._model?.dispose();\n        super.dispose();\n    }\n\n    protected override onAfterShow(msg: Message): void {\n        super.onAfterShow(msg);\n        this.notebookEditorService.notebookEditorFocusChanged(this, true);\n    }\n\n    protected override onAfterHide(msg: Message): void {\n        super.onAfterHide(msg);\n        this.notebookEditorService.notebookEditorFocusChanged(this, false);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI, MaybePromise, Disposable } from '@theia/core';\nimport { NavigatableWidgetOpenHandler, PreferenceService, WidgetOpenerOptions, getDefaultHandler, defaultHandlerPriority } from '@theia/core/lib/browser';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { NotebookFileSelector, NotebookTypeDescriptor } from '../common/notebook-protocol';\nimport { NotebookEditorWidget } from './notebook-editor-widget';\nimport { match } from '@theia/core/lib/common/glob';\nimport { NotebookEditorWidgetOptions } from './notebook-editor-widget-factory';\n\nexport interface NotebookWidgetOpenerOptions extends WidgetOpenerOptions {\n    notebookType?: string;\n}\n\n@injectable()\nexport class NotebookOpenHandler extends NavigatableWidgetOpenHandler<NotebookEditorWidget> {\n\n    readonly id = NotebookEditorWidget.ID;\n\n    protected notebookTypes: NotebookTypeDescriptor[] = [];\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    registerNotebookType(notebookType: NotebookTypeDescriptor): Disposable {\n        this.notebookTypes.push(notebookType);\n        return Disposable.create(() => {\n            this.notebookTypes.splice(this.notebookTypes.indexOf(notebookType), 1);\n        });\n    }\n\n    canHandle(uri: URI, options?: NotebookWidgetOpenerOptions): MaybePromise<number> {\n        const defaultHandler = getDefaultHandler(uri, this.preferenceService);\n        if (options?.notebookType) {\n            return this.canHandleType(uri, this.notebookTypes.find(type => type.type === options.notebookType), defaultHandler);\n        }\n        return Math.max(...this.notebookTypes.map(type => this.canHandleType(uri, type), defaultHandler));\n    }\n\n    canHandleType(uri: URI, notebookType?: NotebookTypeDescriptor, defaultHandler?: string): number {\n        if (notebookType?.selector && this.matches(notebookType.selector, uri)) {\n            return notebookType.type === defaultHandler ? defaultHandlerPriority : this.calculatePriority(notebookType);\n        } else {\n            return 0;\n        }\n    }\n\n    protected calculatePriority(notebookType: NotebookTypeDescriptor | undefined): number {\n        if (!notebookType) {\n            return 0;\n        }\n        return notebookType.priority === 'option' ? 100 : 200;\n    }\n\n    protected findHighestPriorityType(uri: URI): NotebookTypeDescriptor | undefined {\n        const matchingTypes = this.notebookTypes\n            .filter(notebookType => notebookType.selector && this.matches(notebookType.selector, uri))\n            .map(notebookType => ({ descriptor: notebookType, priority: this.calculatePriority(notebookType) }));\n\n        if (matchingTypes.length === 0) {\n            return undefined;\n        }\n        let type = matchingTypes[0];\n        for (let i = 1; i < matchingTypes.length; i++) {\n            const notebookType = matchingTypes[i];\n            if (notebookType.priority > type.priority) {\n                type = notebookType;\n            }\n        }\n        return type.descriptor;\n    }\n\n    // Override for better options typing\n    override open(uri: URI, options?: NotebookWidgetOpenerOptions): Promise<NotebookEditorWidget> {\n        return super.open(uri, options);\n    }\n\n    protected override createWidgetOptions(uri: URI, options?: NotebookWidgetOpenerOptions): NotebookEditorWidgetOptions {\n        const widgetOptions = super.createWidgetOptions(uri, options);\n        if (options?.notebookType) {\n            return {\n                notebookType: options.notebookType,\n                ...widgetOptions\n            };\n        }\n        const defaultHandler = getDefaultHandler(uri, this.preferenceService);\n        const notebookType = this.notebookTypes.find(type => type.type === defaultHandler)\n            || this.findHighestPriorityType(uri);\n        if (!notebookType) {\n            throw new Error('No notebook types registered for uri: ' + uri.toString());\n        }\n        return {\n            notebookType: notebookType.type,\n            ...widgetOptions\n        };\n    }\n\n    protected matches(selectors: readonly NotebookFileSelector[], resource: URI): boolean {\n        return selectors.some(selector => this.selectorMatches(selector, resource));\n    }\n\n    protected selectorMatches(selector: NotebookFileSelector, resource: URI): boolean {\n        return !!selector.filenamePattern\n            && match(selector.filenamePattern, resource.path.name + resource.path.ext);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *  Copied from commit 18b2c92451b076943e5b508380e0eba66ba7d934 from file src\\vs\\workbench\\contrib\\notebook\\common\\notebookCommon.ts\n *--------------------------------------------------------------------------------------------*/\n\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\n\nconst textDecoder = new TextDecoder();\n\n/**\n * Given a stream of individual stdout outputs, this function will return the compressed lines, escaping some of the common terminal escape codes.\n * E.g. some terminal escape codes would result in the previous line getting cleared, such if we had 3 lines and\n * last line contained such a code, then the result string would be just the first two lines.\n * @returns a single VSBuffer with the concatenated and compressed data, and whether any compression was done.\n */\nexport function compressOutputItemStreams(outputs: Uint8Array[]): { data: BinaryBuffer, didCompression: boolean } {\n    const buffers: Uint8Array[] = [];\n    let startAppending = false;\n\n    // Pick the first set of outputs with the same mime type.\n    for (const output of outputs) {\n        if ((buffers.length === 0 || startAppending)) {\n            buffers.push(output);\n            startAppending = true;\n        }\n    }\n\n    let didCompression = compressStreamBuffer(buffers);\n    const concatenated = BinaryBuffer.concat(buffers.map(buffer => BinaryBuffer.wrap(buffer)));\n    const data = formatStreamText(concatenated);\n    didCompression = didCompression || data.byteLength !== concatenated.byteLength;\n    return { data, didCompression };\n}\n\nexport const MOVE_CURSOR_1_LINE_COMMAND = `${String.fromCharCode(27)}[A`;\nconst MOVE_CURSOR_1_LINE_COMMAND_BYTES = MOVE_CURSOR_1_LINE_COMMAND.split('').map(c => c.charCodeAt(0));\nconst LINE_FEED = 10;\nfunction compressStreamBuffer(streams: Uint8Array[]): boolean {\n    let didCompress = false;\n    streams.forEach((stream, index) => {\n        if (index === 0 || stream.length < MOVE_CURSOR_1_LINE_COMMAND.length) {\n            return;\n        }\n\n        const previousStream = streams[index - 1];\n\n        // Remove the previous line if required.\n        const command = stream.subarray(0, MOVE_CURSOR_1_LINE_COMMAND.length);\n        if (command[0] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[0] && command[1] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[1] && command[2] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[2]) {\n            const lastIndexOfLineFeed = previousStream.lastIndexOf(LINE_FEED);\n            if (lastIndexOfLineFeed === -1) {\n                return;\n            }\n\n            didCompress = true;\n            streams[index - 1] = previousStream.subarray(0, lastIndexOfLineFeed);\n            streams[index] = stream.subarray(MOVE_CURSOR_1_LINE_COMMAND.length);\n        }\n    });\n    return didCompress;\n}\n\nconst BACKSPACE_CHARACTER = '\\b'.charCodeAt(0);\nconst CARRIAGE_RETURN_CHARACTER = '\\r'.charCodeAt(0);\nfunction formatStreamText(buffer: BinaryBuffer): BinaryBuffer {\n    // We have special handling for backspace and carriage return characters.\n    // Don't unnecessary decode the bytes if we don't need to perform any processing.\n    if (!buffer.buffer.includes(BACKSPACE_CHARACTER) && !buffer.buffer.includes(CARRIAGE_RETURN_CHARACTER)) {\n        return buffer;\n    }\n    // Do the same thing jupyter is doing\n    return BinaryBuffer.fromString(fixCarriageReturn(fixBackspace(textDecoder.decode(buffer.buffer))));\n}\n\n/**\n * Took this from jupyter/notebook\n * https://github.com/jupyter/notebook/blob/b8b66332e2023e83d2ee04f83d8814f567e01a4e/notebook/static/base/js/utils.js\n * Remove characters that are overridden by backspace characters\n */\nfunction fixBackspace(txt: string): string {\n    let tmp = txt;\n    do {\n        txt = tmp;\n        // Cancel out anything-but-newline followed by backspace\n        tmp = txt.replace(/[^\\n]\\x08/gm, '');\n    } while (tmp.length < txt.length);\n    return txt;\n}\n\n/**\n * Remove chunks that should be overridden by the effect of carriage return characters\n * From https://github.com/jupyter/notebook/blob/master/notebook/static/base/js/utils.js\n */\nfunction fixCarriageReturn(txt: string): string {\n    txt = txt.replace(/\\r+\\n/gm, '\\n'); // \\r followed by \\n --> newline\n    while (txt.search(/\\r[^$]/g) > -1) {\n        const base = txt.match(/^(.*)\\r+/m)![1];\n        let insert = txt.match(/\\r+(.*)$/m)![1];\n        insert = insert + base.slice(insert.length, base.length);\n        txt = txt.replace(/\\r+.*$/m, '\\r').replace(/^.*\\r/m, insert);\n    }\n    return txt;\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, Path } from '@theia/core';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { NotebookRendererDescriptor } from '../common/notebook-protocol';\n\nexport interface NotebookRendererInfo {\n    readonly id: string;\n    readonly displayName: string;\n    readonly mimeTypes: string[];\n    readonly entrypoint: { readonly extends?: string; readonly uri: string };\n    readonly requiresMessaging: boolean;\n}\n\nexport interface NotebookPreloadInfo {\n    readonly type: string;\n    readonly entrypoint: string;\n}\n\n@injectable()\nexport class NotebookRendererRegistry {\n\n    private readonly _notebookRenderers: NotebookRendererInfo[] = [];\n\n    get notebookRenderers(): readonly NotebookRendererInfo[] {\n        return this._notebookRenderers;\n    }\n\n    private readonly _staticNotebookPreloads: NotebookPreloadInfo[] = [];\n\n    get staticNotebookPreloads(): readonly NotebookPreloadInfo[] {\n        return this._staticNotebookPreloads;\n    }\n\n    registerNotebookRenderer(type: NotebookRendererDescriptor, basePath: string): Disposable {\n        let entrypoint;\n        if (typeof type.entrypoint === 'string') {\n            entrypoint = {\n                uri: new Path(basePath).join(type.entrypoint).toString()\n            };\n        } else {\n            entrypoint = {\n                uri: new Path(basePath).join(type.entrypoint.path).toString(),\n                extends: type.entrypoint.extends\n            };\n        }\n\n        this._notebookRenderers.push({\n            ...type,\n            mimeTypes: type.mimeTypes || [],\n            requiresMessaging: type.requiresMessaging === 'always' || type.requiresMessaging === 'optional',\n            entrypoint\n        });\n        return Disposable.create(() => {\n            this._notebookRenderers.splice(this._notebookRenderers.findIndex(renderer => renderer.id === type.id), 1);\n        });\n    }\n\n    registerStaticNotebookPreload(type: string, entrypoint: string, basePath: string): Disposable {\n        const staticPreload = { type, entrypoint: new Path(basePath).join(entrypoint).toString() };\n        this._staticNotebookPreloads.push(staticPreload);\n        return Disposable.create(() => {\n            this._staticNotebookPreloads.splice(this._staticNotebookPreloads.indexOf(staticPreload), 1);\n        });\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, DisposableCollection } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { OpenWithService } from '@theia/core/lib/browser';\nimport { NotebookTypeDescriptor } from '../common/notebook-protocol';\nimport { NotebookOpenHandler } from './notebook-open-handler';\n\n@injectable()\nexport class NotebookTypeRegistry {\n\n    @inject(OpenWithService)\n    protected readonly openWithService: OpenWithService;\n\n    @inject(NotebookOpenHandler)\n    protected readonly notebookOpenHandler: NotebookOpenHandler;\n\n    private readonly _notebookTypes: NotebookTypeDescriptor[] = [];\n\n    get notebookTypes(): readonly NotebookTypeDescriptor[] {\n        return this._notebookTypes;\n    }\n\n    registerNotebookType(type: NotebookTypeDescriptor, providerName: string): Disposable {\n        const toDispose = new DisposableCollection();\n        toDispose.push(Disposable.create(() => {\n            this._notebookTypes.splice(this._notebookTypes.indexOf(type), 1);\n        }));\n        this._notebookTypes.push(type);\n        toDispose.push(this.notebookOpenHandler.registerNotebookType(type));\n        toDispose.push(this.openWithService.registerHandler({\n            id: type.type,\n            label: type.displayName,\n            providerName,\n            canHandle: uri => this.notebookOpenHandler.canHandleType(uri, type),\n            open: uri => this.notebookOpenHandler.open(uri, { notebookType: type.type })\n        }));\n        return toDispose;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, Event } from '@theia/core';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { NotebookContentChangedEvent } from '../notebook-types';\nimport { NotebookCellOutputModel } from '../view-model/notebook-cell-output-model';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\n\nexport const CellOutputWebviewFactory = Symbol('outputWebviewFactory');\nexport const CellOutputWebview = Symbol('outputWebview');\n\nexport type CellOutputWebviewFactory = () => Promise<CellOutputWebview>;\n\nexport interface OutputRenderEvent {\n    cellHandle: number;\n    outputId: string;\n    outputHeight: number;\n}\n\nexport interface CellOutputWebview extends Disposable {\n\n    readonly id: string;\n\n    init(notebook: NotebookModel, editor: NotebookEditorWidget): void;\n\n    render(): React.ReactNode;\n\n    setCellHeight(cell: NotebookCellModel, height: number): void;\n    cellsChanged(cellEvent: NotebookContentChangedEvent[]): void;\n    onDidRenderOutput: Event<OutputRenderEvent>\n\n    requestOutputPresentationUpdate(cellHandle: number, output: NotebookCellOutputModel): void;\n    isAttached(): boolean\n}\n","// *****************************************************************************\n// Copyright (C) 2024 Typefox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Emitter, URI } from '@theia/core';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { SimpleMonacoEditor } from '@theia/monaco/lib/browser/simple-monaco-editor';\nimport { NotebookEditorWidgetService } from './notebook-editor-widget-service';\nimport { CellUri } from '../../common';\nimport { ActiveMonacoEditorContribution, MonacoEditorService } from '@theia/monaco/lib/browser/monaco-editor-service';\nimport { ICodeEditor } from '@theia/monaco-editor-core/esm/vs/editor/browser/editorBrowser';\n\n@injectable()\nexport class NotebookCellEditorService implements ActiveMonacoEditorContribution {\n\n    @inject(NotebookEditorWidgetService)\n    protected readonly notebookEditorWidgetService: NotebookEditorWidgetService;\n\n    @inject(MonacoEditorService)\n    protected readonly monacoEditorService: MonacoEditorService;\n\n    protected onDidChangeCellEditorsEmitter = new Emitter<void>();\n    readonly onDidChangeCellEditors = this.onDidChangeCellEditorsEmitter.event;\n\n    protected onDidChangeFocusedCellEditorEmitter = new Emitter<SimpleMonacoEditor | undefined>();\n    readonly onDidChangeFocusedCellEditor = this.onDidChangeFocusedCellEditorEmitter.event;\n\n    protected currentActiveCell?: SimpleMonacoEditor;\n\n    protected currentCellEditors: Map<string, SimpleMonacoEditor> = new Map();\n\n    @postConstruct()\n    protected init(): void {\n        this.notebookEditorWidgetService.onDidChangeCurrentEditor(editor => {\n            // if defocus notebook editor or another notebook editor is focused, clear the active cell\n            if (!editor || (this.currentActiveCell && CellUri.parse(this.currentActiveCell.uri)?.notebook.toString() !== editor?.model?.uri.toString())) {\n                this.currentActiveCell = undefined;\n                // eslint-disable-next-line no-null/no-null\n                this.monacoEditorService.setActiveCodeEditor(null);\n                this.onDidChangeFocusedCellEditorEmitter.fire(undefined);\n            }\n        });\n    }\n\n    get allCellEditors(): SimpleMonacoEditor[] {\n        return Array.from(this.currentCellEditors.values());\n    }\n\n    editorCreated(uri: URI, editor: SimpleMonacoEditor): void {\n        this.currentCellEditors.set(uri.toString(), editor);\n        this.onDidChangeCellEditorsEmitter.fire();\n    }\n\n    editorDisposed(uri: URI): void {\n        this.currentCellEditors.delete(uri.toString());\n        this.onDidChangeCellEditorsEmitter.fire();\n    }\n\n    editorFocusChanged(editor?: SimpleMonacoEditor): void {\n        if (editor) {\n            this.currentActiveCell = editor;\n            this.monacoEditorService.setActiveCodeEditor(editor.getControl());\n            this.onDidChangeFocusedCellEditorEmitter.fire(editor);\n        }\n    }\n\n    getActiveCell(): SimpleMonacoEditor | undefined {\n        return this.currentActiveCell;\n    }\n\n    getActiveEditor(): ICodeEditor | undefined {\n        return this.getActiveCell()?.getControl();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, Command, Disposable, Emitter, Event, URI } from '@theia/core';\nimport { CellStatusbarAlignment } from '../../common';\nimport { ThemeColor } from '@theia/core/lib/common/theme';\nimport { AccessibilityInformation } from '@theia/core/lib/common/accessibility';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\n\nexport interface NotebookCellStatusBarItem {\n    readonly alignment: CellStatusbarAlignment;\n    readonly priority?: number;\n    readonly text: string;\n    readonly color?: string | ThemeColor;\n    readonly backgroundColor?: string | ThemeColor;\n    readonly tooltip?: string | MarkdownString;\n    readonly command?: string | (Command & { arguments?: unknown[] });\n    readonly accessibilityInformation?: AccessibilityInformation;\n    readonly opacity?: string;\n    readonly onlyShowWhenActive?: boolean;\n}\nexport interface NotebookCellStatusBarItemList {\n    items: NotebookCellStatusBarItem[];\n    dispose?(): void;\n}\n\nexport interface NotebookCellStatusBarItemProvider {\n    viewType: string;\n    onDidChangeStatusBarItems?: Event<void>;\n    provideCellStatusBarItems(uri: URI, index: number, token: CancellationToken): Promise<NotebookCellStatusBarItemList | undefined>;\n}\n\n@injectable()\nexport class NotebookCellStatusBarService implements Disposable {\n\n    protected readonly onDidChangeProvidersEmitter = new Emitter<void>();\n    readonly onDidChangeProviders: Event<void> = this.onDidChangeProvidersEmitter.event;\n\n    protected readonly onDidChangeItemsEmitter = new Emitter<void>();\n    readonly onDidChangeItems: Event<void> = this.onDidChangeItemsEmitter.event;\n\n    protected readonly providers: NotebookCellStatusBarItemProvider[] = [];\n\n    registerCellStatusBarItemProvider(provider: NotebookCellStatusBarItemProvider): Disposable {\n        this.providers.push(provider);\n        let changeListener: Disposable | undefined;\n        if (provider.onDidChangeStatusBarItems) {\n            changeListener = provider.onDidChangeStatusBarItems(() => this.onDidChangeItemsEmitter.fire());\n        }\n\n        this.onDidChangeProvidersEmitter.fire();\n\n        return Disposable.create(() => {\n            changeListener?.dispose();\n            const idx = this.providers.findIndex(p => p === provider);\n            this.providers.splice(idx, 1);\n        });\n    }\n\n    async getStatusBarItemsForCell(notebookUri: URI, cellIndex: number, viewType: string, token: CancellationToken): Promise<NotebookCellStatusBarItemList[]> {\n        const providers = this.providers.filter(p => p.viewType === viewType || p.viewType === '*');\n        return Promise.all(providers.map(async p => {\n            try {\n                return await p.provideCellStatusBarItems(notebookUri, cellIndex, token) ?? { items: [] };\n            } catch (e) {\n                console.error(e);\n                return { items: [] };\n            }\n        }));\n    }\n\n    dispose(): void {\n        this.onDidChangeItemsEmitter.dispose();\n        this.onDidChangeProvidersEmitter.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 Typefox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ClipboardService } from '@theia/core/lib/browser/clipboard-service';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { environment } from '@theia/core';\nimport { CellData } from '../../common';\n\n@injectable()\nexport class NotebookClipboardService {\n\n    protected copiedCell: CellData | undefined;\n\n    @inject(ClipboardService)\n    protected readonly clipboardService: ClipboardService;\n\n    copyCell(cell: NotebookCellModel): void {\n        this.copiedCell = cell.getData();\n\n        if (environment.electron.is()) {\n            this.clipboardService.writeText(cell.text);\n        }\n    }\n\n    getCell(): CellData | undefined {\n        return this.copiedCell;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyChangeEvent, ContextKeyService, ContextMatcher, ScopedValueStore } from '@theia/core/lib/browser/context-key-service';\nimport { DisposableCollection } from '@theia/core';\nimport { NotebookKernelService } from './notebook-kernel-service';\nimport {\n    NOTEBOOK_CELL_EDITABLE,\n    NOTEBOOK_CELL_EXECUTING, NOTEBOOK_CELL_EXECUTION_STATE,\n    NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_MARKDOWN_EDIT_MODE,\n    NOTEBOOK_CELL_TYPE, NOTEBOOK_HAS_OUTPUTS, NOTEBOOK_KERNEL, NOTEBOOK_KERNEL_SELECTED,\n    NOTEBOOK_OUTPUT_INPUT_FOCUSED,\n    NOTEBOOK_VIEW_TYPE\n} from '../contributions/notebook-context-keys';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { CellKind, NotebookCellsChangeType } from '../../common';\nimport { NotebookExecutionStateService } from './notebook-execution-state-service';\n\n@injectable()\nexport class NotebookContextManager {\n    @inject(ContextKeyService) protected contextKeyService: ContextKeyService;\n\n    @inject(NotebookKernelService)\n    protected readonly notebookKernelService: NotebookKernelService;\n\n    @inject(NotebookExecutionStateService)\n    protected readonly executionStateService: NotebookExecutionStateService;\n\n    protected readonly toDispose = new DisposableCollection();\n\n    protected _context?: HTMLElement;\n\n    scopedStore: ScopedValueStore;\n\n    get context(): HTMLElement | undefined {\n        return this._context;\n    }\n\n    protected cellContexts: Map<number, Record<string, unknown>> = new Map();\n\n    init(widget: NotebookEditorWidget): void {\n        this._context = widget.node;\n        this.scopedStore = this.contextKeyService.createScoped(widget.node);\n\n        this.toDispose.dispose();\n\n        this.scopedStore.setContext(NOTEBOOK_VIEW_TYPE, widget?.notebookType);\n\n        // Kernel related keys\n        const kernel = widget?.model ? this.notebookKernelService.getSelectedNotebookKernel(widget.model) : undefined;\n        this.scopedStore.setContext(NOTEBOOK_KERNEL_SELECTED, !!kernel);\n        this.scopedStore.setContext(NOTEBOOK_KERNEL, kernel?.id);\n        this.toDispose.push(this.notebookKernelService.onDidChangeSelectedKernel(e => {\n            if (e.notebook.toString() === widget?.getResourceUri()?.toString()) {\n                this.scopedStore.setContext(NOTEBOOK_KERNEL_SELECTED, !!e.newKernel);\n                this.scopedStore.setContext(NOTEBOOK_KERNEL, e.newKernel);\n            }\n        }));\n\n        widget.model?.onDidChangeContent(events => {\n            if (events.some(e => e.kind === NotebookCellsChangeType.ModelChange || e.kind === NotebookCellsChangeType.Output)) {\n                this.scopedStore.setContext(NOTEBOOK_HAS_OUTPUTS, widget.model?.cells.some(cell => cell.outputs.length > 0));\n            }\n        });\n\n        this.scopedStore.setContext(NOTEBOOK_HAS_OUTPUTS, !!widget.model?.cells.find(cell => cell.outputs.length > 0));\n\n        // Cell Selection related keys\n        this.scopedStore.setContext(NOTEBOOK_CELL_FOCUSED, !!widget.model?.selectedCell);\n        this.selectedCellChanged(widget.model?.selectedCell);\n        widget.model?.onDidChangeSelectedCell(e => {\n            this.selectedCellChanged(e.cell);\n            this.scopedStore.setContext(NOTEBOOK_CELL_FOCUSED, !!e);\n        });\n\n        this.toDispose.push(this.executionStateService.onDidChangeExecution(e => {\n            if (e.notebook.toString() === widget.model?.uri.toString()) {\n                this.setCellContext(e.cellHandle, NOTEBOOK_CELL_EXECUTING, !!e.changed);\n                this.setCellContext(e.cellHandle, NOTEBOOK_CELL_EXECUTION_STATE, e.changed?.state ?? 'idle');\n            }\n        }));\n\n        widget.onDidChangeOutputInputFocus(focus => {\n            this.scopedStore.setContext(NOTEBOOK_OUTPUT_INPUT_FOCUSED, focus);\n        });\n    }\n\n    protected cellDisposables = new DisposableCollection();\n\n    selectedCellChanged(cell: NotebookCellModel | undefined): void {\n        this.cellDisposables.dispose();\n\n        this.scopedStore.setContext(NOTEBOOK_CELL_TYPE, cell ? cell.cellKind === CellKind.Code ? 'code' : 'markdown' : undefined);\n\n        if (cell) {\n            this.scopedStore.setContext(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, cell.editing);\n            this.scopedStore.setContext(NOTEBOOK_CELL_EDITABLE, cell.cellKind === CellKind.Markup && !cell.editing);\n            this.cellDisposables.push(cell.onDidRequestCellEditChange(cellEdit => {\n                this.scopedStore.setContext(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, cellEdit);\n                this.scopedStore.setContext(NOTEBOOK_CELL_EDITABLE, cell.cellKind === CellKind.Markup && !cellEdit);\n            }));\n        }\n    }\n\n    protected setCellContext(cellHandle: number, key: string, value: unknown): void {\n        let cellContext = this.cellContexts.get(cellHandle);\n        if (!cellContext) {\n            cellContext = {};\n            this.cellContexts.set(cellHandle, cellContext);\n        }\n\n        cellContext[key] = value;\n    }\n\n    getCellContext(cellHandle: number): ContextMatcher {\n        return this.contextKeyService.createOverlay(Object.entries(this.cellContexts.get(cellHandle) ?? {}));\n    }\n\n    changeCellFocus(focus: boolean): void {\n        this.scopedStore.setContext(NOTEBOOK_CELL_FOCUSED, focus);\n    }\n\n    changeCellListFocus(focus: boolean): void {\n        this.scopedStore.setContext(NOTEBOOK_CELL_LIST_FOCUSED, focus);\n    }\n\n    createContextKeyChangedEvent(affectedKeys: string[]): ContextKeyChangeEvent {\n        return { affects: keys => affectedKeys.some(key => keys.has(key)) };\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '@theia/core';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { ApplicationShell } from '@theia/core/lib/browser';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NOTEBOOK_EDITOR_FOCUSED } from '../contributions/notebook-context-keys';\n\n@injectable()\nexport class NotebookEditorWidgetService {\n\n    @inject(ApplicationShell)\n    protected applicationShell: ApplicationShell;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    protected readonly notebookEditors = new Map<string, NotebookEditorWidget>();\n\n    protected readonly onNotebookEditorAddEmitter = new Emitter<NotebookEditorWidget>();\n    protected readonly onNotebookEditorRemoveEmitter = new Emitter<NotebookEditorWidget>();\n    readonly onDidAddNotebookEditor = this.onNotebookEditorAddEmitter.event;\n    readonly onDidRemoveNotebookEditor = this.onNotebookEditorRemoveEmitter.event;\n\n    protected readonly onDidChangeFocusedEditorEmitter = new Emitter<NotebookEditorWidget | undefined>();\n    readonly onDidChangeFocusedEditor = this.onDidChangeFocusedEditorEmitter.event;\n\n    protected readonly onDidChangeCurrentEditorEmitter = new Emitter<NotebookEditorWidget | undefined>();\n    readonly onDidChangeCurrentEditor = this.onDidChangeCurrentEditorEmitter.event;\n\n    focusedEditor?: NotebookEditorWidget = undefined;\n\n    currentEditor?: NotebookEditorWidget = undefined;\n\n    @postConstruct()\n    protected init(): void {\n        this.applicationShell.onDidChangeActiveWidget(event => {\n            this.notebookEditorFocusChanged(event.newValue as NotebookEditorWidget, event.newValue instanceof NotebookEditorWidget);\n        });\n        this.applicationShell.onDidChangeCurrentWidget(event => {\n            if (event.newValue instanceof NotebookEditorWidget || event.oldValue instanceof NotebookEditorWidget) {\n                this.currentNotebookEditorChanged(event.newValue);\n            }\n        });\n    }\n\n    // --- editor management\n\n    addNotebookEditor(editor: NotebookEditorWidget): void {\n        if (this.notebookEditors.has(editor.id)) {\n            console.warn('Attempting to add duplicated notebook editor: ' + editor.id);\n        }\n        this.notebookEditors.set(editor.id, editor);\n        this.onNotebookEditorAddEmitter.fire(editor);\n        if (editor.isVisible) {\n            this.notebookEditorFocusChanged(editor, true);\n        }\n    }\n\n    removeNotebookEditor(editor: NotebookEditorWidget): void {\n        if (this.notebookEditors.has(editor.id)) {\n            this.notebookEditors.delete(editor.id);\n            this.onNotebookEditorRemoveEmitter.fire(editor);\n        } else {\n            console.warn('Attempting to remove not registered editor: ' + editor.id);\n        }\n    }\n\n    getNotebookEditor(editorId: string): NotebookEditorWidget | undefined {\n        return this.notebookEditors.get(editorId);\n    }\n\n    getNotebookEditors(): readonly NotebookEditorWidget[] {\n        return Array.from(this.notebookEditors.values());\n    }\n\n    notebookEditorFocusChanged(editor: NotebookEditorWidget, focus: boolean): void {\n        if (focus) {\n            if (editor !== this.focusedEditor) {\n                this.focusedEditor = editor;\n                this.contextKeyService.setContext(NOTEBOOK_EDITOR_FOCUSED, true);\n                this.onDidChangeFocusedEditorEmitter.fire(this.focusedEditor);\n            }\n        } else if (this.focusedEditor) {\n            this.focusedEditor = undefined;\n            this.contextKeyService.setContext(NOTEBOOK_EDITOR_FOCUSED, false);\n            this.onDidChangeFocusedEditorEmitter.fire(undefined);\n        }\n    }\n\n    currentNotebookEditorChanged(newEditor: unknown): void {\n        if (newEditor instanceof NotebookEditorWidget) {\n            this.currentEditor = newEditor;\n            this.onDidChangeCurrentEditorEmitter.fire(newEditor);\n        } else if (this.currentEditor?.isDisposed || !this.currentEditor?.isVisible) {\n            this.currentEditor = undefined;\n            this.onDidChangeCurrentEditorEmitter.fire(undefined);\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { inject, injectable, named } from '@theia/core/shared/inversify';\nimport { CellExecution, NotebookExecutionStateService } from '../service/notebook-execution-state-service';\nimport { CellKind, NotebookCellExecutionState } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookKernelService } from './notebook-kernel-service';\nimport { CommandService, Disposable, ILogger } from '@theia/core';\nimport { NotebookKernelQuickPickService } from './notebook-kernel-quick-pick-service';\nimport { NotebookKernelHistoryService } from './notebook-kernel-history-service';\n\nexport interface CellExecutionParticipant {\n    onWillExecuteCell(executions: CellExecution[]): Promise<void>;\n}\n\n@injectable()\nexport class NotebookExecutionService {\n\n    @inject(NotebookExecutionStateService)\n    protected notebookExecutionStateService: NotebookExecutionStateService;\n\n    @inject(NotebookKernelService)\n    protected notebookKernelService: NotebookKernelService;\n\n    @inject(NotebookKernelHistoryService)\n    protected notebookKernelHistoryService: NotebookKernelHistoryService;\n\n    @inject(CommandService)\n    protected commandService: CommandService;\n\n    @inject(NotebookKernelQuickPickService)\n    protected notebookKernelQuickPickService: NotebookKernelQuickPickService;\n\n    @inject(ILogger) @named('notebook')\n    protected readonly logger: ILogger;\n\n    protected readonly cellExecutionParticipants = new Set<CellExecutionParticipant>();\n\n    async executeNotebookCells(notebook: NotebookModel, cells: Iterable<NotebookCellModel>): Promise<void> {\n        const cellsArr = Array.from(cells)\n            .filter(c => c.cellKind === CellKind.Code);\n        if (!cellsArr.length) {\n            return;\n        }\n\n        this.logger.debug('Executing notebook cells', {\n            notebook: notebook.uri.toString(),\n            cells: cellsArr.map(c => c.handle)\n        });\n\n        // create cell executions\n        const cellExecutions: [NotebookCellModel, CellExecution][] = [];\n        for (const cell of cellsArr) {\n            const cellExe = this.notebookExecutionStateService.getCellExecution(cell.uri);\n            if (!cellExe) {\n                cellExecutions.push([cell, this.notebookExecutionStateService.getOrCreateCellExecution(notebook.uri, cell.handle)]);\n            }\n        }\n\n        const kernel = await this.notebookKernelHistoryService.resolveSelectedKernel(notebook);\n\n        if (!kernel) {\n            this.logger.debug('Failed to resolve kernel for execution', notebook.uri.toString());\n            // clear all pending cell executions\n            cellExecutions.forEach(cellExe => cellExe[1].complete({}));\n            return;\n        }\n\n        // filter cell executions based on selected kernel\n        const validCellExecutions: CellExecution[] = [];\n        for (const [cell, cellExecution] of cellExecutions) {\n            if (!kernel.supportedLanguages.includes(cell.language)) {\n                cellExecution.complete({});\n            } else {\n                validCellExecutions.push(cellExecution);\n            }\n        }\n\n        // request execution\n        if (validCellExecutions.length > 0) {\n            const cellRemoveListener = notebook.onDidAddOrRemoveCell(e => {\n                if (e.rawEvent.changes.some(c => c.deleteCount > 0)) {\n                    const executionsToCancel = validCellExecutions.filter(exec => !notebook.cells.find(cell => cell.handle === exec.cellHandle));\n                    if (executionsToCancel.length > 0) {\n                        kernel.cancelNotebookCellExecution(notebook.uri, executionsToCancel.map(c => c.cellHandle));\n                        executionsToCancel.forEach(exec => exec.complete({}));\n                    }\n                }\n            });\n            await this.runExecutionParticipants(validCellExecutions);\n\n            this.logger.debug('Selecting kernel for cell execution', {\n                notebook: notebook.uri.toString(),\n                kernel: kernel.id\n            });\n            this.notebookKernelService.selectKernelForNotebook(kernel, notebook);\n\n            this.logger.debug('Running cell execution request', {\n                notebook: notebook.uri.toString(),\n                cells: validCellExecutions.map(c => c.cellHandle)\n            });\n            await kernel.executeNotebookCellsRequest(notebook.uri, validCellExecutions.map(c => c.cellHandle));\n            // the connecting state can change before the kernel resolves executeNotebookCellsRequest\n            const unconfirmed = validCellExecutions.filter(exe => exe.state === NotebookCellExecutionState.Unconfirmed);\n            if (unconfirmed.length) {\n                unconfirmed.forEach(exe => exe.complete({}));\n            }\n\n            cellRemoveListener.dispose();\n\n        }\n    }\n\n    registerExecutionParticipant(participant: CellExecutionParticipant): Disposable {\n        this.cellExecutionParticipants.add(participant);\n        return Disposable.create(() => this.cellExecutionParticipants.delete(participant));\n    }\n\n    protected async runExecutionParticipants(executions: CellExecution[]): Promise<void> {\n        for (const participant of this.cellExecutionParticipants) {\n            await participant.onWillExecuteCell(executions);\n        }\n        return;\n    }\n\n    async cancelNotebookCellHandles(notebook: NotebookModel, cells: Iterable<number>): Promise<void> {\n        const cellsArr = Array.from(cells);\n        const kernel = this.notebookKernelService.getSelectedOrSuggestedKernel(notebook);\n        if (kernel) {\n            await kernel.cancelNotebookCellExecution(notebook.uri, cellsArr);\n        }\n    }\n\n    async cancelNotebookCells(notebook: NotebookModel, cells: Iterable<NotebookCellModel>): Promise<void> {\n        this.cancelNotebookCellHandles(notebook, Array.from(cells, cell => cell.handle));\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableCollection, Emitter, URI, generateUuid } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { NotebookService } from './notebook-service';\nimport {\n    CellEditType, CellExecuteOutputEdit, CellExecuteOutputItemEdit, CellExecutionUpdateType,\n    CellUri, NotebookCellExecutionState, NotebookCellInternalMetadata\n} from '../../common';\nimport { CellPartialInternalMetadataEditByHandle, CellEditOperation } from '../notebook-types';\nimport { NotebookModel } from '../view-model/notebook-model';\n\nexport type CellExecuteUpdate = CellExecuteOutputEdit | CellExecuteOutputItemEdit | CellExecutionStateUpdate;\n\nexport interface CellExecutionComplete {\n    runEndTime?: number;\n    lastRunSuccess?: boolean;\n}\n\nexport interface CellExecutionStateUpdate {\n    editType: CellExecutionUpdateType.ExecutionState;\n    executionOrder?: number;\n    runStartTime?: number;\n    didPause?: boolean;\n    isPaused?: boolean;\n}\n\nexport enum NotebookExecutionType {\n    cell,\n    notebook\n}\n\nexport interface NotebookFailStateChangedEvent {\n    visible: boolean;\n    notebook: URI;\n}\n\nexport interface FailedCellInfo {\n    cellHandle: number;\n    disposable: Disposable;\n    visible: boolean;\n}\n\n@injectable()\nexport class NotebookExecutionStateService implements Disposable {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    protected toDispose: DisposableCollection = new DisposableCollection();\n\n    protected readonly executions = new Map<string, Map<number, CellExecution>>();\n\n    protected readonly onDidChangeExecutionEmitter = new Emitter<CellExecutionStateChangedEvent>();\n    onDidChangeExecution = this.onDidChangeExecutionEmitter.event;\n\n    protected readonly onDidChangeLastRunFailStateEmitter = new Emitter<NotebookFailStateChangedEvent>();\n    onDidChangeLastRunFailState = this.onDidChangeLastRunFailStateEmitter.event;\n\n    getOrCreateCellExecution(notebookUri: URI, cellHandle: number): CellExecution {\n        const notebook = this.notebookService.getNotebookEditorModel(notebookUri);\n\n        if (!notebook) {\n            throw new Error(`Notebook not found: ${notebookUri.toString()}`);\n        }\n\n        let execution = this.executions.get(notebookUri.toString())?.get(cellHandle);\n\n        if (!execution) {\n            execution = this.createNotebookCellExecution(notebook, cellHandle);\n            if (!this.executions.has(notebookUri.toString())) {\n                this.executions.set(notebookUri.toString(), new Map());\n            }\n            this.executions.get(notebookUri.toString())?.set(cellHandle, execution);\n            execution.initialize();\n            this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle, execution));\n        }\n\n        return execution;\n\n    }\n\n    protected createNotebookCellExecution(notebook: NotebookModel, cellHandle: number): CellExecution {\n        const notebookUri = notebook.uri;\n        const execution = new CellExecution(cellHandle, notebook);\n        execution.toDispose.push(execution.onDidUpdate(() => this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle, execution))));\n        execution.toDispose.push(execution.onDidComplete(lastRunSuccess => this.onCellExecutionDidComplete(notebookUri, cellHandle, execution, lastRunSuccess)));\n\n        return execution;\n    }\n\n    protected onCellExecutionDidComplete(notebookUri: URI, cellHandle: number, exe: CellExecution, lastRunSuccess?: boolean): void {\n        const notebookExecutions = this.executions.get(notebookUri.toString())?.get(cellHandle);\n        if (!notebookExecutions) {\n            throw new Error('Notebook Cell Execution not found while trying to complete it');\n        }\n\n        exe.dispose();\n        this.executions.get(notebookUri.toString())?.delete(cellHandle);\n\n        this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle));\n    }\n\n    getCellExecution(cellUri: URI): CellExecution | undefined {\n        const parsed = CellUri.parse(cellUri);\n        if (!parsed) {\n            throw new Error(`Not a cell URI: ${cellUri}`);\n        }\n\n        return this.executions.get(parsed.notebook.toString())?.get(parsed.handle);\n    }\n\n    dispose(): void {\n        this.onDidChangeExecutionEmitter.dispose();\n        this.onDidChangeLastRunFailStateEmitter.dispose();\n\n        this.executions.forEach(notebookExecutions => notebookExecutions.forEach(execution => execution.dispose()));\n    }\n\n}\n\nexport class CellExecution implements Disposable {\n    protected readonly onDidUpdateEmitter = new Emitter<void>();\n    readonly onDidUpdate = this.onDidUpdateEmitter.event;\n\n    protected readonly onDidCompleteEmitter = new Emitter<boolean | undefined>();\n    readonly onDidComplete = this.onDidCompleteEmitter.event;\n\n    toDispose = new DisposableCollection();\n\n    protected _state: NotebookCellExecutionState = NotebookCellExecutionState.Unconfirmed;\n    get state(): NotebookCellExecutionState {\n        return this._state;\n    }\n\n    get notebookURI(): URI {\n        return this.notebook.uri;\n    }\n\n    protected _didPause = false;\n    get didPause(): boolean {\n        return this._didPause;\n    }\n\n    protected _isPaused = false;\n    get isPaused(): boolean {\n        return this._isPaused;\n    }\n\n    constructor(\n        readonly cellHandle: number,\n        protected readonly notebook: NotebookModel,\n    ) {\n    }\n\n    initialize(): void {\n        const startExecuteEdit: CellPartialInternalMetadataEditByHandle = {\n            editType: CellEditType.PartialInternalMetadata,\n            handle: this.cellHandle,\n            internalMetadata: {\n                executionId: generateUuid(),\n                runStartTime: undefined,\n                runEndTime: undefined,\n                lastRunSuccess: undefined,\n                executionOrder: undefined,\n                renderDuration: undefined,\n            }\n        };\n        this.applyCellExecutionEditsToNotebook([startExecuteEdit]);\n    }\n\n    confirm(): void {\n        this._state = NotebookCellExecutionState.Pending;\n        this.onDidUpdateEmitter.fire();\n    }\n\n    update(updates: CellExecuteUpdate[]): void {\n        if (updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState)) {\n            this._state = NotebookCellExecutionState.Executing;\n        }\n\n        if (!this._didPause && updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState && u.didPause)) {\n            this._didPause = true;\n        }\n\n        const lastIsPausedUpdate = [...updates].reverse().find(u => u.editType === CellExecutionUpdateType.ExecutionState && typeof u.isPaused === 'boolean');\n        if (lastIsPausedUpdate) {\n            this._isPaused = (lastIsPausedUpdate as CellExecutionStateUpdate).isPaused!;\n        }\n\n        const cellModel = this.notebook.cells.find(c => c.handle === this.cellHandle);\n        if (!cellModel) {\n            console.debug(`CellExecution#update, updating cell not in notebook: ${this.notebook.uri.toString()}, ${this.cellHandle}`);\n        } else {\n            const edits = updates.map(update => updateToEdit(update, this.cellHandle));\n            this.applyCellExecutionEditsToNotebook(edits);\n        }\n\n        if (updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState)) {\n            this.onDidUpdateEmitter.fire();\n        }\n\n    }\n\n    complete(completionData: CellExecutionComplete): void {\n        const cellModel = this.notebook.cells.find(c => c.handle === this.cellHandle);\n        if (!cellModel) {\n            console.debug(`CellExecution#complete, completing cell not in notebook: ${this.notebook.uri.toString()}, ${this.cellHandle}`);\n        } else {\n            const edit: CellEditOperation = {\n                editType: CellEditType.PartialInternalMetadata,\n                handle: this.cellHandle,\n                internalMetadata: {\n                    lastRunSuccess: completionData.lastRunSuccess,\n                    // eslint-disable-next-line no-null/no-null\n                    runStartTime: this._didPause ? null : cellModel.internalMetadata.runStartTime,\n                    // eslint-disable-next-line no-null/no-null\n                    runEndTime: this._didPause ? null : completionData.runEndTime,\n                }\n            };\n            this.applyCellExecutionEditsToNotebook([edit]);\n        }\n\n        this.onDidCompleteEmitter.fire(completionData.lastRunSuccess);\n\n    }\n\n    dispose(): void {\n        this.onDidUpdateEmitter.dispose();\n        this.onDidCompleteEmitter.dispose();\n        this.toDispose.dispose();\n    }\n\n    protected applyCellExecutionEditsToNotebook(edits: CellEditOperation[]): void {\n        this.notebook.applyEdits(edits, false);\n    }\n}\n\nexport class CellExecutionStateChangedEvent {\n    readonly type = NotebookExecutionType.cell;\n    constructor(\n        readonly notebook: URI,\n        readonly cellHandle: number,\n        readonly changed?: CellExecution\n    ) { }\n\n    affectsCell(cell: URI): boolean {\n        const parsedUri = CellUri.parse(cell);\n        return !!parsedUri && this.notebook.isEqual(parsedUri.notebook) && this.cellHandle === parsedUri.handle;\n    }\n\n    affectsNotebook(notebook: URI): boolean {\n        return this.notebook.toString() === notebook.toString();\n    }\n}\n\nexport function updateToEdit(update: CellExecuteUpdate, cellHandle: number): CellEditOperation {\n    if (update.editType === CellExecutionUpdateType.Output) {\n        return {\n            editType: CellEditType.Output,\n            handle: update.cellHandle,\n            append: update.append,\n            outputs: update.outputs,\n        };\n    } else if (update.editType === CellExecutionUpdateType.OutputItems) {\n        return {\n            editType: CellEditType.OutputItems,\n            items: update.items,\n            outputId: update.outputId,\n            append: update.append,\n        };\n    } else if (update.editType === CellExecutionUpdateType.ExecutionState) {\n        const newInternalMetadata: Partial<NotebookCellInternalMetadata> = {};\n        if (typeof update.executionOrder !== 'undefined') {\n            newInternalMetadata.executionOrder = update.executionOrder;\n        }\n        if (typeof update.runStartTime !== 'undefined') {\n            newInternalMetadata.runStartTime = update.runStartTime;\n        }\n        return {\n            editType: CellEditType.PartialInternalMetadata,\n            handle: cellHandle,\n            internalMetadata: newInternalMetadata\n        };\n    }\n\n    throw new Error('Unknown cell update type');\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { StorageService } from '@theia/core/lib/browser';\nimport { NotebookKernel, NotebookTextModelLike, NotebookKernelService } from './notebook-kernel-service';\nimport { CommandService, Disposable } from '@theia/core';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCommands } from '../contributions/notebook-actions-contribution';\n\ninterface KernelsList {\n    [viewType: string]: string[];\n}\n\ninterface MostRecentKernelsResult {\n    selected?: NotebookKernel,\n    all: NotebookKernel[]\n}\n\nconst MAX_KERNELS_IN_HISTORY = 5;\n\n@injectable()\nexport class NotebookKernelHistoryService implements Disposable {\n\n    @inject(StorageService)\n    protected storageService: StorageService;\n\n    @inject(NotebookKernelService)\n    protected notebookKernelService: NotebookKernelService;\n\n    @inject(CommandService)\n    protected commandService: CommandService;\n\n    protected static STORAGE_KEY = 'notebook.kernelHistory';\n    protected mostRecentKernelsMap: KernelsList = {};\n\n    @postConstruct()\n    protected init(): void {\n        this.loadState();\n    }\n\n    getKernels(notebook: NotebookTextModelLike): MostRecentKernelsResult {\n        const allAvailableKernels = this.notebookKernelService.getMatchingKernel(notebook);\n        const allKernels = allAvailableKernels.all;\n        const selectedKernel = allAvailableKernels.selected;\n        // We will suggest the only kernel\n        const suggested = allAvailableKernels.all.length === 1 ? allAvailableKernels.all[0] : undefined;\n        const mostRecentKernelIds = this.mostRecentKernelsMap[notebook.viewType] ? this.mostRecentKernelsMap[notebook.viewType].map(kernel => kernel[1]) : [];\n        const all = mostRecentKernelIds.map(kernelId => allKernels.find(kernel => kernel.id === kernelId)).filter(kernel => !!kernel) as NotebookKernel[];\n\n        return {\n            selected: selectedKernel ?? suggested,\n            all\n        };\n    }\n\n    async resolveSelectedKernel(notebook: NotebookModel): Promise<NotebookKernel | undefined> {\n        const alreadySelected = this.getKernels(notebook);\n\n        if (alreadySelected.selected) {\n            return alreadySelected.selected;\n        }\n\n        await this.commandService.executeCommand(NotebookCommands.SELECT_KERNEL_COMMAND.id, notebook);\n        const { selected } = this.getKernels(notebook);\n        return selected;\n    }\n\n    addMostRecentKernel(kernel: NotebookKernel): void {\n        const viewType = kernel.viewType;\n        const recentKernels = this.mostRecentKernelsMap[viewType] ?? [kernel.id];\n\n        if (recentKernels.length > MAX_KERNELS_IN_HISTORY) {\n            recentKernels.splice(MAX_KERNELS_IN_HISTORY);\n        }\n\n        this.mostRecentKernelsMap[viewType] = recentKernels;\n        this.saveState();\n    }\n\n    protected saveState(): void {\n        let notEmpty = false;\n        for (const kernels of Object.values(this.mostRecentKernelsMap)) {\n            notEmpty = notEmpty || Object.entries(kernels).length > 0;\n        }\n\n        this.storageService.setData(NotebookKernelHistoryService.STORAGE_KEY, notEmpty ? this.mostRecentKernelsMap : undefined);\n    }\n\n    protected async loadState(): Promise<void> {\n        const kernelMap = await this.storageService.getData(NotebookKernelHistoryService.STORAGE_KEY);\n        if (kernelMap) {\n            this.mostRecentKernelsMap = kernelMap as KernelsList;\n        } else {\n            this.mostRecentKernelsMap = {};\n        }\n    }\n\n    clear(): void {\n        this.mostRecentKernelsMap = {};\n        this.saveState();\n    }\n\n    dispose(): void {\n\n    }\n}\n","\n// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ArrayUtils, CommandService, DisposableCollection, Event, ILogger, nls, QuickInputButton, QuickInputService, QuickPickInput, QuickPickItem, URI, } from '@theia/core';\nimport { inject, injectable, named } from '@theia/core/shared/inversify';\nimport { NotebookKernelService, NotebookKernel, NotebookKernelMatchResult, SourceCommand } from './notebook-kernel-service';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { codicon, OpenerService } from '@theia/core/lib/browser';\nimport { NotebookKernelHistoryService } from './notebook-kernel-history-service';\nimport { NotebookCommand, NotebookModelResource } from '../../common';\nimport debounce = require('@theia/core/shared/lodash.debounce');\n\nexport const JUPYTER_EXTENSION_ID = 'ms-toolsai.jupyter';\n\ntype KernelPick = QuickPickItem & { kernel: NotebookKernel };\nfunction isKernelPick(item: QuickPickInput<QuickPickItem>): item is KernelPick {\n    return 'kernel' in item;\n}\ntype GroupedKernelsPick = QuickPickItem & { kernels: NotebookKernel[]; source: string };\nfunction isGroupedKernelsPick(item: QuickPickInput<QuickPickItem>): item is GroupedKernelsPick {\n    return 'kernels' in item;\n}\ntype SourcePick = QuickPickItem & { action: SourceCommand };\nfunction isSourcePick(item: QuickPickInput<QuickPickItem>): item is SourcePick {\n    return 'action' in item;\n}\ntype InstallExtensionPick = QuickPickItem & { extensionIds: string[] };\n\ntype KernelSourceQuickPickItem = QuickPickItem & { command: NotebookCommand; documentation?: string };\nfunction isKernelSourceQuickPickItem(item: QuickPickItem): item is KernelSourceQuickPickItem {\n    return 'command' in item;\n}\n\nfunction supportAutoRun(item: QuickPickInput<KernelQuickPickItem>): item is QuickPickItem {\n    return 'autoRun' in item && !!item.autoRun;\n}\n\ntype KernelQuickPickItem = (QuickPickItem & { autoRun?: boolean }) | InstallExtensionPick | KernelPick | GroupedKernelsPick | SourcePick | KernelSourceQuickPickItem;\n\nconst KERNEL_PICKER_UPDATE_DEBOUNCE = 200;\n\nexport type KernelQuickPickContext =\n    { id: string; extension: string } |\n    { notebookEditorId: string } |\n    { id: string; extension: string; notebookEditorId: string } |\n    { ui?: boolean; notebookEditor?: NotebookEditorWidget };\n\nfunction toKernelQuickPick(kernel: NotebookKernel, selected: NotebookKernel | undefined): KernelPick {\n    const res: KernelPick = {\n        kernel,\n        label: kernel.label,\n        description: kernel.description,\n        detail: kernel.detail\n    };\n    if (kernel.id === selected?.id) {\n        if (!res.description) {\n            res.description = nls.localizeByDefault('Currently Selected');\n        } else {\n            res.description = nls.localizeByDefault('{0} - Currently Selected', res.description);\n        }\n    }\n    return res;\n}\n\n@injectable()\nexport class NotebookKernelQuickPickService {\n\n    @inject(NotebookKernelService)\n    protected readonly notebookKernelService: NotebookKernelService;\n    @inject(QuickInputService)\n    protected readonly quickInputService: QuickInputService;\n    @inject(CommandService)\n    protected readonly commandService: CommandService;\n    @inject(OpenerService)\n    protected readonly openerService: OpenerService;\n    @inject(NotebookKernelHistoryService)\n    protected readonly notebookKernelHistoryService: NotebookKernelHistoryService;\n    @inject(ILogger) @named('notebook')\n    protected readonly logger: ILogger;\n\n    async showQuickPick(editor: NotebookModel, wantedId?: string, skipAutoRun?: boolean): Promise<boolean> {\n        const notebook = editor;\n        const matchResult = this.getMatchingResult(notebook);\n        const { selected, all } = matchResult;\n\n        let newKernel: NotebookKernel | undefined;\n        if (wantedId) {\n            for (const candidate of all) {\n                if (candidate.id === wantedId) {\n                    newKernel = candidate;\n                    break;\n                }\n            }\n            if (!newKernel) {\n                console.warn(`wanted kernel DOES NOT EXIST, wanted: ${wantedId}, all: ${all.map(k => k.id)}`);\n                return false;\n            }\n        }\n\n        if (newKernel) {\n            this.selectKernel(notebook, newKernel);\n            return true;\n        }\n\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        const quickPickItems = this.getKernelPickerQuickPickItems(matchResult);\n\n        if (quickPickItems.length === 1 && supportAutoRun(quickPickItems[0]) && !skipAutoRun) {\n            return this.handleQuickPick(editor, quickPickItems[0], quickPickItems as KernelQuickPickItem[]);\n        }\n\n        quickPick.items = quickPickItems;\n        quickPick.canSelectMany = false;\n        quickPick.placeholder = selected\n            ? nls.localizeByDefault(\"Change kernel for '{0}'\", 'current') // TODO get label for current notebook from a label provider\n            : nls.localizeByDefault(\"Select kernel for '{0}'\", 'current');\n\n        quickPick.busy = this.notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n\n        const kernelDetectionTaskListener = this.notebookKernelService.onDidChangeKernelDetectionTasks(() => {\n            quickPick.busy = this.notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n        });\n\n        const kernelChangeEventListener = debounce(\n            Event.any(\n                this.notebookKernelService.onDidChangeSourceActions,\n                this.notebookKernelService.onDidAddKernel,\n                this.notebookKernelService.onDidRemoveKernel,\n                this.notebookKernelService.onDidChangeNotebookAffinity\n            ),\n            KERNEL_PICKER_UPDATE_DEBOUNCE\n        )(async () => {\n            // reset quick pick progress\n            quickPick.busy = false;\n\n            const currentActiveItems = quickPick.activeItems;\n            const newMatchResult = this.getMatchingResult(notebook);\n            const newQuickPickItems = this.getKernelPickerQuickPickItems(newMatchResult);\n            quickPick.keepScrollPosition = true;\n\n            // recalculate active items\n            const activeItems: KernelQuickPickItem[] = [];\n            for (const item of currentActiveItems) {\n                if (isKernelPick(item)) {\n                    const kernelId = item.kernel.id;\n                    const sameItem = newQuickPickItems.find(pi => isKernelPick(pi) && pi.kernel.id === kernelId) as KernelPick | undefined;\n                    if (sameItem) {\n                        activeItems.push(sameItem);\n                    }\n                } else if (isSourcePick(item)) {\n                    const sameItem = newQuickPickItems.find(pi => isSourcePick(pi) && pi.action.command.id === item.action.command.id) as SourcePick | undefined;\n                    if (sameItem) {\n                        activeItems.push(sameItem);\n                    }\n                }\n            }\n\n            quickPick.items = newQuickPickItems;\n            quickPick.activeItems = activeItems;\n        }, this);\n\n        const pick = await new Promise<{ selected: KernelQuickPickItem | undefined; items: KernelQuickPickItem[] }>((resolve, reject) => {\n            quickPick.onDidAccept(() => {\n                const item = quickPick.selectedItems[0];\n                if (item) {\n                    resolve({ selected: item, items: quickPick.items as KernelQuickPickItem[] });\n                } else {\n                    resolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n                }\n\n                quickPick.hide();\n            });\n\n            quickPick.onDidHide(() => {\n                kernelDetectionTaskListener.dispose();\n                kernelChangeEventListener?.dispose();\n                quickPick.dispose();\n                resolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n            });\n            quickPick.show();\n        });\n\n        if (pick.selected) {\n            return this.handleQuickPick(editor, pick.selected, pick.items);\n        }\n\n        return false;\n    }\n\n    protected getKernelPickerQuickPickItems(matchResult: NotebookKernelMatchResult): QuickPickInput<KernelQuickPickItem>[] {\n        const quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n        if (matchResult.selected) {\n            const kernelItem = toKernelQuickPick(matchResult.selected, matchResult.selected);\n            quickPickItems.push(kernelItem);\n        }\n\n        // TODO use suggested here when kernel affinity is implemented. For now though show all kernels\n        matchResult.all.filter(kernel => kernel.id !== matchResult.selected?.id).map(kernel => toKernelQuickPick(kernel, matchResult.selected))\n            .forEach(kernel => {\n                quickPickItems.push(kernel);\n            });\n\n        const shouldAutoRun = quickPickItems.length === 0;\n\n        if (quickPickItems.length > 0) {\n            quickPickItems.push({\n                type: 'separator'\n            });\n        }\n\n        // select another kernel quick pick\n        quickPickItems.push({\n            id: 'selectAnother',\n            label: nls.localizeByDefault('Select Another Kernel...'),\n            autoRun: shouldAutoRun\n        });\n\n        return quickPickItems;\n    }\n\n    protected selectKernel(notebook: NotebookModel, kernel: NotebookKernel): void {\n        this.logger.debug('Selected notebook kernel', {\n            notebook: notebook.uri.toString(),\n            kernel: kernel.id\n        });\n        const currentInfo = this.notebookKernelService.getMatchingKernel(notebook);\n        if (currentInfo.selected) {\n            // there is already a selected kernel\n            this.notebookKernelHistoryService.addMostRecentKernel(currentInfo.selected);\n        }\n        this.notebookKernelService.selectKernelForNotebook(kernel, notebook);\n        this.notebookKernelHistoryService.addMostRecentKernel(kernel);\n    }\n\n    protected getMatchingResult(notebook: NotebookModel): NotebookKernelMatchResult {\n        const { selected, all } = this.notebookKernelHistoryService.getKernels(notebook);\n        const matchingResult = this.notebookKernelService.getMatchingKernel(notebook);\n        return {\n            selected: selected,\n            all: matchingResult.all,\n            suggestions: all,\n            hidden: []\n        };\n    }\n\n    protected async handleQuickPick(editor: NotebookModel, pick: KernelQuickPickItem, items: KernelQuickPickItem[]): Promise<boolean> {\n        if (pick.id === 'selectAnother') {\n            return this.displaySelectAnotherQuickPick(editor, items.length === 1 && items[0] === pick);\n        }\n\n        if (isKernelPick(pick)) {\n            const newKernel = pick.kernel;\n            this.selectKernel(editor, newKernel);\n            return true;\n        }\n\n        if (isSourcePick(pick)) {\n            this.logger.debug('Selected notebook kernel command', {\n                notebook: editor.uri.toString(),\n                command: pick.action.command.id\n            });\n            // selected explicitly, it should trigger the execution?\n            pick.action.run(this.commandService);\n        }\n\n        return true;\n    }\n\n    protected async displaySelectAnotherQuickPick(editor: NotebookModel, kernelListEmpty: boolean): Promise<boolean> {\n        const notebook: NotebookModel = editor;\n        const disposables = new DisposableCollection();\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        const quickPickItem = await new Promise<KernelQuickPickItem | QuickInputButton | undefined>(resolve => {\n            // select from kernel sources\n            quickPick.title = kernelListEmpty ? nls.localizeByDefault('Select Kernel') : nls.localizeByDefault('Select Another Kernel');\n            quickPick.placeholder = nls.localizeByDefault('Type to choose a kernel source');\n            quickPick.busy = true;\n            // quickPick.buttons = [this.quickInputService.backButton];\n            quickPick.show();\n\n            disposables.push(quickPick.onDidTriggerButton(button => {\n                if (button === this.quickInputService.backButton) {\n                    resolve(button);\n                }\n            }));\n            quickPick.onDidTriggerItemButton(async e => {\n\n                if (isKernelSourceQuickPickItem(e.item) && e.item.documentation !== undefined) {\n                    const uri: URI | undefined = this.isUri(e.item.documentation) ? new URI(e.item.documentation) : await this.commandService.executeCommand(e.item.documentation);\n                    if (uri) {\n                        (await this.openerService.getOpener(uri, { openExternal: true })).open(uri, { openExternal: true });\n                    }\n                }\n            });\n            disposables.push(quickPick.onDidAccept(async () => {\n                resolve(quickPick.selectedItems[0]);\n            }));\n            disposables.push(quickPick.onDidHide(() => {\n                resolve(undefined);\n            }));\n\n            this.calculateKernelSources(editor).then(quickPickItems => {\n                quickPick.items = quickPickItems;\n                if (quickPick.items.length > 0) {\n                    quickPick.busy = false;\n                }\n            });\n\n            debounce(\n                Event.any(\n                    this.notebookKernelService.onDidChangeSourceActions,\n                    this.notebookKernelService.onDidAddKernel,\n                    this.notebookKernelService.onDidRemoveKernel\n                ),\n                KERNEL_PICKER_UPDATE_DEBOUNCE,\n            )(async () => {\n                quickPick.busy = true;\n                const quickPickItems = await this.calculateKernelSources(editor);\n                quickPick.items = quickPickItems;\n                quickPick.busy = false;\n            });\n        });\n\n        quickPick.hide();\n        disposables.dispose();\n\n        if (quickPickItem === this.quickInputService.backButton) {\n            return this.showQuickPick(editor, undefined, true);\n        }\n\n        if (quickPickItem) {\n            const selectedKernelPickItem = quickPickItem as KernelQuickPickItem;\n            if (isKernelSourceQuickPickItem(selectedKernelPickItem)) {\n                try {\n                    const selectedKernelId = await this.executeCommand<string>(notebook, selectedKernelPickItem.command);\n                    if (selectedKernelId) {\n                        const { all } = this.getMatchingResult(notebook);\n                        const notebookKernel = all.find(kernel => kernel.id === `ms-toolsai.jupyter/${selectedKernelId}`);\n                        if (notebookKernel) {\n                            this.selectKernel(notebook, notebookKernel);\n                            return true;\n                        }\n                        return true;\n                    } else {\n                        return this.displaySelectAnotherQuickPick(editor, false);\n                    }\n                } catch (ex) {\n                    console.error('Failed to select notebook kernel', ex);\n                    return false;\n                }\n            } else if (isKernelPick(selectedKernelPickItem)) {\n                this.selectKernel(notebook, selectedKernelPickItem.kernel);\n                return true;\n            } else if (isGroupedKernelsPick(selectedKernelPickItem)) {\n                await this.selectOneKernel(notebook, selectedKernelPickItem.source, selectedKernelPickItem.kernels);\n                return true;\n            } else if (isSourcePick(selectedKernelPickItem)) {\n                // selected explicitly, it should trigger the execution?\n                try {\n                    await selectedKernelPickItem.action.run(this.commandService);\n                    return true;\n                } catch (ex) {\n                    console.error('Failed to select notebook kernel', ex);\n                    return false;\n                }\n            }\n            // } else if (isSearchMarketplacePick(selectedKernelPickItem)) {\n            //     await this.showKernelExtension(\n            //         this.paneCompositePartService,\n            //         this.extensionWorkbenchService,\n            //         this.extensionService,\n            //         editor.textModel.viewType,\n            //         []\n            //     );\n            //     return true;\n            // } else if (isInstallExtensionPick(selectedKernelPickItem)) {\n            //     await this.showKernelExtension(\n            //         this.paneCompositePartService,\n            //         this.extensionWorkbenchService,\n            //         this.extensionService,\n            //         editor.textModel.viewType,\n            //         selectedKernelPickItem.extensionIds,\n            //     );\n            //     return true;\n            // }\n        }\n\n        return false;\n    }\n\n    protected isUri(value: string): boolean {\n        return /^(?<scheme>\\w[\\w\\d+.-]*):/.test(value);\n    }\n\n    protected async calculateKernelSources(editor: NotebookModel): Promise<QuickPickInput<KernelQuickPickItem>[]> {\n        const notebook: NotebookModel = editor;\n\n        const actions = await this.notebookKernelService.getKernelSourceActionsFromProviders(notebook);\n        const matchResult = this.getMatchingResult(notebook);\n\n        const others = matchResult.all.filter(item => item.extensionId !== JUPYTER_EXTENSION_ID);\n        const quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n        // group controllers by extension\n        for (const group of ArrayUtils.groupBy(others, (a, b) => a.extensionId === b.extensionId ? 0 : 1)) {\n            const source = group[0].extensionId;\n            if (group.length > 1) {\n                quickPickItems.push({\n                    label: source,\n                    kernels: group\n                });\n            } else {\n                quickPickItems.push({\n                    label: group[0].label,\n                    kernel: group[0]\n                });\n            }\n        }\n\n        const validActions = actions.filter(action => action.command);\n\n        quickPickItems.push(...validActions.map(action => {\n            const buttons = action.documentation ? [{\n                iconClass: codicon('info'),\n                tooltip: nls.localizeByDefault('Learn More'),\n            }] : [];\n            return {\n                id: typeof action.command! === 'string' ? action.command! : action.command!.id,\n                label: action.label,\n                description: action.description,\n                command: action.command,\n                documentation: action.documentation,\n                buttons\n            };\n        }));\n\n        return quickPickItems;\n    }\n\n    protected async selectOneKernel(notebook: NotebookModel, source: string, kernels: NotebookKernel[]): Promise<void> {\n        const quickPickItems: QuickPickInput<KernelPick>[] = kernels.map(kernel => toKernelQuickPick(kernel, undefined));\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        quickPick.items = quickPickItems;\n        quickPick.canSelectMany = false;\n\n        quickPick.title = nls.localizeByDefault('Select Kernel from {0}', source);\n\n        quickPick.onDidAccept(async () => {\n            if (quickPick.selectedItems && quickPick.selectedItems.length > 0 && isKernelPick(quickPick.selectedItems[0])) {\n                this.selectKernel(notebook, quickPick.selectedItems[0].kernel);\n            }\n\n            quickPick.hide();\n            quickPick.dispose();\n        });\n\n        quickPick.onDidHide(() => {\n            quickPick.dispose();\n        });\n\n        quickPick.show();\n    }\n\n    protected async executeCommand<T>(notebook: NotebookModel, command: NotebookCommand): Promise<T | undefined | void> {\n        const args = (command.arguments || []).concat([NotebookModelResource.create(notebook.uri)]);\n        return this.commandService.executeCommand(command.id, ...args);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Command, CommandService, Disposable, Emitter, Event, URI } from '@theia/core';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { StorageService } from '@theia/core/lib/browser';\nimport { NotebookKernelSourceAction } from '../../common';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from './notebook-service';\n\nexport interface SelectedNotebookKernelChangeEvent {\n    notebook: URI;\n    oldKernel: string | undefined;\n    newKernel: string | undefined;\n}\n\nexport interface NotebookKernelMatchResult {\n    readonly selected: NotebookKernel | undefined;\n    readonly suggestions: NotebookKernel[];\n    readonly all: NotebookKernel[];\n    readonly hidden: NotebookKernel[];\n}\n\nexport interface NotebookKernelChangeEvent {\n    label?: true;\n    description?: true;\n    detail?: true;\n    supportedLanguages?: true;\n    hasExecutionOrder?: true;\n    hasInterruptHandler?: true;\n}\n\nexport interface NotebookKernel {\n    readonly id: string;\n    readonly viewType: string;\n    readonly onDidChange: Event<Readonly<NotebookKernelChangeEvent>>;\n    // ID of the extension providing this kernel\n    readonly extensionId: string;\n\n    readonly localResourceRoot: URI;\n    readonly preloadUris: URI[];\n    readonly preloadProvides: string[];\n\n    readonly handle: number;\n    label: string;\n    description?: string;\n    detail?: string;\n    supportedLanguages: string[];\n    implementsInterrupt?: boolean;\n    implementsExecutionOrder?: boolean;\n\n    executeNotebookCellsRequest(uri: URI, cellHandles: number[]): Promise<void>;\n    cancelNotebookCellExecution(uri: URI, cellHandles: number[]): Promise<void>;\n}\n\nexport const enum ProxyKernelState {\n    Disconnected = 1,\n    Connected = 2,\n    Initializing = 3\n}\n\nexport interface INotebookProxyKernelChangeEvent extends NotebookKernelChangeEvent {\n    connectionState?: true;\n}\n\nexport interface NotebookTextModelLike { uri: URI; viewType: string }\n\nclass KernelInfo {\n\n    protected static instanceCounter = 0;\n\n    score: number;\n    readonly kernel: NotebookKernel;\n    readonly handle: number;\n\n    constructor(kernel: NotebookKernel) {\n        this.kernel = kernel;\n        this.score = -1;\n        this.handle = KernelInfo.instanceCounter++;\n    }\n}\n\nexport interface NotebookSourceActionChangeEvent {\n    notebook?: URI;\n    viewType: string;\n}\n\nexport interface KernelSourceActionProvider {\n    readonly viewType: string;\n    onDidChangeSourceActions?: Event<void>;\n    provideKernelSourceActions(): Promise<NotebookKernelSourceAction[]>;\n}\n\nexport class SourceCommand implements Disposable {\n    execution: Promise<void> | undefined;\n    protected readonly onDidChangeStateEmitter = new Emitter<void>();\n    readonly onDidChangeState = this.onDidChangeStateEmitter.event;\n\n    constructor(\n        readonly command: Command,\n        readonly model: NotebookTextModelLike,\n    ) { }\n\n    async run(commandService: CommandService): Promise<void> {\n        if (this.execution) {\n            return this.execution;\n        }\n\n        this.execution = this.runCommand(commandService);\n        this.onDidChangeStateEmitter.fire();\n        await this.execution;\n        this.execution = undefined;\n        this.onDidChangeStateEmitter.fire();\n    }\n\n    protected async runCommand(commandService: CommandService): Promise<void> {\n        try {\n            await commandService.executeCommand(this.command.id, {\n                uri: this.model.uri,\n            });\n\n        } catch (error) {\n            console.warn(`Kernel source command failed: ${error}`);\n        }\n    }\n\n    dispose(): void {\n        this.onDidChangeStateEmitter.dispose();\n    }\n\n}\n\nconst NOTEBOOK_KERNEL_BINDING_STORAGE_KEY = 'notebook.kernel.bindings';\n@injectable()\nexport class NotebookKernelService {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(StorageService)\n    protected storageService: StorageService;\n\n    protected readonly kernels = new Map<string, KernelInfo>();\n\n    protected notebookBindings: Record<string, string> = {};\n\n    protected readonly kernelDetectionTasks = new Map<string, string[]>();\n    protected readonly onDidChangeKernelDetectionTasksEmitter = new Emitter<string>();\n    readonly onDidChangeKernelDetectionTasks = this.onDidChangeKernelDetectionTasksEmitter.event;\n\n    protected readonly onDidChangeSourceActionsEmitter = new Emitter<NotebookSourceActionChangeEvent>();\n    protected readonly kernelSourceActionProviders = new Map<string, KernelSourceActionProvider[]>();\n    readonly onDidChangeSourceActions: Event<NotebookSourceActionChangeEvent> = this.onDidChangeSourceActionsEmitter.event;\n\n    protected readonly onDidAddKernelEmitter = new Emitter<NotebookKernel>();\n    readonly onDidAddKernel: Event<NotebookKernel> = this.onDidAddKernelEmitter.event;\n\n    protected readonly onDidRemoveKernelEmitter = new Emitter<NotebookKernel>();\n    readonly onDidRemoveKernel: Event<NotebookKernel> = this.onDidRemoveKernelEmitter.event;\n\n    protected readonly onDidChangeSelectedNotebookKernelBindingEmitter = new Emitter<SelectedNotebookKernelChangeEvent>();\n    readonly onDidChangeSelectedKernel: Event<SelectedNotebookKernelChangeEvent> = this.onDidChangeSelectedNotebookKernelBindingEmitter.event;\n\n    protected readonly onDidChangeNotebookAffinityEmitter = new Emitter<void>();\n    readonly onDidChangeNotebookAffinity: Event<void> = this.onDidChangeNotebookAffinityEmitter.event;\n\n    @postConstruct()\n    init(): void {\n        this.notebookService.onDidAddNotebookDocument(model => this.tryAutoBindNotebook(model));\n        this.storageService.getData(NOTEBOOK_KERNEL_BINDING_STORAGE_KEY).then((value: Record<string, string> | undefined) => {\n            if (value) {\n                this.notebookBindings = value;\n            }\n        });\n    }\n\n    registerKernel(kernel: NotebookKernel): Disposable {\n        if (this.kernels.has(kernel.id)) {\n            throw new Error(`Notebook Controller with id '${kernel.id}' already exists`);\n        }\n\n        this.kernels.set(kernel.id, new KernelInfo(kernel));\n        this.onDidAddKernelEmitter.fire(kernel);\n\n        // auto associate the new kernel to existing notebooks it was\n        // associated to in the past.\n        for (const notebook of this.notebookService.getNotebookModels()) {\n            this.tryAutoBindNotebook(notebook, kernel);\n        }\n\n        return Disposable.create(() => {\n            if (this.kernels.delete(kernel.id)) {\n                this.onDidRemoveKernelEmitter.fire(kernel);\n            }\n        });\n    }\n\n    /**\n     * Helps to find the best matching kernel for a notebook.\n     * @param notebook notebook to get the matching kernel for\n     * @returns and object containing:\n     *  all kernels sorted to match the notebook best first (affinity ascending, score descending, label))\n     *  the selected kernel (if any)\n     *  specific suggested kernels (if any)\n     *  hidden kernels (if any)\n     */\n    getMatchingKernel(notebook: NotebookTextModelLike): NotebookKernelMatchResult {\n        const kernels: { kernel: NotebookKernel; instanceAffinity: number; score: number }[] = [];\n        for (const info of this.kernels.values()) {\n            const score = NotebookKernelService.score(info.kernel, notebook);\n            if (score) {\n                kernels.push({\n                    score,\n                    kernel: info.kernel,\n                    instanceAffinity: 1 /* vscode.NotebookControllerPriority.Default */,\n                });\n            }\n        }\n\n        kernels\n            .sort((a, b) => b.instanceAffinity - a.instanceAffinity || a.score - b.score || a.kernel.label.localeCompare(b.kernel.label));\n        const all = kernels.map(obj => obj.kernel);\n\n        // bound kernel\n        const selected = this.getSelectedNotebookKernel(notebook);\n        const suggestions = kernels.filter(item => item.instanceAffinity > 1).map(item => item.kernel); // TODO implement notebookAffinity\n        const hidden = kernels.filter(item => item.instanceAffinity < 0).map(item => item.kernel);\n        return { all, selected, suggestions, hidden };\n\n    }\n\n    getSelectedNotebookKernel(notebook: NotebookTextModelLike): NotebookKernel | undefined {\n        const selectedId = this.notebookBindings[`${notebook.viewType}/${notebook.uri}`];\n        return selectedId ? this.kernels.get(selectedId)?.kernel : undefined;\n    }\n\n    selectKernelForNotebook(kernel: NotebookKernel | undefined, notebook: NotebookTextModelLike): void {\n        const key = `${notebook.viewType}/${notebook.uri}`;\n        const oldKernel = this.notebookBindings[key];\n        if (oldKernel !== kernel?.id) {\n            if (kernel) {\n                this.notebookBindings[key] = kernel.id;\n            } else {\n                delete this.notebookBindings[key];\n            }\n            this.storageService.setData(NOTEBOOK_KERNEL_BINDING_STORAGE_KEY, this.notebookBindings);\n            this.onDidChangeSelectedNotebookKernelBindingEmitter.fire({ notebook: notebook.uri, oldKernel, newKernel: kernel?.id });\n        }\n    }\n\n    getSelectedOrSuggestedKernel(notebook: NotebookModel): NotebookKernel | undefined {\n        const info = this.getMatchingKernel(notebook);\n        if (info.selected) {\n            return info.selected;\n        }\n\n        return info.all.length === 1 ? info.all[0] : undefined;\n    }\n\n    getKernel(id: string): NotebookKernel | undefined {\n        return this.kernels.get(id)?.kernel;\n    }\n\n    protected static score(kernel: NotebookKernel, notebook: NotebookTextModelLike): number {\n        if (kernel.viewType === notebook.viewType) {\n            return 10;\n        } else if (kernel.viewType === '*') {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    protected tryAutoBindNotebook(notebook: NotebookModel, onlyThisKernel?: NotebookKernel): void {\n\n        const id = this.notebookBindings[`${notebook.viewType}/${notebook.uri}`];\n        if (!id) {\n            // no kernel associated\n            return;\n        }\n        const existingKernel = this.kernels.get(id);\n        if (!existingKernel || !NotebookKernelService.score(existingKernel.kernel, notebook)) {\n            // associated kernel not known, not matching\n            return;\n        }\n        if (!onlyThisKernel || existingKernel.kernel === onlyThisKernel) {\n            this.onDidChangeSelectedNotebookKernelBindingEmitter.fire({ notebook: notebook.uri, oldKernel: undefined, newKernel: existingKernel.kernel.id });\n        }\n    }\n\n    registerNotebookKernelDetectionTask(notebookType: string): Disposable {\n        const all = this.kernelDetectionTasks.get(notebookType) ?? [];\n        all.push(notebookType);\n        this.kernelDetectionTasks.set(notebookType, all);\n        this.onDidChangeKernelDetectionTasksEmitter.fire(notebookType);\n        return Disposable.create(() => {\n            const allTasks = this.kernelDetectionTasks.get(notebookType) ?? [];\n            const taskIndex = allTasks.indexOf(notebookType);\n            if (taskIndex >= 0) {\n                allTasks.splice(taskIndex, 1);\n                this.kernelDetectionTasks.set(notebookType, allTasks);\n                this.onDidChangeKernelDetectionTasksEmitter.fire(notebookType);\n            }\n        });\n    }\n\n    getKernelDetectionTasks(notebook: NotebookTextModelLike): string[] {\n        return this.kernelDetectionTasks.get(notebook.viewType) ?? [];\n    }\n\n    registerKernelSourceActionProvider(viewType: string, provider: KernelSourceActionProvider): Disposable {\n        const providers = this.kernelSourceActionProviders.get(viewType) ?? [];\n        providers.push(provider);\n        this.kernelSourceActionProviders.set(viewType, providers);\n        this.onDidChangeSourceActionsEmitter.fire({ viewType: viewType });\n\n        const eventEmitterDisposable = provider.onDidChangeSourceActions?.(() => {\n            this.onDidChangeSourceActionsEmitter.fire({ viewType: viewType });\n        });\n\n        return Disposable.create(() => {\n            const sourceProviders = this.kernelSourceActionProviders.get(viewType) ?? [];\n            const providerIndex = sourceProviders.indexOf(provider);\n            if (providerIndex >= 0) {\n                sourceProviders.splice(providerIndex, 1);\n                this.kernelSourceActionProviders.set(viewType, sourceProviders);\n            }\n\n            eventEmitterDisposable?.dispose();\n        });\n    }\n\n    async getKernelSourceActionsFromProviders(notebook: NotebookTextModelLike): Promise<NotebookKernelSourceAction[]> {\n        const viewType = notebook.viewType;\n        const providers = this.kernelSourceActionProviders.get(viewType) ?? [];\n        const promises = providers.map(provider => provider.provideKernelSourceActions());\n        const allActions = await Promise.all(promises);\n        return allActions.flat();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Emitter, Resource, ResourceProvider, UNTITLED_SCHEME, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { UriComponents } from '@theia/core/lib/common/uri';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookData } from '../../common';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from './notebook-service';\nimport { NotebookTypeRegistry } from '../notebook-type-registry';\nimport { NotebookFileSelector } from '../../common/notebook-protocol';\nimport { match } from '@theia/core/lib/common/glob';\n\nexport interface UntitledResource {\n    untitledResource: URI | undefined\n}\n\n@injectable()\nexport class NotebookModelResolverService {\n\n    @inject(FileService)\n    protected fileService: FileService;\n\n    @inject(ResourceProvider)\n    protected resourceProvider: ResourceProvider;\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(NotebookTypeRegistry)\n    protected notebookTypeRegistry: NotebookTypeRegistry;\n\n    protected onDidChangeDirtyEmitter = new Emitter<NotebookModel>();\n    readonly onDidChangeDirty = this.onDidChangeDirtyEmitter.event;\n    protected onDidSaveNotebookEmitter = new Emitter<UriComponents>();\n    readonly onDidSaveNotebook = this.onDidSaveNotebookEmitter.event;\n\n    async resolve(resource: URI, viewType?: string): Promise<NotebookModel> {\n        const existingModel = this.notebookService.getNotebookEditorModel(resource);\n        if (!viewType) {\n            if (existingModel) {\n                return existingModel;\n            } else {\n                viewType = this.findViewTypeForResource(resource);\n            }\n        } else if (existingModel?.viewType === viewType) {\n            return existingModel;\n        }\n\n        if (!viewType) {\n            throw new Error(`Missing viewType for '${resource}'`);\n        }\n\n        try {\n\n            const actualResource = await this.resourceProvider(resource);\n            const notebookData = await this.resolveExistingNotebookData(actualResource, viewType!);\n            const notebookModel = await this.notebookService.createNotebookModel(notebookData, viewType, actualResource);\n\n            notebookModel.onDirtyChanged(() => this.onDidChangeDirtyEmitter.fire(notebookModel));\n            notebookModel.onDidSaveNotebook(() => this.onDidSaveNotebookEmitter.fire(notebookModel.uri.toComponents()));\n\n            return notebookModel;\n        } catch (e) {\n            const message = `Error resolving notebook model for: \\n ${resource.path.fsPath()} \\n with view type ${viewType}. \\n ${e}`;\n            console.error(message);\n            throw new Error(message);\n        }\n    }\n\n    async resolveUntitledResource(arg: UntitledResource, viewType: string): Promise<NotebookModel> {\n        let resource: URI;\n        // let hasAssociatedFilePath = false;\n        arg = arg as UntitledResource;\n        if (!arg.untitledResource) {\n            const notebookTypeInfo = this.notebookTypeRegistry.notebookTypes.find(info => info.type === viewType);\n            if (!notebookTypeInfo) {\n                throw new Error('UNKNOWN view type: ' + viewType);\n            }\n\n            const suffix = this.getPossibleFileEnding(notebookTypeInfo.selector ?? []) ?? '';\n            for (let counter = 1; ; counter++) {\n                const candidate = new URI()\n                    .withScheme(UNTITLED_SCHEME)\n                    .withPath(`Untitled-notebook-${counter}${suffix}`)\n                    .withQuery(viewType);\n                if (!this.notebookService.getNotebookEditorModel(candidate)) {\n                    resource = candidate;\n                    break;\n                }\n            }\n        } else if (arg.untitledResource.scheme === UNTITLED_SCHEME) {\n            resource = arg.untitledResource;\n        } else {\n            throw new Error('Invalid untitled resource: ' + arg.untitledResource.toString() + ' untitled resources with associated file path are not supported yet');\n            // TODO implement associated file path support\n            // resource = arg.untitledResource.withScheme('untitled');\n            // hasAssociatedFilePath = true;\n        }\n\n        return this.resolve(resource, viewType);\n    }\n\n    async resolveExistingNotebookData(resource: Resource, viewType: string): Promise<NotebookData> {\n        if (resource.uri.scheme === 'untitled') {\n            return {\n                cells: [],\n                metadata: {}\n            };\n        } else {\n            const [dataProvider, contents] = await Promise.all([\n                this.notebookService.getNotebookDataProvider(viewType),\n                this.fileService.readFile(resource.uri)\n            ]);\n            const notebook = await dataProvider.serializer.toNotebook(contents.value);\n\n            return notebook;\n        }\n    }\n\n    protected getPossibleFileEnding(selectors: readonly NotebookFileSelector[]): string | undefined {\n        for (const selector of selectors) {\n            const ending = this.possibleFileEnding(selector);\n            if (ending) {\n                return ending;\n            }\n        }\n        return undefined;\n    }\n\n    protected possibleFileEnding(selector: NotebookFileSelector): string | undefined {\n\n        const pattern = /^.*(\\.[a-zA-Z0-9_-]+)$/;\n\n        const candidate = typeof selector === 'string' ? selector : selector.filenamePattern;\n\n        if (candidate) {\n            const matches = pattern.exec(candidate);\n            if (matches) {\n                return matches[1];\n            }\n        }\n\n        return undefined;\n    }\n\n    protected findViewTypeForResource(resource: URI): string | undefined {\n        return this.notebookTypeRegistry.notebookTypes.find(info =>\n            info.selector?.some(selector => selector.filenamePattern && match(selector.filenamePattern, resource.path.name + resource.path.ext))\n        )?.type;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI, Reference, Event, Emitter } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { MonacoTextModelService, MonacoEditorModelFilter } from '@theia/monaco/lib/browser/monaco-text-model-service';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { CellUri } from '../../common/notebook-common';\n\n@injectable()\nexport class NotebookMonacoEditorModelFilter implements MonacoEditorModelFilter {\n\n    protected readonly onDidCreateCellModelEmitter = new Emitter<MonacoEditorModel>();\n\n    get onDidCreateCellModel(): Event<MonacoEditorModel> {\n        return this.onDidCreateCellModelEmitter.event;\n    }\n\n    filter(model: MonacoEditorModel): boolean {\n        const applies = model.uri.startsWith(CellUri.cellUriScheme);\n        if (applies) {\n            // If the model is for a notebook cell, we emit the event to notify the listeners.\n            // We create our own event here, as we don't want to propagate the creation of the cell to the plugin host.\n            // Instead, we want to do that ourselves once the notebook model is completely initialized.\n            this.onDidCreateCellModelEmitter.fire(model);\n        }\n        return applies;\n    }\n}\n\n/**\n * special service for creating monaco textmodels for notebook cells.\n * Its for optimization purposes since there is alot of overhead otherwise with calling the backend to create a document for each cell and other smaller things.\n */\n@injectable()\nexport class NotebookMonacoTextModelService {\n\n    @inject(MonacoTextModelService)\n    protected readonly monacoTextModelService: MonacoTextModelService;\n\n    @inject(NotebookMonacoEditorModelFilter)\n    protected readonly notebookMonacoEditorModelFilter: NotebookMonacoEditorModelFilter;\n\n    getOrCreateNotebookCellModelReference(uri: URI): Promise<Reference<MonacoEditorModel>> {\n        return this.monacoTextModelService.createModelReference(uri);\n    }\n\n    async createTextModelsForNotebook(notebook: NotebookModel): Promise<void> {\n        await Promise.all(notebook.cells.map(cell => cell.resolveTextModel()));\n    }\n\n    get onDidCreateNotebookCellModel(): Event<MonacoEditorModel> {\n        return this.notebookMonacoEditorModelFilter.onDidCreateCellModel;\n    }\n}\n","\n// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { PreferenceService } from '@theia/core/lib/browser';\nimport { Emitter } from '@theia/core';\nimport { NotebookPreferences, notebookPreferenceSchema } from '../contributions/notebook-preferences';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\nimport { BareFontInfo } from '@theia/monaco-editor-core/esm/vs/editor/common/config/fontInfo';\nimport { PixelRatio } from '@theia/monaco-editor-core/esm/vs/base/browser/pixelRatio';\n\nconst notebookOutputOptionsRelevantPreferences = [\n    'editor.fontSize',\n    'editor.fontFamily',\n    NotebookPreferences.NOTEBOOK_LINE_NUMBERS,\n    NotebookPreferences.OUTPUT_LINE_HEIGHT,\n    NotebookPreferences.OUTPUT_FONT_SIZE,\n    NotebookPreferences.OUTPUT_FONT_FAMILY,\n    NotebookPreferences.OUTPUT_SCROLLING,\n    NotebookPreferences.OUTPUT_WORD_WRAP,\n    NotebookPreferences.OUTPUT_LINE_LIMIT\n];\n\nexport interface NotebookOutputOptions {\n    // readonly outputNodePadding: number;\n    readonly outputNodeLeftPadding: number;\n    // readonly previewNodePadding: number;\n    // readonly markdownLeftMargin: number;\n    // readonly leftMargin: number;\n    // readonly rightMargin: number;\n    // readonly runGutter: number;\n    // readonly dragAndDropEnabled: boolean;\n    readonly fontSize: number;\n    readonly outputFontSize?: number;\n    readonly fontFamily: string;\n    readonly outputFontFamily?: string;\n    // readonly markupFontSize: number;\n    // readonly markdownLineHeight: number;\n    readonly outputLineHeight: number;\n    readonly outputScrolling: boolean;\n    readonly outputWordWrap: boolean;\n    readonly outputLineLimit: number;\n    // readonly outputLinkifyFilePaths: boolean;\n    // readonly minimalError: boolean;\n\n}\n\n@injectable()\nexport class NotebookOptionsService {\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    @inject(EditorPreferences)\n    protected readonly editorPreferences: EditorPreferences;\n\n    protected outputOptionsChangedEmitter = new Emitter<NotebookOutputOptions>();\n    onDidChangeOutputOptions = this.outputOptionsChangedEmitter.event;\n\n    protected fontInfo?: BareFontInfo;\n    get editorFontInfo(): BareFontInfo {\n        return this.getOrCreateMonacoFontInfo();\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.preferenceService.onPreferencesChanged(async preferenceChanges => {\n            if (notebookOutputOptionsRelevantPreferences.some(p => p in preferenceChanges)) {\n                this.outputOptionsChangedEmitter.fire(this.computeOutputOptions());\n            }\n        });\n    }\n\n    computeOutputOptions(): NotebookOutputOptions {\n        const outputLineHeight = this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_LINE_HEIGHT);\n\n        const fontSize = this.preferenceService.get<number>('editor.fontSize')!;\n        const outputFontSize = this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_FONT_SIZE);\n\n        return {\n            fontSize,\n            outputFontSize: outputFontSize,\n            fontFamily: this.preferenceService.get<string>('editor.fontFamily')!,\n            outputNodeLeftPadding: 8,\n            outputFontFamily: this.getNotebookPreferenceWithDefault<string>(NotebookPreferences.OUTPUT_FONT_FAMILY),\n            outputLineHeight: this.computeOutputLineHeight(outputLineHeight, outputFontSize ?? fontSize),\n            outputScrolling: this.getNotebookPreferenceWithDefault<boolean>(NotebookPreferences.OUTPUT_SCROLLING)!,\n            outputWordWrap: this.getNotebookPreferenceWithDefault<boolean>(NotebookPreferences.OUTPUT_WORD_WRAP)!,\n            outputLineLimit: this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_LINE_LIMIT)!\n        };\n    }\n\n    protected getNotebookPreferenceWithDefault<T>(key: string): T {\n        return this.preferenceService.get<T>(key, notebookPreferenceSchema.properties?.[key]?.default as T);\n    }\n\n    protected computeOutputLineHeight(lineHeight: number, outputFontSize: number): number {\n        const minimumLineHeight = 9;\n\n        if (lineHeight === 0) {\n            // use editor line height\n            lineHeight = this.editorFontInfo.lineHeight;\n        } else if (lineHeight < minimumLineHeight) {\n            // Values too small to be line heights in pixels are in ems.\n            let fontSize = outputFontSize;\n            if (fontSize === 0) {\n                fontSize = this.preferenceService.get<number>('editor.fontSize')!;\n            }\n\n            lineHeight = lineHeight * fontSize;\n        }\n\n        // Enforce integer, minimum constraints\n        lineHeight = Math.round(lineHeight);\n        if (lineHeight < minimumLineHeight) {\n            lineHeight = minimumLineHeight;\n        }\n\n        return lineHeight;\n    }\n\n    protected getOrCreateMonacoFontInfo(): BareFontInfo {\n        if (!this.fontInfo) {\n            this.fontInfo = this.createFontInfo();\n            this.editorPreferences.onPreferenceChanged(e => this.fontInfo = this.createFontInfo());\n        }\n        return this.fontInfo;\n    }\n\n    protected createFontInfo(): BareFontInfo {\n        return BareFontInfo.createFromRawSettings({\n            fontFamily: this.editorPreferences['editor.fontFamily'],\n            fontWeight: String(this.editorPreferences['editor.fontWeight']),\n            fontSize: this.editorPreferences['editor.fontSize'],\n            fontLigatures: this.editorPreferences['editor.fontLigatures'],\n            lineHeight: this.editorPreferences['editor.lineHeight'],\n            letterSpacing: this.editorPreferences['editor.letterSpacing'],\n        }, PixelRatio.getInstance(window).value);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { Disposable } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { NotebookEditorWidgetService } from './notebook-editor-widget-service';\n\ninterface RendererMessage {\n    editorId: string;\n    rendererId: string;\n    message: unknown\n};\n\nexport interface RendererMessaging extends Disposable {\n    /**\n     * Method called when a message is received. Should return a boolean\n     * indicating whether a renderer received it.\n     */\n    receiveMessage?: (rendererId: string, message: unknown) => Promise<boolean>;\n\n    /**\n     * Sends a message to an extension from a renderer.\n     */\n    postMessage(rendererId: string, message: unknown): void;\n}\n\n@injectable()\nexport class NotebookRendererMessagingService implements Disposable {\n\n    protected readonly postMessageEmitter = new Emitter<RendererMessage>();\n    readonly onPostMessage = this.postMessageEmitter.event;\n\n    protected readonly willActivateRendererEmitter = new Emitter<string>();\n    readonly onWillActivateRenderer = this.willActivateRendererEmitter.event;\n\n    @inject(NotebookEditorWidgetService)\n    protected readonly editorWidgetService: NotebookEditorWidgetService;\n\n    protected readonly activations = new Map<string /* rendererId */, undefined | RendererMessage[]>();\n    protected readonly scopedMessaging = new Map<string /* editorId */, RendererMessaging>();\n\n    receiveMessage(editorId: string | undefined, rendererId: string, message: unknown): Promise<boolean> {\n        if (editorId === undefined) {\n            const sends = [...this.scopedMessaging.values()].map(e => e.receiveMessage?.(rendererId, message));\n            return Promise.all(sends).then(values => values.some(value => !!value));\n        }\n\n        return this.scopedMessaging.get(editorId)?.receiveMessage?.(rendererId, message) ?? Promise.resolve(false);\n    }\n\n    prepare(rendererId: string): void {\n        if (this.activations.has(rendererId)) {\n            return;\n        }\n\n        const queue: RendererMessage[] = [];\n        this.activations.set(rendererId, queue);\n\n        Promise.all(this.willActivateRendererEmitter.fire(rendererId)).then(() => {\n            for (const message of queue) {\n                this.postMessageEmitter.fire(message);\n            }\n            this.activations.set(rendererId, undefined);\n        });\n    }\n\n    public getScoped(editorId: string): RendererMessaging {\n        const existing = this.scopedMessaging.get(editorId);\n        if (existing) {\n            return existing;\n        }\n\n        const messaging: RendererMessaging = {\n            postMessage: (rendererId, message) => this.postMessage(editorId, rendererId, message),\n            receiveMessage: async (rendererId, message) => {\n                this.editorWidgetService.getNotebookEditor(editorId)?.postRendererMessage(rendererId, message);\n                return true;\n            },\n            dispose: () => this.scopedMessaging.delete(editorId),\n        };\n\n        this.scopedMessaging.set(editorId, messaging);\n        return messaging;\n    }\n\n    protected postMessage(editorId: string, rendererId: string, message: unknown): void {\n        if (!this.activations.has(rendererId)) {\n            this.prepare(rendererId);\n        }\n\n        const activation = this.activations.get(rendererId);\n        const toSend = { rendererId, editorId, message };\n        if (activation === undefined) {\n            this.postMessageEmitter.fire(toSend);\n        } else {\n            activation.push(toSend);\n        }\n    }\n\n    dispose(): void {\n        this.postMessageEmitter.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, DisposableCollection, Emitter, Resource, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { CellKind, NotebookData, TransientOptions } from '../../common';\nimport { NotebookModel, NotebookModelFactory, NotebookModelProps } from '../view-model/notebook-model';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookCellModel, NotebookCellModelFactory, NotebookCellModelProps } from '../view-model/notebook-cell-model';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { NotebookMonacoTextModelService } from './notebook-monaco-text-model-service';\nimport { CellEditOperation } from '../notebook-types';\n\nexport const NotebookProvider = Symbol('notebook provider');\n\nexport interface NotebookProviderInfo {\n    readonly notebookType: string,\n    readonly serializer: NotebookSerializer,\n}\n\nexport interface NotebookSerializer {\n    options: TransientOptions;\n    toNotebook(data: BinaryBuffer): Promise<NotebookData>;\n    fromNotebook(data: NotebookData): Promise<BinaryBuffer>;\n}\n\nexport interface NotebookWorkspaceEdit {\n    edits: {\n        resource: URI;\n        edit: CellEditOperation\n    }[]\n}\n\n@injectable()\nexport class NotebookService implements Disposable {\n\n    @inject(FileService)\n    protected fileService: FileService;\n\n    @inject(NotebookModelFactory)\n    protected notebookModelFactory: (props: NotebookModelProps) => NotebookModel;\n\n    @inject(NotebookCellModelFactory)\n    protected notebookCellModelFactory: (props: NotebookCellModelProps) => NotebookCellModel;\n\n    @inject(NotebookMonacoTextModelService)\n    protected textModelService: NotebookMonacoTextModelService;\n\n    protected willUseNotebookSerializerEmitter = new Emitter<string>();\n    readonly onWillUseNotebookSerializer = this.willUseNotebookSerializerEmitter.event;\n\n    protected readonly disposables = new DisposableCollection();\n\n    protected readonly notebookProviders = new Map<string, NotebookProviderInfo>();\n    protected readonly notebookModels = new Map<string, NotebookModel>();\n\n    protected readonly didRegisterNotebookSerializerEmitter = new Emitter<string>();\n    readonly onDidRegisterNotebookSerializer = this.didRegisterNotebookSerializerEmitter.event;\n\n    protected readonly didRemoveViewTypeEmitter = new Emitter<string>();\n    readonly onDidRemoveViewType = this.didRemoveViewTypeEmitter.event;\n\n    protected readonly willOpenNotebookTypeEmitter = new Emitter<string>();\n    readonly onWillOpenNotebook = this.willOpenNotebookTypeEmitter.event;\n\n    protected readonly didAddNotebookDocumentEmitter = new Emitter<NotebookModel>();\n    readonly onDidAddNotebookDocument = this.didAddNotebookDocumentEmitter.event;\n    protected readonly didRemoveNotebookDocumentEmitter = new Emitter<NotebookModel>();\n    readonly onDidRemoveNotebookDocument = this.didRemoveNotebookDocumentEmitter.event;\n\n    dispose(): void {\n        this.disposables.dispose();\n    }\n\n    protected readonly ready = new Deferred();\n\n    /**\n     * Marks the notebook service as ready. From this point on, the service will start dispatching the `onNotebookSerializer` event.\n     */\n    markReady(): void {\n        this.ready.resolve();\n    }\n\n    registerNotebookSerializer(viewType: string, serializer: NotebookSerializer): Disposable {\n        if (this.notebookProviders.has(viewType)) {\n            throw new Error(`notebook provider for viewtype '${viewType}' already exists`);\n        }\n\n        this.notebookProviders.set(viewType, { notebookType: viewType, serializer });\n        this.didRegisterNotebookSerializerEmitter.fire(viewType);\n\n        return Disposable.create(() => {\n            this.notebookProviders.delete(viewType);\n            this.didRemoveViewTypeEmitter.fire(viewType);\n        });\n    }\n\n    async createNotebookModel(data: NotebookData, viewType: string, resource: Resource): Promise<NotebookModel> {\n        const dataProvider = await this.getNotebookDataProvider(viewType);\n        const serializer = dataProvider.serializer;\n        const model = this.notebookModelFactory({ data, resource, viewType, serializer });\n        this.notebookModels.set(resource.uri.toString(), model);\n        // Resolve cell text models right after creating the notebook model\n        // This ensures that all text models are available in the plugin host\n        await this.textModelService.createTextModelsForNotebook(model);\n        this.didAddNotebookDocumentEmitter.fire(model);\n        model.onDidDispose(() => {\n            this.notebookModels.delete(resource.uri.toString());\n            this.didRemoveNotebookDocumentEmitter.fire(model);\n        });\n        return model;\n    }\n\n    async getNotebookDataProvider(viewType: string): Promise<NotebookProviderInfo> {\n        try {\n            return await this.waitForNotebookProvider(viewType);\n        } catch {\n            throw new Error(`No provider registered for view type: '${viewType}'`);\n        }\n    }\n\n    /**\n     * When the application starts up, notebook providers from plugins are not registered yet.\n     * It takes a few seconds for the plugin host to start so that notebook data providers can be registered.\n     * This methods waits until the notebook provider is registered.\n     */\n    protected waitForNotebookProvider(type: string): Promise<NotebookProviderInfo> {\n        const existing = this.notebookProviders.get(type);\n        if (existing) {\n            return Promise.resolve(existing);\n        }\n        const deferred = new Deferred<NotebookProviderInfo>();\n        // 20 seconds of timeout\n        const timeoutDuration = 20_000;\n\n        // Must declare these variables where they can be captured by the closure\n        let disposable: Disposable;\n        // eslint-disable-next-line\n        let timeout: ReturnType<typeof setTimeout>;\n\n        // eslint-disable-next-line\n        disposable = this.onDidRegisterNotebookSerializer(viewType => {\n            if (viewType === type) {\n                clearTimeout(timeout);\n                disposable.dispose();\n                const newProvider = this.notebookProviders.get(type);\n                if (!newProvider) {\n                    deferred.reject(new Error(`Notebook provider for type ${type} is invalid`));\n                } else {\n                    deferred.resolve(newProvider);\n                }\n            }\n        });\n        timeout = setTimeout(() => {\n            clearTimeout(timeout);\n            disposable.dispose();\n            deferred.reject(new Error(`Timed out while waiting for notebook serializer for type ${type} to be registered`));\n        }, timeoutDuration);\n\n        this.ready.promise.then(() => {\n            this.willUseNotebookSerializerEmitter.fire(type);\n        });\n\n        return deferred.promise;\n    }\n\n    getNotebookEditorModel(uri: URI): NotebookModel | undefined {\n        return this.notebookModels.get(uri.toString());\n    }\n\n    getNotebookModels(): Iterable<NotebookModel> {\n        return this.notebookModels.values();\n    }\n\n    async willOpenNotebook(type: string): Promise<void> {\n        return this.willOpenNotebookTypeEmitter.sequence(async listener => listener(type));\n    }\n\n    listNotebookDocuments(): NotebookModel[] {\n        return [...this.notebookModels.values()];\n    }\n\n    applyWorkspaceEdit(workspaceEdit: NotebookWorkspaceEdit): boolean {\n        try {\n            workspaceEdit.edits.forEach(edit => {\n                const notebook = this.getNotebookEditorModel(edit.resource);\n                notebook?.applyEdits([edit.edit], true);\n            });\n            return true;\n        } catch (e) {\n            console.error(e);\n            return false;\n        }\n    }\n\n    getCodeCellLanguage(model: NotebookModel): string {\n        const firstCodeCell = model.cells.find(cellModel => cellModel.cellKind === CellKind.Code);\n        const cellLanguage = firstCodeCell?.language ?? 'plaintext';\n        return cellLanguage;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableCollection, Emitter, Event, URI } from '@theia/core';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { type MonacoEditor } from '@theia/monaco/lib/browser/monaco-editor';\nimport {\n    CellKind, NotebookCellCollapseState, NotebookCellInternalMetadata,\n    NotebookCellMetadata, CellOutput, CellData, CellOutputItem\n} from '../../common';\nimport { NotebookCellOutputsSplice } from '../notebook-types';\nimport { NotebookMonacoTextModelService } from '../service/notebook-monaco-text-model-service';\nimport { NotebookCellOutputModel } from './notebook-cell-output-model';\nimport { PreferenceService } from '@theia/core/lib/browser';\nimport { NotebookPreferences } from '../contributions/notebook-preferences';\nimport { LanguageService } from '@theia/core/lib/browser/language-service';\nimport { NotebookEditorFindMatch, NotebookEditorFindMatchOptions } from '../view/notebook-find-widget';\nimport { Range } from '@theia/core/shared/vscode-languageserver-protocol';\n\nexport const NotebookCellModelFactory = Symbol('NotebookModelFactory');\nexport type NotebookCellModelFactory = (props: NotebookCellModelProps) => NotebookCellModel;\n\nexport type CellEditorFocusRequest = number | 'lastLine' | undefined;\n\nexport function createNotebookCellModelContainer(parent: interfaces.Container, props: NotebookCellModelProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookCellModelProps).toConstantValue(props);\n    child.bind(NotebookCellModel).toSelf();\n\n    return child;\n}\n\nexport interface CellInternalMetadataChangedEvent {\n    readonly lastRunSuccessChanged?: boolean;\n}\n\nexport interface NotebookCell {\n    readonly uri: URI;\n    handle: number;\n    language: string;\n    cellKind: CellKind;\n    outputs: CellOutput[];\n    metadata: NotebookCellMetadata;\n    internalMetadata: NotebookCellInternalMetadata;\n    text: string;\n    /**\n     * The selection of the cell. Zero-based line/character coordinates.\n     */\n    selection: Range | undefined;\n    onDidChangeOutputs?: Event<NotebookCellOutputsSplice>;\n    onDidChangeOutputItems?: Event<CellOutput>;\n    onDidChangeLanguage: Event<string>;\n    onDidChangeMetadata: Event<void>;\n    onDidChangeInternalMetadata: Event<CellInternalMetadataChangedEvent>;\n\n}\n\nconst NotebookCellModelProps = Symbol('NotebookModelProps');\nexport interface NotebookCellModelProps {\n    readonly uri: URI,\n    readonly handle: number,\n    source: string,\n    language: string,\n    readonly cellKind: CellKind,\n    outputs: CellOutput[],\n    metadata?: NotebookCellMetadata | undefined,\n    internalMetadata?: NotebookCellInternalMetadata | undefined,\n    readonly collapseState?: NotebookCellCollapseState | undefined,\n\n}\n\n@injectable()\nexport class NotebookCellModel implements NotebookCell, Disposable {\n\n    protected readonly onDidChangeOutputsEmitter = new Emitter<NotebookCellOutputsSplice>();\n    readonly onDidChangeOutputs = this.onDidChangeOutputsEmitter.event;\n\n    protected readonly onDidChangeOutputItemsEmitter = new Emitter<CellOutput>();\n    readonly onDidChangeOutputItems = this.onDidChangeOutputItemsEmitter.event;\n\n    protected readonly onDidChangeContentEmitter = new Emitter<'content' | 'language' | 'mime'>();\n    readonly onDidChangeContent = this.onDidChangeContentEmitter.event;\n\n    protected readonly onDidChangeMetadataEmitter = new Emitter<void>();\n    readonly onDidChangeMetadata = this.onDidChangeMetadataEmitter.event;\n\n    protected readonly onDidChangeInternalMetadataEmitter = new Emitter<CellInternalMetadataChangedEvent>();\n    readonly onDidChangeInternalMetadata = this.onDidChangeInternalMetadataEmitter.event;\n\n    protected readonly onDidChangeLanguageEmitter = new Emitter<string>();\n    readonly onDidChangeLanguage = this.onDidChangeLanguageEmitter.event;\n\n    protected readonly onDidRequestCellEditChangeEmitter = new Emitter<boolean>();\n    readonly onDidRequestCellEditChange = this.onDidRequestCellEditChangeEmitter.event;\n\n    protected readonly onWillFocusCellEditorEmitter = new Emitter<CellEditorFocusRequest>();\n    readonly onWillFocusCellEditor = this.onWillFocusCellEditorEmitter.event;\n\n    protected readonly onWillBlurCellEditorEmitter = new Emitter<void>();\n    readonly onWillBlurCellEditor = this.onWillBlurCellEditorEmitter.event;\n\n    protected readonly onDidChangeEditorOptionsEmitter = new Emitter<MonacoEditor.IOptions>();\n    readonly onDidChangeEditorOptions = this.onDidChangeEditorOptionsEmitter.event;\n\n    protected readonly outputVisibilityChangeEmitter = new Emitter<boolean>();\n    readonly onDidChangeOutputVisibility = this.outputVisibilityChangeEmitter.event;\n\n    protected readonly onDidFindMatchesEmitter = new Emitter<NotebookCodeEditorFindMatch[]>();\n    readonly onDidFindMatches: Event<NotebookCodeEditorFindMatch[]> = this.onDidFindMatchesEmitter.event;\n\n    protected readonly onDidSelectFindMatchEmitter = new Emitter<NotebookCodeEditorFindMatch>();\n    readonly onDidSelectFindMatch: Event<NotebookCodeEditorFindMatch> = this.onDidSelectFindMatchEmitter.event;\n\n    protected onDidRequestCenterEditorEmitter = new Emitter<void>();\n    readonly onDidRequestCenterEditor = this.onDidRequestCenterEditorEmitter.event;\n\n    protected onDidCellHeightChangeEmitter = new Emitter<number>();\n    readonly onDidCellHeightChange = this.onDidCellHeightChangeEmitter.event;\n\n    @inject(NotebookCellModelProps)\n    protected readonly props: NotebookCellModelProps;\n\n    @inject(NotebookMonacoTextModelService)\n    protected readonly textModelService: NotebookMonacoTextModelService;\n\n    @inject(LanguageService)\n    protected readonly languageService: LanguageService;\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    get outputs(): NotebookCellOutputModel[] {\n        return this._outputs;\n    }\n\n    protected _outputs: NotebookCellOutputModel[];\n\n    get metadata(): NotebookCellMetadata {\n        return this._metadata;\n    }\n\n    set metadata(newMetadata: NotebookCellMetadata) {\n        this._metadata = newMetadata;\n        this.onDidChangeMetadataEmitter.fire();\n    }\n\n    protected _metadata: NotebookCellMetadata;\n\n    protected toDispose = new DisposableCollection();\n\n    protected _internalMetadata: NotebookCellInternalMetadata;\n\n    get internalMetadata(): NotebookCellInternalMetadata {\n        return this._internalMetadata;\n    }\n\n    set internalMetadata(newInternalMetadata: NotebookCellInternalMetadata) {\n        const lastRunSuccessChanged = this._internalMetadata.lastRunSuccess !== newInternalMetadata.lastRunSuccess;\n        newInternalMetadata = {\n            ...newInternalMetadata,\n            ...{ runStartTimeAdjustment: computeRunStartTimeAdjustment(this._internalMetadata, newInternalMetadata) }\n        };\n        this._internalMetadata = newInternalMetadata;\n        this.onDidChangeInternalMetadataEmitter.fire({ lastRunSuccessChanged });\n\n    }\n\n    protected textModel?: MonacoEditorModel;\n\n    get text(): string {\n        return this.textModel && !this.textModel.isDisposed() ? this.textModel.getText() : this.source;\n    }\n\n    get source(): string {\n        return this.props.source;\n    }\n\n    set source(source: string) {\n        this.props.source = source;\n        this.textModel?.textEditorModel.setValue(source);\n    }\n\n    get language(): string {\n        return this.props.language;\n    }\n\n    set language(newLanguage: string) {\n        if (this.language === newLanguage) {\n            return;\n        }\n\n        if (this.textModel) {\n            this.textModel.setLanguageId(newLanguage);\n        }\n\n        this.props.language = newLanguage;\n        this.onDidChangeLanguageEmitter.fire(newLanguage);\n        this.onDidChangeContentEmitter.fire('language');\n    }\n\n    get languageName(): string {\n        return this.languageService.getLanguage(this.language)?.name ?? this.language;\n    }\n\n    get uri(): URI {\n        return this.props.uri;\n    }\n    get handle(): number {\n        return this.props.handle;\n    }\n    get cellKind(): CellKind {\n        return this.props.cellKind;\n    }\n\n    protected _editing: boolean = false;\n    get editing(): boolean {\n        return this._editing;\n    }\n\n    protected _editorOptions: MonacoEditor.IOptions = {};\n    get editorOptions(): Readonly<MonacoEditor.IOptions> {\n        return this._editorOptions;\n    }\n\n    set editorOptions(options: MonacoEditor.IOptions) {\n        this._editorOptions = options;\n        this.onDidChangeEditorOptionsEmitter.fire(options);\n    }\n\n    protected _outputVisible: boolean = true;\n    get outputVisible(): boolean {\n        return this._outputVisible;\n    }\n\n    set outputVisible(visible: boolean) {\n        if (this._outputVisible !== visible) {\n            this._outputVisible = visible;\n            this.outputVisibilityChangeEmitter.fire(visible);\n        }\n    }\n\n    protected _selection: Range | undefined = undefined;\n\n    get selection(): Range | undefined {\n        return this._selection;\n    }\n\n    set selection(selection: Range | undefined) {\n        this._selection = selection;\n    }\n\n    protected _cellheight: number = 0;\n    get cellHeight(): number {\n        return this._cellheight;\n    }\n\n    set cellHeight(height: number) {\n        if (height !== this._cellheight) {\n            this.onDidCellHeightChangeEmitter.fire(height);\n            this._cellheight = height;\n        }\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this._outputs = this.props.outputs.map(op => new NotebookCellOutputModel(op));\n        this._metadata = this.props.metadata ?? {};\n        this._internalMetadata = this.props.internalMetadata ?? {};\n\n        this.editorOptions = {\n            lineNumbers: this.preferenceService.get(NotebookPreferences.NOTEBOOK_LINE_NUMBERS)\n        };\n        this.toDispose.push(this.preferenceService.onPreferenceChanged(e => {\n            if (e.preferenceName === NotebookPreferences.NOTEBOOK_LINE_NUMBERS) {\n                this.editorOptions = {\n                    ...this.editorOptions,\n                    lineNumbers: this.preferenceService.get(NotebookPreferences.NOTEBOOK_LINE_NUMBERS)\n                };\n            }\n        }));\n    }\n\n    dispose(): void {\n        this.onDidChangeOutputsEmitter.dispose();\n        this.onDidChangeOutputItemsEmitter.dispose();\n        this.onDidChangeContentEmitter.dispose();\n        this.onDidChangeMetadataEmitter.dispose();\n        this.onDidChangeInternalMetadataEmitter.dispose();\n        this.onDidChangeLanguageEmitter.dispose();\n        this.toDispose.dispose();\n    }\n\n    requestEdit(): void {\n        if (!this.textModel || !this.textModel.readOnly) {\n            this._editing = true;\n            this.onDidRequestCellEditChangeEmitter.fire(true);\n        }\n    }\n\n    requestStopEdit(): void {\n        this._editing = false;\n        this.onDidRequestCellEditChangeEmitter.fire(false);\n    }\n\n    requestFocusEditor(focusRequest?: CellEditorFocusRequest): void {\n        this.requestEdit();\n        this.onWillFocusCellEditorEmitter.fire(focusRequest);\n    }\n\n    requestBlurEditor(): void {\n        this.requestStopEdit();\n        this.onWillBlurCellEditorEmitter.fire();\n    }\n\n    requestCenterEditor(): void {\n        this.onDidRequestCenterEditorEmitter.fire();\n    }\n\n    spliceNotebookCellOutputs(splice: NotebookCellOutputsSplice): void {\n        if (splice.deleteCount > 0 && splice.newOutputs.length > 0) {\n            const commonLen = Math.min(splice.deleteCount, splice.newOutputs.length);\n            // update\n            for (let i = 0; i < commonLen; i++) {\n                const currentOutput = this.outputs[splice.start + i];\n                const newOutput = splice.newOutputs[i];\n\n                this.replaceOutputData(currentOutput.outputId, newOutput);\n            }\n\n            this.outputs.splice(splice.start + commonLen, splice.deleteCount - commonLen, ...splice.newOutputs.slice(commonLen).map(op => new NotebookCellOutputModel(op)));\n            this.onDidChangeOutputsEmitter.fire({ start: splice.start + commonLen, deleteCount: splice.deleteCount - commonLen, newOutputs: splice.newOutputs.slice(commonLen) });\n        } else {\n            this.outputs.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(op => new NotebookCellOutputModel(op)));\n            this.onDidChangeOutputsEmitter.fire(splice);\n        }\n    }\n\n    replaceOutputData(outputId: string, newOutputData: CellOutput): boolean {\n        const output = this.outputs.find(out => out.outputId === outputId);\n\n        if (!output) {\n            return false;\n        }\n\n        output.replaceData(newOutputData);\n        this.onDidChangeOutputItemsEmitter.fire(output);\n        return true;\n    }\n\n    changeOutputItems(outputId: string, append: boolean, items: CellOutputItem[]): boolean {\n        const output = this.outputs.find(out => out.outputId === outputId);\n\n        if (!output) {\n            return false;\n        }\n\n        if (append) {\n            output.appendData(items);\n        } else {\n            output.replaceData({ outputId: outputId, outputs: items, metadata: output.metadata });\n        }\n        this.onDidChangeOutputItemsEmitter.fire(output);\n        return true;\n    }\n\n    getData(): CellData {\n        return {\n            cellKind: this.cellKind,\n            language: this.language,\n            outputs: this.outputs.map(output => output.getData()),\n            source: this.text,\n            collapseState: this.props.collapseState,\n            internalMetadata: this.internalMetadata,\n            metadata: this.metadata\n        };\n    }\n\n    async resolveTextModel(): Promise<MonacoEditorModel> {\n        if (this.textModel) {\n            return this.textModel;\n        }\n\n        const ref = await this.textModelService.getOrCreateNotebookCellModelReference(this.uri);\n        this.textModel = ref.object;\n        this.toDispose.push(ref);\n        this.toDispose.push(this.textModel.onDidChangeContent(e => {\n            this.props.source = e.model.getText();\n        }));\n        return ref.object;\n    }\n\n    restartOutputRenderer(outputId: string): void {\n        const output = this.outputs.find(out => out.outputId === outputId);\n        if (output) {\n            this.onDidChangeOutputItemsEmitter.fire(output);\n        }\n    }\n\n    onMarkdownFind: ((options: NotebookEditorFindMatchOptions) => NotebookEditorFindMatch[]) | undefined;\n\n    showMatch(selected: NotebookCodeEditorFindMatch): void {\n        this.onDidSelectFindMatchEmitter.fire(selected);\n    }\n\n    findMatches(options: NotebookEditorFindMatchOptions): NotebookEditorFindMatch[] {\n        if (this.cellKind === CellKind.Markup && !this.editing) {\n            return this.onMarkdownFind?.(options) ?? [];\n        }\n        if (!this.textModel) {\n            return [];\n        }\n        const matches = options.search ? this.textModel.findMatches({\n            searchString: options.search,\n            isRegex: options.regex,\n            matchCase: options.matchCase,\n            matchWholeWord: options.wholeWord\n        }) : [];\n        const editorFindMatches = matches.map(match => new NotebookCodeEditorFindMatch(this, match.range, this.textModel!));\n        this.onDidFindMatchesEmitter.fire(editorFindMatches);\n        return editorFindMatches;\n    }\n\n    replaceAll(matches: NotebookCodeEditorFindMatch[], value: string): void {\n        const editOperations = matches.map(match => ({\n            range: {\n                startColumn: match.range.start.character,\n                startLineNumber: match.range.start.line,\n                endColumn: match.range.end.character,\n                endLineNumber: match.range.end.line\n            },\n            text: value\n        }));\n        this.textModel?.textEditorModel.pushEditOperations(\n            // eslint-disable-next-line no-null/no-null\n            null,\n            editOperations,\n            // eslint-disable-next-line no-null/no-null\n            () => null);\n    }\n}\n\nexport interface NotebookCellFindMatches {\n    matches: NotebookEditorFindMatch[];\n    selected: NotebookEditorFindMatch;\n}\n\nexport class NotebookCodeEditorFindMatch implements NotebookEditorFindMatch {\n\n    selected = false;\n\n    constructor(readonly cell: NotebookCellModel, readonly range: Range, readonly textModel: MonacoEditorModel) {\n    }\n\n    show(): void {\n        this.cell.showMatch(this);\n    }\n    replace(value: string): void {\n        this.textModel.textEditorModel.pushEditOperations(\n            // eslint-disable-next-line no-null/no-null\n            null,\n            [{\n                range: {\n                    startColumn: this.range.start.character,\n                    startLineNumber: this.range.start.line,\n                    endColumn: this.range.end.character,\n                    endLineNumber: this.range.end.line\n                },\n                text: value\n            }],\n            // eslint-disable-next-line no-null/no-null\n            () => null);\n    }\n\n}\n\nfunction computeRunStartTimeAdjustment(oldMetadata: NotebookCellInternalMetadata, newMetadata: NotebookCellInternalMetadata): number | undefined {\n    if (oldMetadata.runStartTime !== newMetadata.runStartTime && typeof newMetadata.runStartTime === 'number') {\n        const offset = Date.now() - newMetadata.runStartTime;\n        return offset < 0 ? Math.abs(offset) : 0;\n    } else {\n        return newMetadata.runStartTimeAdjustment;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, Emitter } from '@theia/core';\nimport { CellOutput, CellOutputItem, isTextStreamMime } from '../../common';\nimport { compressOutputItemStreams } from '../notebook-output-utils';\n\nexport class NotebookCellOutputModel implements Disposable {\n\n    private didChangeDataEmitter = new Emitter<void>();\n    readonly onDidChangeData = this.didChangeDataEmitter.event;\n\n    get outputId(): string {\n        return this.rawOutput.outputId;\n    }\n\n    get outputs(): CellOutputItem[] {\n        return this.rawOutput.outputs || [];\n    }\n\n    get metadata(): Record<string, unknown> | undefined {\n        return this.rawOutput.metadata;\n    }\n\n    constructor(protected rawOutput: CellOutput) { }\n\n    replaceData(rawData: CellOutput): void {\n        this.rawOutput = rawData;\n        this.optimizeOutputItems();\n        this.didChangeDataEmitter.fire();\n    }\n\n    appendData(items: CellOutputItem[]): void {\n        this.rawOutput.outputs.push(...items);\n        this.optimizeOutputItems();\n        this.didChangeDataEmitter.fire();\n    }\n\n    dispose(): void {\n        this.didChangeDataEmitter.dispose();\n    }\n\n    getData(): CellOutput {\n        return {\n            outputs: this.outputs,\n            metadata: this.metadata,\n            outputId: this.outputId\n        };\n    }\n\n    private optimizeOutputItems(): void {\n        if (this.outputs.length > 1 && this.outputs.every(item => isTextStreamMime(item.mime))) {\n            // Look for the mimes in the items, and keep track of their order.\n            // Merge the streams into one output item, per mime type.\n            const mimeOutputs = new Map<string, Uint8Array[]>();\n            const mimeTypes: string[] = [];\n            this.outputs.forEach(item => {\n                let items: Uint8Array[];\n                if (mimeOutputs.has(item.mime)) {\n                    items = mimeOutputs.get(item.mime)!;\n                } else {\n                    items = [];\n                    mimeOutputs.set(item.mime, items);\n                    mimeTypes.push(item.mime);\n                }\n                items.push(item.data.buffer);\n            });\n            this.outputs.length = 0;\n            mimeTypes.forEach(mime => {\n                const compressionResult = compressOutputItemStreams(mimeOutputs.get(mime)!);\n                this.outputs.push({\n                    mime,\n                    data: compressionResult.data\n                });\n            });\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 Typefox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, Emitter, Event, QueueableEmitter, Resource, URI } from '@theia/core';\nimport { Saveable, SaveOptions } from '@theia/core/lib/browser';\nimport {\n    CellData, CellEditType, CellUri, NotebookCellInternalMetadata,\n    NotebookCellMetadata,\n    NotebookCellsChangeType, NotebookCellTextModelSplice, NotebookData,\n    NotebookDocumentMetadata,\n} from '../../common';\nimport {\n    NotebookContentChangedEvent, NotebookModelWillAddRemoveEvent,\n    CellEditOperation, NullablePartialNotebookCellInternalMetadata,\n    NullablePartialNotebookCellMetadata\n} from '../notebook-types';\nimport { NotebookSerializer } from '../service/notebook-service';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookCellModel, NotebookCellModelFactory, NotebookCodeEditorFindMatch } from './notebook-cell-model';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { UndoRedoService } from '@theia/editor/lib/browser/undo-redo-service';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\nimport type { NotebookModelResolverService } from '../service/notebook-model-resolver-service';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { NotebookEditorFindMatch, NotebookEditorFindMatchOptions } from '../view/notebook-find-widget';\n\nexport const NotebookModelFactory = Symbol('NotebookModelFactory');\n\nexport function createNotebookModelContainer(parent: interfaces.Container, props: NotebookModelProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookModelProps).toConstantValue(props);\n    child.bind(NotebookModel).toSelf();\n\n    return child;\n}\n\nexport const NotebookModelResolverServiceProxy = Symbol('NotebookModelResolverServiceProxy');\n\nconst NotebookModelProps = Symbol('NotebookModelProps');\nexport interface NotebookModelProps {\n    data: NotebookData;\n    resource: Resource;\n    viewType: string;\n    serializer: NotebookSerializer;\n}\n\nexport interface SelectedCellChangeEvent {\n    cell: NotebookCellModel | undefined;\n    scrollIntoView: boolean;\n}\n\n@injectable()\nexport class NotebookModel implements Saveable, Disposable {\n\n    protected readonly onDirtyChangedEmitter = new Emitter<void>();\n    readonly onDirtyChanged = this.onDirtyChangedEmitter.event;\n\n    protected readonly onDidSaveNotebookEmitter = new Emitter<void>();\n    readonly onDidSaveNotebook = this.onDidSaveNotebookEmitter.event;\n\n    protected readonly onDidAddOrRemoveCellEmitter = new Emitter<NotebookModelWillAddRemoveEvent>();\n    readonly onDidAddOrRemoveCell = this.onDidAddOrRemoveCellEmitter.event;\n\n    protected readonly onDidChangeContentEmitter = new QueueableEmitter<NotebookContentChangedEvent>();\n    readonly onDidChangeContent = this.onDidChangeContentEmitter.event;\n\n    protected readonly onContentChangedEmitter = new Emitter<void>();\n    readonly onContentChanged = this.onContentChangedEmitter.event;\n\n    protected readonly onDidChangeSelectedCellEmitter = new Emitter<SelectedCellChangeEvent>();\n    readonly onDidChangeSelectedCell = this.onDidChangeSelectedCellEmitter.event;\n\n    protected readonly onDidDisposeEmitter = new Emitter<void>();\n    readonly onDidDispose = this.onDidDisposeEmitter.event;\n\n    get onDidChangeReadOnly(): Event<boolean | MarkdownString> {\n        return this.props.resource.onDidChangeReadOnly ?? Event.None;\n    }\n\n    @inject(FileService)\n    protected readonly fileService: FileService;\n\n    @inject(UndoRedoService)\n    protected readonly undoRedoService: UndoRedoService;\n\n    @inject(NotebookModelProps)\n    protected props: NotebookModelProps;\n\n    @inject(NotebookCellModelFactory)\n    protected cellModelFactory: NotebookCellModelFactory;\n\n    @inject(NotebookModelResolverServiceProxy)\n    protected modelResolverService: NotebookModelResolverService;\n\n    protected nextHandle: number = 0;\n\n    protected _dirty = false;\n\n    set dirty(dirty: boolean) {\n        const oldState = this._dirty;\n        this._dirty = dirty;\n        if (oldState !== dirty) {\n            this.onDirtyChangedEmitter.fire();\n        }\n    }\n\n    get dirty(): boolean {\n        return this._dirty;\n    }\n\n    get readOnly(): boolean | MarkdownString {\n        return this.props.resource.readOnly ?? false;\n    }\n\n    protected _selectedText = '';\n\n    set selectedText(value: string) {\n        this._selectedText = value;\n    }\n\n    get selectedText(): string {\n        return this._selectedText;\n    }\n\n    selectedCell?: NotebookCellModel;\n    protected dirtyCells: NotebookCellModel[] = [];\n\n    cells: NotebookCellModel[];\n\n    get uri(): URI {\n        return this.props.resource.uri;\n    }\n\n    get viewType(): string {\n        return this.props.viewType;\n    }\n\n    metadata: NotebookDocumentMetadata = {};\n\n    @postConstruct()\n    initialize(): void {\n        this.dirty = false;\n\n        this.cells = this.props.data.cells.map((cell, index) => this.cellModelFactory({\n            uri: CellUri.generate(this.props.resource.uri, index),\n            handle: index,\n            source: cell.source,\n            language: cell.language,\n            cellKind: cell.cellKind,\n            outputs: cell.outputs,\n            metadata: cell.metadata,\n            internalMetadata: cell.internalMetadata,\n            collapseState: cell.collapseState\n        }));\n\n        this.addCellOutputListeners(this.cells);\n\n        this.metadata = this.props.data.metadata;\n\n        this.nextHandle = this.cells.length;\n    }\n\n    dispose(): void {\n        this.onDirtyChangedEmitter.dispose();\n        this.onDidSaveNotebookEmitter.dispose();\n        this.onDidAddOrRemoveCellEmitter.dispose();\n        this.onDidChangeContentEmitter.dispose();\n        this.onDidChangeSelectedCellEmitter.dispose();\n        this.cells.forEach(cell => cell.dispose());\n        this.onDidDisposeEmitter.fire();\n    }\n\n    async save(options?: SaveOptions): Promise<void> {\n        this.dirtyCells = [];\n        this.dirty = false;\n\n        const serializedNotebook = await this.serialize();\n        this.fileService.writeFile(this.uri, serializedNotebook);\n\n        this.onDidSaveNotebookEmitter.fire();\n    }\n\n    createSnapshot(): Saveable.Snapshot {\n        return {\n            read: () => JSON.stringify(this.getData())\n        };\n    }\n\n    serialize(): Promise<BinaryBuffer> {\n        return this.props.serializer.fromNotebook(this.getData());\n    }\n\n    async applySnapshot(snapshot: Saveable.Snapshot): Promise<void> {\n        const rawData = Saveable.Snapshot.read(snapshot);\n        if (!rawData) {\n            throw new Error('could not read notebook snapshot');\n        }\n        const data = JSON.parse(rawData) as NotebookData;\n        this.setData(data);\n    }\n\n    async revert(options?: Saveable.RevertOptions): Promise<void> {\n        if (!options?.soft) {\n            // Load the data from the file again\n            try {\n                const data = await this.modelResolverService.resolveExistingNotebookData(this.props.resource, this.props.viewType);\n                this.setData(data, false);\n            } catch (err) {\n                console.error('Failed to revert notebook', err);\n            }\n        }\n        this.dirty = false;\n    }\n\n    isDirty(): boolean {\n        return this.dirty;\n    }\n\n    cellDirtyChanged(cell: NotebookCellModel, dirtyState: boolean): void {\n        if (dirtyState) {\n            this.dirtyCells.push(cell);\n        } else {\n            this.dirtyCells.splice(this.dirtyCells.indexOf(cell), 1);\n        }\n\n        this.dirty = this.dirtyCells.length > 0;\n        // Only fire `onContentChangedEmitter` here, because `onDidChangeContentEmitter` is used for model level changes only\n        // However, this event indicates that the content of a cell has changed\n        this.onContentChangedEmitter.fire();\n    }\n\n    setData(data: NotebookData, markDirty = true): void {\n        // Replace all cells in the model\n        this.dirtyCells = [];\n        this.replaceCells(0, this.cells.length, data.cells, false, false);\n        this.metadata = data.metadata;\n        this.dirty = markDirty;\n        this.onDidChangeContentEmitter.fire();\n    }\n\n    getData(): NotebookData {\n        return {\n            cells: this.cells.map(cell => cell.getData()),\n            metadata: this.metadata\n        };\n    }\n\n    undo(): void {\n        if (!this.readOnly) {\n            this.undoRedoService.undo(this.uri);\n        }\n    }\n\n    redo(): void {\n        if (!this.readOnly) {\n            this.undoRedoService.redo(this.uri);\n        }\n    }\n\n    setSelectedCell(cell: NotebookCellModel, scrollIntoView?: boolean): void {\n        if (this.selectedCell !== cell) {\n            this.selectedCell = cell;\n            this.onDidChangeSelectedCellEmitter.fire({ cell, scrollIntoView: scrollIntoView ?? true });\n        }\n    }\n\n    private addCellOutputListeners(cells: NotebookCellModel[]): void {\n        for (const cell of cells) {\n            cell.onDidChangeOutputs(() => {\n                this.dirty = true;\n            });\n            cell.onDidRequestCellEditChange(() => {\n                this.onContentChangedEmitter.fire();\n            });\n        }\n    }\n\n    getVisibleCells(): NotebookCellModel[] {\n        return this.cells;\n    }\n\n    applyEdits(rawEdits: CellEditOperation[], computeUndoRedo: boolean): void {\n        const editsWithDetails = rawEdits.map((edit, index) => {\n            let cellIndex: number = -1;\n            if ('index' in edit) {\n                cellIndex = edit.index;\n            } else if ('handle' in edit) {\n                cellIndex = this.getCellIndexByHandle(edit.handle);\n            } else if ('outputId' in edit) {\n                cellIndex = this.cells.findIndex(cell => cell.outputs.some(output => output.outputId === edit.outputId));\n            }\n\n            return {\n                edit,\n                cellIndex,\n                end: edit.editType === CellEditType.Replace ? edit.index + edit.count : cellIndex,\n                originalIndex: index\n            };\n        });\n\n        for (const { edit, cellIndex } of editsWithDetails) {\n            const cell = this.cells[cellIndex];\n            if (cell) {\n                this.cellDirtyChanged(cell, true);\n            }\n\n            let scrollIntoView = true;\n            switch (edit.editType) {\n                case CellEditType.Replace:\n                    this.replaceCells(edit.index, edit.count, edit.cells, computeUndoRedo, true);\n                    scrollIntoView = edit.cells.length > 0;\n                    break;\n                case CellEditType.Output: {\n                    if (edit.append) {\n                        cell.spliceNotebookCellOutputs({ deleteCount: 0, newOutputs: edit.outputs, start: cell.outputs.length });\n                    } else {\n                        // could definitely be more efficient. See vscode __spliceNotebookCellOutputs2\n                        // For now, just replace the whole existing output with the new output\n                        cell.spliceNotebookCellOutputs({ start: 0, deleteCount: edit.deleteCount ?? cell.outputs.length, newOutputs: edit.outputs });\n                    }\n                    this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.Output, index: cellIndex, outputs: cell.outputs, append: edit.append ?? false });\n                    break;\n                }\n                case CellEditType.OutputItems:\n                    cell.changeOutputItems(edit.outputId, !!edit.append, edit.items);\n                    this.onDidChangeContentEmitter.queue({\n                        kind: NotebookCellsChangeType.OutputItem, index: cellIndex, outputItems: edit.items,\n                        outputId: edit.outputId, append: edit.append ?? false\n                    });\n\n                    break;\n                case CellEditType.Metadata:\n                    this.changeCellMetadata(this.cells[cellIndex], edit.metadata, false);\n                    break;\n                case CellEditType.PartialMetadata:\n                    this.changeCellMetadataPartial(this.cells[cellIndex], edit.metadata, false);\n                    break;\n                case CellEditType.PartialInternalMetadata:\n                    this.changeCellInternalMetadataPartial(this.cells[cellIndex], edit.internalMetadata);\n                    break;\n                case CellEditType.CellLanguage:\n                    this.changeCellLanguage(this.cells[cellIndex], edit.language, computeUndoRedo);\n                    break;\n                case CellEditType.DocumentMetadata:\n                    this.updateNotebookMetadata(edit.metadata, false);\n                    break;\n                case CellEditType.Move:\n                    this.moveCellToIndex(cellIndex, edit.length, edit.newIdx, computeUndoRedo);\n                    break;\n            }\n\n            // if selected cell is affected update it because it can potentially have been replaced\n            if (cell === this.selectedCell) {\n                this.setSelectedCell(this.cells[Math.min(cellIndex, this.cells.length - 1)], scrollIntoView);\n            }\n        }\n\n        this.fireContentChange();\n    }\n\n    protected fireContentChange(): void {\n        this.onDidChangeContentEmitter.fire();\n        this.onContentChangedEmitter.fire();\n    }\n\n    protected replaceCells(start: number, deleteCount: number, newCells: CellData[], computeUndoRedo: boolean, requestEdit: boolean): void {\n        const cells = newCells.map(cell => {\n            const handle = this.nextHandle++;\n            return this.cellModelFactory({\n                uri: CellUri.generate(this.uri, handle),\n                handle: handle,\n                source: cell.source,\n                language: cell.language,\n                cellKind: cell.cellKind,\n                outputs: cell.outputs,\n                metadata: cell.metadata,\n                internalMetadata: cell.internalMetadata,\n                collapseState: cell.collapseState\n            });\n        });\n        this.addCellOutputListeners(cells);\n\n        const changes: NotebookCellTextModelSplice<NotebookCellModel>[] = [{\n            start,\n            deleteCount,\n            newItems: cells,\n            startHandle: this.cells[start]?.handle ?? -1 // -1 in case of new Cells are added at the end.\n        }];\n\n        const deletedCells = this.cells.splice(start, deleteCount, ...cells);\n\n        for (const cell of deletedCells) {\n            cell.dispose();\n        }\n\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => {\n                    this.replaceCells(start, newCells.length, deletedCells.map(cell => cell.getData()), false, false);\n                    this.fireContentChange();\n                },\n                async () => {\n                    this.replaceCells(start, deleteCount, newCells, false, false);\n                    this.fireContentChange();\n                }\n            );\n        }\n\n        this.onDidAddOrRemoveCellEmitter.fire({ rawEvent: { kind: NotebookCellsChangeType.ModelChange, changes }, newCellIds: cells.map(cell => cell.handle) });\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ModelChange, changes });\n        if (cells.length > 0 && requestEdit) {\n            this.setSelectedCell(cells[cells.length - 1]);\n            cells[cells.length - 1].requestEdit();\n        }\n    }\n\n    protected changeCellInternalMetadataPartial(cell: NotebookCellModel, internalMetadata: NullablePartialNotebookCellInternalMetadata): void {\n        const newInternalMetadata: NotebookCellInternalMetadata = {\n            ...cell.internalMetadata\n        };\n        let k: keyof NotebookCellInternalMetadata;\n        // eslint-disable-next-line guard-for-in\n        for (k in internalMetadata) {\n            newInternalMetadata[k] = (internalMetadata[k] ?? undefined) as never;\n        }\n\n        cell.internalMetadata = newInternalMetadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellInternalMetadata, index: this.cells.indexOf(cell), internalMetadata: newInternalMetadata });\n    }\n\n    protected updateNotebookMetadata(metadata: NotebookDocumentMetadata, computeUndoRedo: boolean): void {\n        const oldMetadata = this.metadata;\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => this.updateNotebookMetadata(oldMetadata, false),\n                async () => this.updateNotebookMetadata(metadata, false)\n            );\n        }\n\n        this.metadata = metadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeDocumentMetadata, metadata: this.metadata });\n    }\n\n    protected changeCellMetadataPartial(cell: NotebookCellModel, metadata: NullablePartialNotebookCellMetadata, computeUndoRedo: boolean): void {\n        const newMetadata: NotebookCellMetadata = {\n            ...cell.metadata\n        };\n        let k: keyof NullablePartialNotebookCellMetadata;\n        // eslint-disable-next-line guard-for-in\n        for (k in metadata) {\n            const value = metadata[k] ?? undefined;\n            newMetadata[k] = value as unknown;\n        }\n\n        this.changeCellMetadata(cell, newMetadata, computeUndoRedo);\n    }\n\n    protected changeCellMetadata(cell: NotebookCellModel, metadata: NotebookCellMetadata, computeUndoRedo: boolean): void {\n        const triggerDirtyChange = this.isCellMetadataChanged(cell.metadata, metadata);\n\n        if (triggerDirtyChange) {\n            if (computeUndoRedo) {\n                const oldMetadata = cell.metadata;\n                cell.metadata = metadata;\n                this.undoRedoService.pushElement(this.uri,\n                    async () => { cell.metadata = oldMetadata; },\n                    async () => { cell.metadata = metadata; }\n                );\n            }\n        }\n\n        cell.metadata = metadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellMetadata, index: this.cells.indexOf(cell), metadata: cell.metadata });\n    }\n\n    protected changeCellLanguage(cell: NotebookCellModel, languageId: string, computeUndoRedo: boolean): void {\n        if (cell.language === languageId) {\n            return;\n        }\n\n        cell.language = languageId;\n\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellLanguage, index: this.cells.indexOf(cell), language: languageId });\n    }\n\n    protected moveCellToIndex(fromIndex: number, length: number, toIndex: number, computeUndoRedo: boolean): boolean {\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => {\n                    this.moveCellToIndex(toIndex, length, fromIndex, false);\n                    this.fireContentChange();\n                },\n                async () => {\n                    this.moveCellToIndex(fromIndex, length, toIndex, false);\n                    this.fireContentChange();\n                }\n            );\n        }\n\n        const cells = this.cells.splice(fromIndex, length);\n        this.cells.splice(toIndex, 0, ...cells);\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.Move, index: fromIndex, length, newIdx: toIndex, cells });\n\n        return true;\n    }\n\n    getCellIndexByHandle(handle: number): number {\n        return this.cells.findIndex(c => c.handle === handle);\n    }\n\n    getCellByHandle(handle: number): NotebookCellModel | undefined {\n        return this.cells.find(c => c.handle === handle);\n    }\n\n    protected isCellMetadataChanged(a: NotebookCellMetadata, b: NotebookCellMetadata): boolean {\n        const keys = new Set<keyof NotebookCellMetadata>([...Object.keys(a || {}), ...Object.keys(b || {})]);\n        for (const key of keys) {\n            if (a[key] !== b[key]) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    findMatches(options: NotebookEditorFindMatchOptions): NotebookEditorFindMatch[] {\n        const matches: NotebookEditorFindMatch[] = [];\n        for (const cell of this.cells) {\n            matches.push(...cell.findMatches(options));\n        }\n        return matches;\n    }\n\n    replaceAll(matches: NotebookEditorFindMatch[], text: string): void {\n        const matchMap = new Map<NotebookCellModel, NotebookCodeEditorFindMatch[]>();\n        for (const match of matches) {\n            if (match instanceof NotebookCodeEditorFindMatch) {\n                if (!matchMap.has(match.cell)) {\n                    matchMap.set(match.cell, []);\n                }\n                matchMap.get(match.cell)?.push(match);\n            }\n        }\n        for (const [cell, cellMatches] of matchMap) {\n            cell.replaceAll(cellMatches, text);\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellModel, NotebookCodeEditorFindMatch } from '../view-model/notebook-cell-model';\nimport { SimpleMonacoEditor } from '@theia/monaco/lib/browser/simple-monaco-editor';\nimport { MonacoEditor, MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { MonacoEditorProvider } from '@theia/monaco/lib/browser/monaco-editor-provider';\nimport { IContextKeyService } from '@theia/monaco-editor-core/esm/vs/platform/contextkey/common/contextkey';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\nimport { DisposableCollection, OS } from '@theia/core';\nimport { NotebookViewportService } from './notebook-viewport-service';\nimport { BareFontInfo } from '@theia/monaco-editor-core/esm/vs/editor/common/config/fontInfo';\nimport { NOTEBOOK_CELL_CURSOR_FIRST_LINE, NOTEBOOK_CELL_CURSOR_LAST_LINE } from '../contributions/notebook-context-keys';\nimport { EditorExtensionsRegistry } from '@theia/monaco-editor-core/esm/vs/editor/browser/editorExtensions';\nimport { ModelDecorationOptions } from '@theia/monaco-editor-core/esm/vs/editor/common/model/textModel';\nimport { IModelDeltaDecoration, OverviewRulerLane, TrackedRangeStickiness } from '@theia/monaco-editor-core/esm/vs/editor/common/model';\nimport { animationFrame } from '@theia/core/lib/browser';\nimport { NotebookCellEditorService } from '../service/notebook-cell-editor-service';\n\ninterface CellEditorProps {\n    notebookModel: NotebookModel;\n    cell: NotebookCellModel;\n    monacoServices: MonacoEditorServices;\n    notebookContextManager: NotebookContextManager;\n    notebookCellEditorService: NotebookCellEditorService;\n    notebookViewportService?: NotebookViewportService;\n    fontInfo?: BareFontInfo;\n}\n\nconst DEFAULT_EDITOR_OPTIONS: MonacoEditor.IOptions = {\n    ...MonacoEditorProvider.inlineOptions,\n    minHeight: -1,\n    maxHeight: -1,\n    scrollbar: {\n        ...MonacoEditorProvider.inlineOptions.scrollbar,\n        alwaysConsumeMouseWheel: false\n    },\n    lineDecorationsWidth: 10,\n};\n\nexport const CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'current-find-match',\n    stickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n    zIndex: 13,\n    className: 'currentFindMatch',\n    inlineClassName: 'currentFindMatchInline',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: 'editorOverviewRuler.findMatchForeground',\n        position: OverviewRulerLane.Center\n    }\n});\n\nexport const FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n    description: 'find-match',\n    stickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n    zIndex: 10,\n    className: 'findMatch',\n    inlineClassName: 'findMatchInline',\n    showIfCollapsed: true,\n    overviewRuler: {\n        color: 'editorOverviewRuler.findMatchForeground',\n        position: OverviewRulerLane.Center\n    }\n});\n\nexport class CellEditor extends React.Component<CellEditorProps, {}> {\n\n    protected editor?: SimpleMonacoEditor;\n    protected toDispose = new DisposableCollection();\n    protected container?: HTMLDivElement;\n    protected matches: NotebookCodeEditorFindMatch[] = [];\n    protected oldMatchDecorations: string[] = [];\n\n    override componentDidMount(): void {\n        this.disposeEditor();\n        this.toDispose.push(this.props.cell.onWillFocusCellEditor(focusRequest => {\n            this.editor?.getControl().focus();\n            const lineCount = this.editor?.getControl().getModel()?.getLineCount();\n            if (focusRequest && lineCount !== undefined) {\n                this.editor?.getControl().setPosition(focusRequest === 'lastLine' ?\n                    { lineNumber: lineCount, column: 1 } :\n                    { lineNumber: focusRequest, column: 1 },\n                    'keyboard');\n            }\n            const currentLine = this.editor?.getControl().getPosition()?.lineNumber;\n            this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, currentLine === 1);\n            this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE, currentLine === lineCount);\n        }));\n\n        this.toDispose.push(this.props.cell.onWillBlurCellEditor(() => this.blurEditor()));\n\n        this.toDispose.push(this.props.cell.onDidChangeEditorOptions(options => {\n            this.editor?.getControl().updateOptions(options);\n        }));\n\n        this.toDispose.push(this.props.cell.onDidChangeLanguage(language => {\n            this.editor?.setLanguage(language);\n        }));\n\n        this.toDispose.push(this.props.cell.onDidFindMatches(matches => {\n            this.matches = matches;\n            animationFrame().then(() => this.setMatches());\n        }));\n\n        this.toDispose.push(this.props.cell.onDidSelectFindMatch(match => this.centerEditorInView()));\n\n        this.toDispose.push(this.props.notebookModel.onDidChangeSelectedCell(e => {\n            if (e.cell !== this.props.cell && this.editor?.getControl().hasTextFocus()) {\n                this.blurEditor();\n            }\n        }));\n        if (!this.props.notebookViewportService || (this.container && this.props.notebookViewportService.isElementInViewport(this.container))) {\n            this.initEditor();\n        } else {\n            const disposable = this.props.notebookViewportService?.onDidChangeViewport(() => {\n                if (!this.editor && this.container && this.props.notebookViewportService!.isElementInViewport(this.container)) {\n                    this.initEditor();\n                    disposable.dispose();\n                }\n            });\n            this.toDispose.push(disposable);\n        }\n\n        this.toDispose.push(this.props.cell.onDidRequestCenterEditor(() => {\n            this.centerEditorInView();\n        }));\n    }\n\n    override componentWillUnmount(): void {\n        this.disposeEditor();\n    }\n\n    protected disposeEditor(): void {\n        if (this.editor) {\n            this.props.notebookCellEditorService.editorDisposed(this.editor.uri);\n        }\n        this.toDispose.dispose();\n        this.toDispose = new DisposableCollection();\n    }\n\n    protected centerEditorInView(): void {\n        const editorDomNode = this.editor?.getControl().getDomNode();\n        if (editorDomNode) {\n            editorDomNode.scrollIntoView({\n                behavior: 'instant',\n                block: 'center'\n            });\n        } else {\n            this.container?.scrollIntoView({\n                behavior: 'instant',\n                block: 'center'\n            });\n        }\n    }\n\n    protected async initEditor(): Promise<void> {\n        const { cell, notebookModel, monacoServices } = this.props;\n        if (this.container) {\n            const editorNode = this.container;\n            editorNode.style.height = '';\n            const editorModel = await cell.resolveTextModel();\n            const uri = cell.uri;\n            this.editor = new SimpleMonacoEditor(uri,\n                editorModel,\n                editorNode,\n                monacoServices,\n                { ...DEFAULT_EDITOR_OPTIONS, ...cell.editorOptions },\n                [[IContextKeyService, this.props.notebookContextManager.scopedStore]],\n                { contributions: EditorExtensionsRegistry.getEditorContributions().filter(c => c.id !== 'editor.contrib.findController') });\n            this.toDispose.push(this.editor);\n            this.editor.setLanguage(cell.language);\n            this.toDispose.push(this.editor.getControl().onDidContentSizeChange(() => {\n                editorNode.style.height = this.editor!.getControl().getContentHeight() + 7 + 'px';\n                this.editor!.setSize({ width: -1, height: this.editor!.getControl().getContentHeight() });\n            }));\n            this.toDispose.push(this.editor.onDocumentContentChanged(e => {\n                notebookModel.cellDirtyChanged(cell, true);\n            }));\n            this.toDispose.push(this.editor.getControl().onDidFocusEditorText(() => {\n                this.props.notebookModel.setSelectedCell(cell, false);\n                this.props.notebookCellEditorService.editorFocusChanged(this.editor);\n            }));\n            this.toDispose.push(this.editor.getControl().onDidBlurEditorText(() => {\n                if (this.props.notebookCellEditorService.getActiveCell()?.uri.toString() === this.props.cell.uri.toString()) {\n                    this.props.notebookCellEditorService.editorFocusChanged(undefined);\n                }\n            }));\n\n            this.toDispose.push(this.editor.getControl().onDidChangeCursorSelection(e => {\n                const selectedText = this.editor!.getControl().getModel()!.getValueInRange(e.selection);\n                // TODO handle secondary selections\n                this.props.cell.selection = {\n                    start: { line: e.selection.startLineNumber - 1, character: e.selection.startColumn - 1 },\n                    end: { line: e.selection.endLineNumber - 1, character: e.selection.endColumn - 1 }\n                };\n                this.props.notebookModel.selectedText = selectedText;\n            }));\n            this.toDispose.push(this.editor.getControl().onDidChangeCursorPosition(e => {\n                if (e.secondaryPositions.length === 0) {\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, e.position.lineNumber === 1);\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE,\n                        e.position.lineNumber === this.editor!.getControl().getModel()!.getLineCount());\n                } else {\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, false);\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE, false);\n                }\n            }));\n            this.props.notebookCellEditorService.editorCreated(uri, this.editor);\n            this.setMatches();\n            if (notebookModel.selectedCell === cell) {\n                this.editor.getControl().focus();\n            }\n        }\n    }\n\n    protected setMatches(): void {\n        if (!this.editor) {\n            return;\n        }\n        const decorations: IModelDeltaDecoration[] = [];\n        for (const match of this.matches) {\n            const decoration = match.selected ? CURRENT_FIND_MATCH_DECORATION : FIND_MATCH_DECORATION;\n            decorations.push({\n                range: {\n                    startLineNumber: match.range.start.line,\n                    startColumn: match.range.start.character,\n                    endLineNumber: match.range.end.line,\n                    endColumn: match.range.end.character\n                },\n                options: decoration\n            });\n        }\n\n        this.oldMatchDecorations = this.editor.getControl()\n            .changeDecorations(accessor => accessor.deltaDecorations(this.oldMatchDecorations, decorations));\n    }\n\n    protected setContainer(component: HTMLDivElement | null): void {\n        this.container = component ?? undefined;\n    };\n\n    protected handleResize = () => {\n        this.editor?.refresh();\n    };\n\n    protected estimateHeight(): string {\n        const lineHeight = this.props.fontInfo?.lineHeight ?? 20;\n        return this.props.cell.text.split(OS.backend.EOL).length * lineHeight + 10 + 7 + 'px';\n    }\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-editor' onResize={this.handleResize} id={this.props.cell.uri.toString()}\n            ref={container => this.setContainer(container)} style={{ height: this.editor ? undefined : this.estimateHeight() }}>\n        </div >;\n    }\n\n    protected blurEditor(): void {\n        let parent = this.container?.parentElement;\n        while (parent && !parent.classList.contains('theia-notebook-cell')) {\n            parent = parent.parentElement;\n        }\n        if (parent) {\n            parent.focus();\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport * as React from '@theia/core/shared/react';\nimport { CellEditType, CellKind, NotebookCellsChangeType } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellToolbarFactory } from './notebook-cell-toolbar-factory';\nimport { animationFrame, onDomEvent } from '@theia/core/lib/browser';\nimport { CommandMenu, CommandRegistry, DisposableCollection, MenuModelRegistry, nls } from '@theia/core';\nimport { NotebookCommands, NotebookMenus } from '../contributions/notebook-actions-contribution';\nimport { NotebookCellActionContribution } from '../contributions/notebook-cell-actions-contribution';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\nexport interface CellRenderer {\n    render(notebookData: NotebookModel, cell: NotebookCellModel, index: number): React.ReactNode\n    renderSidebar(notebookModel: NotebookModel, cell: NotebookCellModel): React.ReactNode\n    renderDragImage(cell: NotebookCellModel): HTMLElement\n}\n\nexport function observeCellHeight(ref: HTMLDivElement | null, cell: NotebookCellModel): void {\n    if (ref) {\n        cell.cellHeight = ref?.getBoundingClientRect().height ?? 0;\n        new ResizeObserver(entries =>\n            cell.cellHeight = ref?.getBoundingClientRect().height ?? 0\n        ).observe(ref);\n    }\n}\n\ninterface CellListProps {\n    renderers: Map<CellKind, CellRenderer>;\n    notebookModel: NotebookModel;\n    notebookContext: NotebookContextManager;\n    toolbarRenderer: NotebookCellToolbarFactory;\n    commandRegistry: CommandRegistry;\n    menuRegistry: MenuModelRegistry;\n}\n\ninterface NotebookCellListState {\n    selectedCell?: NotebookCellModel;\n    scrollIntoView: boolean;\n    dragOverIndicator: { cell: NotebookCellModel, position: 'top' | 'bottom' } | undefined;\n}\n\nexport class NotebookCellListView extends React.Component<CellListProps, NotebookCellListState> {\n\n    protected toDispose = new DisposableCollection();\n\n    protected static dragGhost: HTMLElement | undefined;\n    protected cellListRef: React.RefObject<HTMLUListElement> = React.createRef();\n\n    constructor(props: CellListProps) {\n        super(props);\n        this.state = { selectedCell: props.notebookModel.selectedCell, dragOverIndicator: undefined, scrollIntoView: true };\n        this.toDispose.push(props.notebookModel.onDidAddOrRemoveCell(e => {\n            if (e.newCellIds && e.newCellIds.length > 0) {\n                this.setState({\n                    ...this.state,\n                    selectedCell: this.props.notebookModel.cells.find(model => model.handle === e.newCellIds![e.newCellIds!.length - 1]),\n                    scrollIntoView: true\n                });\n            } else {\n                this.setState({\n                    ...this.state,\n                    selectedCell: this.props.notebookModel.cells.find(cell => cell === this.state.selectedCell),\n                    scrollIntoView: false\n                });\n            }\n        }));\n\n        this.toDispose.push(props.notebookModel.onDidChangeContent(events => {\n            if (events.some(e => e.kind === NotebookCellsChangeType.Move)) {\n                // When a cell has been moved, we need to rerender the whole component\n                this.forceUpdate();\n            }\n        }));\n\n        this.toDispose.push(props.notebookModel.onDidChangeSelectedCell(e => {\n            this.setState({\n                ...this.state,\n                selectedCell: e.cell,\n                scrollIntoView: e.scrollIntoView\n            });\n        }));\n\n        this.toDispose.push(onDomEvent(document, 'focusin', () => {\n            animationFrame().then(() => {\n                if (!this.cellListRef.current) {\n                    return;\n                }\n                let hasCellFocus = false;\n                let hasFocus = false;\n                if (this.cellListRef.current.contains(document.activeElement)) {\n                    if (this.props.notebookModel.selectedCell) {\n                        hasCellFocus = true;\n                    }\n                    hasFocus = true;\n                }\n                this.props.notebookContext.changeCellFocus(hasCellFocus);\n                this.props.notebookContext.changeCellListFocus(hasFocus);\n            });\n        }));\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return <ul className='theia-notebook-cell-list' ref={this.cellListRef} onDragStart={e => this.onDragStart(e)}>\n            {this.props.notebookModel.getVisibleCells()\n                .map((cell, index) =>\n                    <React.Fragment key={'cell-' + cell.handle}>\n                        <NotebookCellDivider\n                            menuRegistry={this.props.menuRegistry}\n                            isVisible={() => this.isEnabled()}\n                            onAddNewCell={handler => this.onAddNewCell(handler, index)}\n                            onDrop={e => this.onDrop(e, index)}\n                            onDragOver={e => this.onDragOver(e, cell, 'top')} />\n                        <CellDropIndicator visible={this.shouldRenderDragOverIndicator(cell, 'top')} />\n                        <li className={'theia-notebook-cell' + (this.state.selectedCell === cell ? ' focused' : '') + (this.isEnabled() ? ' draggable' : '')}\n                            onDragEnd={e => {\n                                NotebookCellListView.dragGhost?.remove();\n                                this.setState({ ...this.state, dragOverIndicator: undefined });\n                            }}\n                            onDragOver={e => this.onDragOver(e, cell)}\n                            onDrop={e => this.onDrop(e, index)}\n                            draggable={true}\n                            tabIndex={-1}\n                            data-cell-handle={cell.handle}\n                            ref={ref => {\n                                if (ref && cell === this.state.selectedCell && this.state.scrollIntoView) {\n                                    ref.scrollIntoView({ block: 'nearest' });\n                                    if (cell.cellKind === CellKind.Markup && !cell.editing) {\n                                        ref.focus();\n                                    }\n                                }\n                            }}\n                            onClick={e => {\n                                this.setState({ ...this.state, selectedCell: cell });\n                                this.props.notebookModel.setSelectedCell(cell, false);\n                            }}\n                        >\n                            <div className='theia-notebook-cell-sidebar'>\n                                <div className={'theia-notebook-cell-marker' + (this.state.selectedCell === cell ? ' theia-notebook-cell-marker-selected' : '')}></div>\n                                {this.renderCellSidebar(cell)}\n                            </div>\n                            <div className='theia-notebook-cell-content'>\n                                {this.renderCellContent(cell, index)}\n                            </div>\n                            {this.state.selectedCell === cell &&\n                                this.props.toolbarRenderer.renderCellToolbar(NotebookCellActionContribution.ACTION_MENU, cell, {\n                                    contextMenuArgs: () => [cell], commandArgs: () => [this.props.notebookModel]\n                                })\n                            }\n                        </li>\n                        <CellDropIndicator visible={this.shouldRenderDragOverIndicator(cell, 'bottom')} />\n                    </React.Fragment>\n                )\n            }\n            <NotebookCellDivider\n                menuRegistry={this.props.menuRegistry}\n                isVisible={() => this.isEnabled()}\n                onAddNewCell={handler => this.onAddNewCell(handler, this.props.notebookModel.cells.length)}\n                onDrop={e => this.onDrop(e, this.props.notebookModel.cells.length - 1)}\n                onDragOver={e => this.onDragOver(e, this.props.notebookModel.cells[this.props.notebookModel.cells.length - 1], 'bottom')} />\n        </ul>;\n    }\n\n    renderCellContent(cell: NotebookCellModel, index: number): React.ReactNode {\n        const renderer = this.props.renderers.get(cell.cellKind);\n        if (!renderer) {\n            throw new Error(`No renderer found for cell type ${cell.cellKind}`);\n        }\n        return renderer.render(this.props.notebookModel, cell, index);\n    }\n\n    renderCellSidebar(cell: NotebookCellModel): React.ReactNode {\n        const renderer = this.props.renderers.get(cell.cellKind);\n        if (!renderer) {\n            throw new Error(`No renderer found for cell type ${cell.cellKind}`);\n        }\n        return renderer.renderSidebar(this.props.notebookModel, cell);\n    }\n\n    protected onDragStart(event: React.DragEvent<HTMLElement>): void {\n        event.stopPropagation();\n        if (!this.isEnabled()) {\n            event.preventDefault();\n            return;\n        }\n\n        const cellHandle = (event.target as HTMLLIElement).getAttribute('data-cell-handle');\n\n        if (!cellHandle) {\n            throw new Error('Cell handle not found in element for cell drag event');\n        }\n\n        const index = this.props.notebookModel.getCellIndexByHandle(parseInt(cellHandle));\n        const cell = this.props.notebookModel.cells[index];\n\n        NotebookCellListView.dragGhost = document.createElement('div');\n        NotebookCellListView.dragGhost.classList.add('theia-notebook-drag-ghost-image');\n        NotebookCellListView.dragGhost.appendChild(this.props.renderers.get(cell.cellKind)?.renderDragImage(cell) ?? document.createElement('div'));\n        document.body.appendChild(NotebookCellListView.dragGhost);\n        event.dataTransfer.setDragImage(NotebookCellListView.dragGhost, -10, 0);\n\n        event.dataTransfer.setData('text/theia-notebook-cell-index', index.toString());\n        event.dataTransfer.setData('text/plain', this.props.notebookModel.cells[index].source);\n    }\n\n    protected onDragOver(event: React.DragEvent<HTMLLIElement>, cell: NotebookCellModel, position?: 'top' | 'bottom'): void {\n        if (!this.isEnabled()) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        // show indicator\n        this.setState({ ...this.state, dragOverIndicator: { cell, position: position ?? event.nativeEvent.offsetY < event.currentTarget.clientHeight / 2 ? 'top' : 'bottom' } });\n    }\n\n    protected isEnabled(): boolean {\n        return !Boolean(this.props.notebookModel.readOnly);\n    }\n\n    protected onDrop(event: React.DragEvent<HTMLLIElement>, dropElementIndex: number): void {\n        if (!this.isEnabled()) {\n            this.setState({ dragOverIndicator: undefined });\n            return;\n        }\n        const index = parseInt(event.dataTransfer.getData('text/theia-notebook-cell-index'));\n        const isTargetBelow = index < dropElementIndex;\n        let newIdx = this.state.dragOverIndicator?.position === 'top' ? dropElementIndex : dropElementIndex + 1;\n        newIdx = isTargetBelow ? newIdx - 1 : newIdx;\n        if (index !== undefined && index !== dropElementIndex) {\n            this.props.notebookModel.applyEdits([{\n                editType: CellEditType.Move,\n                length: 1,\n                index,\n                newIdx\n            }], true);\n        }\n        this.setState({ ...this.state, dragOverIndicator: undefined });\n    }\n\n    protected onAddNewCell(handler: (...args: unknown[]) => void, index: number): void {\n        if (this.isEnabled()) {\n            this.props.commandRegistry.executeCommand(NotebookCommands.CHANGE_SELECTED_CELL.id, index - 1);\n            handler(\n                this.props.notebookModel,\n                index\n            );\n        }\n    }\n\n    protected shouldRenderDragOverIndicator(cell: NotebookCellModel, position: 'top' | 'bottom'): boolean {\n        return this.isEnabled() &&\n            this.state.dragOverIndicator !== undefined &&\n            this.state.dragOverIndicator.cell === cell &&\n            this.state.dragOverIndicator.position === position;\n    }\n\n}\n\nexport interface NotebookCellDividerProps {\n    isVisible: () => boolean;\n    onAddNewCell: (createCommand: (...args: unknown[]) => void) => void;\n    onDrop: (event: React.DragEvent<HTMLLIElement>) => void;\n    onDragOver: (event: React.DragEvent<HTMLLIElement>) => void;\n    menuRegistry: MenuModelRegistry;\n}\n\nexport function NotebookCellDivider({ isVisible, onAddNewCell, onDrop, onDragOver, menuRegistry }: NotebookCellDividerProps): React.JSX.Element {\n    const [hover, setHover] = React.useState(false);\n\n    const menuPath = NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP; // we contribute into this menu, so it will exist\n    const menuItems: CommandMenu[] = menuRegistry.getMenu(menuPath)!.children.filter(item => CommandMenu.is(item)).map(item => item as CommandMenu);\n\n    const renderItem = (item: CommandMenu): React.ReactNode => {\n        const execute = (...args: unknown[]) => {\n            if (CommandMenu.is(item)) {\n                item.run([...menuPath, item.id], ...args);\n            }\n        };\n        return <button\n            key={item.id}\n            className='theia-notebook-add-cell-button'\n            onClick={() => onAddNewCell(execute)}\n            title={nls.localizeByDefault(`Add ${item.label} Cell`)}\n        >\n            <div className={item.icon + ' theia-notebook-add-cell-button-icon'} />\n            <div className='theia-notebook-add-cell-button-text'>{item.label}</div>\n        </button>;\n    };\n\n    return <li className='theia-notebook-cell-divider' onMouseEnter={() => setHover(true)} onMouseLeave={() => setHover(false)} onDrop={onDrop} onDragOver={onDragOver}>\n        {hover && isVisible() && <div className='theia-notebook-add-cell-buttons'>\n            {menuItems.map((item: CommandMenu) => renderItem(item))}\n        </div>}\n    </li>;\n}\n\nfunction CellDropIndicator(props: { visible: boolean }): React.JSX.Element {\n    return <div className='theia-notebook-cell-drop-indicator' style={{ visibility: props.visible ? 'visible' : 'hidden' }} />;\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { CommandMenu, CommandRegistry, CompoundMenuNode, DisposableCollection, Emitter, Event, MenuModelRegistry, MenuPath, RenderedMenuNode } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookCellSidebar, NotebookCellToolbar } from './notebook-cell-toolbar';\nimport { ContextMenuRenderer } from '@theia/core/lib/browser';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\nexport interface NotebookCellToolbarItem {\n    id: string;\n    icon?: string;\n    label?: string;\n    onClick: (e: React.MouseEvent) => void;\n    isVisible: () => boolean;\n}\n\nexport interface toolbarItemOptions {\n    contextMenuArgs?: () => unknown[];\n    commandArgs?: () => unknown[];\n}\n\n@injectable()\nexport class NotebookCellToolbarFactory {\n\n    @inject(MenuModelRegistry)\n    protected menuRegistry: MenuModelRegistry;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    @inject(ContextMenuRenderer)\n    protected readonly contextMenuRenderer: ContextMenuRenderer;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    protected readonly onDidChangeContextEmitter = new Emitter<void>;\n    readonly onDidChangeContext: Event<void> = this.onDidChangeContextEmitter.event;\n\n    protected toDisposeOnRender = new DisposableCollection();\n\n    renderCellToolbar(menuPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): React.ReactNode {\n        return <NotebookCellToolbar getMenuItems={() => this.getMenuItems(menuPath, cell, itemOptions)}\n            onContextChanged={this.onDidChangeContext} />;\n    }\n\n    renderSidebar(menuPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): React.ReactNode {\n        return <NotebookCellSidebar getMenuItems={() => this.getMenuItems(menuPath, cell, itemOptions)}\n            onContextChanged={this.onDidChangeContext} />;\n    }\n\n    private getMenuItems(menuItemPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): NotebookCellToolbarItem[] {\n        this.toDisposeOnRender.dispose();\n        this.toDisposeOnRender = new DisposableCollection();\n        const inlineItems: NotebookCellToolbarItem[] = [];\n        const menu = this.menuRegistry.getMenu(menuItemPath);\n        if (menu) {\n            for (const menuNode of menu.children) {\n\n                const itemPath = [...menuItemPath, menuNode.id];\n                if (menuNode.isVisible(itemPath, this.notebookContextManager.getCellContext(cell.handle), this.notebookContextManager.context, itemOptions.commandArgs?.() ?? [])) {\n                    if (RenderedMenuNode.is(menuNode)) {\n                        if (menuNode.onDidChange) {\n                            this.toDisposeOnRender.push(menuNode.onDidChange(() => this.onDidChangeContextEmitter.fire()));\n                        }\n                        inlineItems.push(this.createToolbarItem(itemPath, menuNode, itemOptions));\n                    }\n                }\n            }\n        }\n        return inlineItems;\n    }\n\n    private createToolbarItem(menuPath: MenuPath, menuNode: RenderedMenuNode, itemOptions: toolbarItemOptions): NotebookCellToolbarItem {\n        return {\n            id: menuNode.id,\n            icon: menuNode.icon,\n            label: menuNode.label,\n            onClick: e => {\n                if (CompoundMenuNode.is(menuNode)) {\n                    this.contextMenuRenderer.render(\n                        {\n                            anchor: e.nativeEvent,\n                            menuPath: menuPath,\n                            menu: menuNode,\n                            includeAnchorArg: false,\n                            args: itemOptions.contextMenuArgs?.(),\n                            context: this.notebookContextManager.context || (e.currentTarget as HTMLElement)\n                        });\n                } else if (CommandMenu.is(menuNode)) {\n                    menuNode.run(menuPath, ...(itemOptions.commandArgs?.() ?? []));\n                };\n            },\n            isVisible: () => true\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport * as React from '@theia/core/shared/react';\nimport { ACTION_ITEM } from '@theia/core/lib/browser';\nimport { NotebookCellToolbarItem } from './notebook-cell-toolbar-factory';\nimport { DisposableCollection, Event } from '@theia/core';\n\nexport interface NotebookCellToolbarProps {\n    getMenuItems: () => NotebookCellToolbarItem[];\n    onContextChanged: Event<void>;\n}\n\ninterface NotebookCellToolbarState {\n    inlineItems: NotebookCellToolbarItem[];\n}\n\nabstract class NotebookCellActionBar extends React.Component<NotebookCellToolbarProps, NotebookCellToolbarState> {\n\n    protected toDispose = new DisposableCollection();\n\n    constructor(props: NotebookCellToolbarProps) {\n        super(props);\n        this.toDispose.push(props.onContextChanged(e => {\n            const menuItems = this.props.getMenuItems();\n            this.setState({ inlineItems: menuItems });\n        }));\n        this.state = { inlineItems: this.props.getMenuItems() };\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    protected renderItem(item: NotebookCellToolbarItem): React.ReactNode {\n        return <div key={item.id} id={item.id} title={item.label} onClick={item.onClick} className={`${item.icon} ${ACTION_ITEM} theia-notebook-cell-toolbar-item`} />;\n    }\n\n}\n\nexport class NotebookCellToolbar extends NotebookCellActionBar {\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-toolbar'>\n            {this.state.inlineItems.filter(e => e.isVisible()).map(item => this.renderItem(item))}\n        </div>;\n    }\n\n}\n\nexport class NotebookCellSidebar extends NotebookCellActionBar {\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-sidebar-toolbar'>\n            {this.state.inlineItems.filter(e => e.isVisible()).map(item => this.renderItem(item))}\n        </div>;\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport * as React from '@theia/core/shared/react';\nimport { MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { NotebookRendererRegistry } from '../notebook-renderer-registry';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { CellEditor } from './notebook-cell-editor';\nimport { CellRenderer, observeCellHeight } from './notebook-cell-list-view';\nimport { NotebookCellToolbarFactory } from './notebook-cell-toolbar-factory';\nimport { NotebookCellActionContribution, NotebookCellCommands } from '../contributions/notebook-cell-actions-contribution';\nimport { CellExecution, NotebookExecutionStateService } from '../service/notebook-execution-state-service';\nimport { codicon } from '@theia/core/lib/browser';\nimport { NotebookCellExecutionState } from '../../common';\nimport { CancellationToken, CommandRegistry, DisposableCollection, nls } from '@theia/core';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\nimport { NotebookViewportService } from './notebook-viewport-service';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\nimport { NotebookOptionsService } from '../service/notebook-options';\nimport { MarkdownRenderer } from '@theia/core/lib/browser/markdown-rendering/markdown-renderer';\nimport { MarkdownString } from '@theia/monaco-editor-core/esm/vs/base/common/htmlContent';\nimport { NotebookCellEditorService } from '../service/notebook-cell-editor-service';\nimport { CellOutputWebview } from '../renderers/cell-output-webview';\nimport { NotebookCellStatusBarItem, NotebookCellStatusBarItemList, NotebookCellStatusBarService } from '../service/notebook-cell-status-bar-service';\nimport { LabelParser } from '@theia/core/lib/browser/label-parser';\n\n@injectable()\nexport class NotebookCodeCellRenderer implements CellRenderer {\n    @inject(MonacoEditorServices)\n    protected readonly monacoServices: MonacoEditorServices;\n\n    @inject(NotebookRendererRegistry)\n    protected readonly notebookRendererRegistry: NotebookRendererRegistry;\n\n    @inject(NotebookCellToolbarFactory)\n    protected readonly notebookCellToolbarFactory: NotebookCellToolbarFactory;\n\n    @inject(NotebookExecutionStateService)\n    protected readonly executionStateService: NotebookExecutionStateService;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    @inject(NotebookViewportService)\n    protected readonly notebookViewportService: NotebookViewportService;\n\n    @inject(EditorPreferences)\n    protected readonly editorPreferences: EditorPreferences;\n\n    @inject(NotebookCellEditorService)\n    protected readonly notebookCellEditorService: NotebookCellEditorService;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(NotebookOptionsService)\n    protected readonly notebookOptionsService: NotebookOptionsService;\n\n    @inject(MarkdownRenderer)\n    protected readonly markdownRenderer: MarkdownRenderer;\n\n    @inject(CellOutputWebview)\n    protected readonly outputWebview: CellOutputWebview;\n\n    @inject(NotebookCellStatusBarService)\n    protected readonly notebookCellStatusBarService: NotebookCellStatusBarService;\n\n    @inject(LabelParser)\n    protected readonly labelParser: LabelParser;\n\n    render(notebookModel: NotebookModel, cell: NotebookCellModel, handle: number): React.ReactNode {\n        return <div className='theia-notebook-cell-with-sidebar' ref={ref => observeCellHeight(ref, cell)}>\n            <div className='theia-notebook-cell-editor-container'>\n                <CellEditor notebookModel={notebookModel} cell={cell}\n                    monacoServices={this.monacoServices}\n                    notebookContextManager={this.notebookContextManager}\n                    notebookViewportService={this.notebookViewportService}\n                    notebookCellEditorService={this.notebookCellEditorService}\n                    fontInfo={this.notebookOptionsService.editorFontInfo} />\n                <NotebookCodeCellStatus cell={cell} notebook={notebookModel}\n                    commandRegistry={this.commandRegistry}\n                    executionStateService={this.executionStateService}\n                    cellStatusBarService={this.notebookCellStatusBarService}\n                    labelParser={this.labelParser}\n                    onClick={() => cell.requestFocusEditor()} />\n            </div >\n        </div >;\n    }\n\n    renderSidebar(notebookModel: NotebookModel, cell: NotebookCellModel): React.ReactNode {\n        return <div>\n            <NotebookCodeCellSidebar cell={cell} notebook={notebookModel} notebookCellToolbarFactory={this.notebookCellToolbarFactory} />\n            <NotebookCodeCellOutputs cell={cell} notebook={notebookModel} outputWebview={this.outputWebview}\n                renderSidebar={() =>\n                    this.notebookCellToolbarFactory.renderSidebar(NotebookCellActionContribution.OUTPUT_SIDEBAR_MENU, cell, {\n                        contextMenuArgs: () => [notebookModel, cell, cell.outputs[0]]\n                    })\n                } />\n        </div>;\n\n    }\n\n    renderDragImage(cell: NotebookCellModel): HTMLElement {\n        const dragImage = document.createElement('div');\n        dragImage.className = 'theia-notebook-drag-image';\n        dragImage.style.width = this.notebookContextManager.context?.clientWidth + 'px';\n        dragImage.style.height = '100px';\n        dragImage.style.display = 'flex';\n\n        const fakeRunButton = document.createElement('span');\n        fakeRunButton.className = `${codicon('play')} theia-notebook-cell-status-item`;\n        dragImage.appendChild(fakeRunButton);\n\n        const fakeEditor = document.createElement('div');\n        dragImage.appendChild(fakeEditor);\n        const lines = cell.source.split('\\n').slice(0, 5).join('\\n');\n        const codeSequence = this.getMarkdownCodeSequence(lines);\n        const firstLine = new MarkdownString(`${codeSequence}${cell.language}\\n${lines}\\n${codeSequence}`, { supportHtml: true, isTrusted: false });\n        fakeEditor.appendChild(this.markdownRenderer.render(firstLine).element);\n        fakeEditor.classList.add('theia-notebook-cell-editor-container');\n        fakeEditor.style.padding = '10px';\n        return dragImage;\n    }\n\n    protected getMarkdownCodeSequence(input: string): string {\n        // We need a minimum of 3 backticks to start a code block.\n        let longest = 2;\n        let current = 0;\n        for (let i = 0; i < input.length; i++) {\n            const char = input.charAt(i);\n            if (char === '`') {\n                current++;\n                if (current > longest) {\n                    longest = current;\n                }\n            } else {\n                current = 0;\n            }\n        }\n        return Array(longest + 1).fill('`').join('');\n    }\n\n}\n\nexport interface NotebookCodeCellSidebarProps {\n    cell: NotebookCellModel;\n    notebook: NotebookModel;\n    notebookCellToolbarFactory: NotebookCellToolbarFactory\n}\n\nexport class NotebookCodeCellSidebar extends React.Component<NotebookCodeCellSidebarProps> {\n\n    protected toDispose = new DisposableCollection();\n\n    constructor(props: NotebookCodeCellSidebarProps) {\n        super(props);\n\n        this.toDispose.push(props.cell.onDidCellHeightChange(() => this.forceUpdate()));\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-sidebar-actions' style={{ height: `${this.props.cell.cellHeight}px` }}>\n            {this.props.notebookCellToolbarFactory.renderSidebar(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, this.props.cell, {\n                contextMenuArgs: () => [this.props.cell], commandArgs: () => [this.props.notebook, this.props.cell]\n            })\n            }\n            <CodeCellExecutionOrder cell={this.props.cell} />\n        </div>;\n    }\n}\n\nexport interface NotebookCodeCellStatusProps {\n    notebook: NotebookModel;\n    cell: NotebookCellModel;\n    commandRegistry: CommandRegistry;\n    cellStatusBarService: NotebookCellStatusBarService;\n    executionStateService?: NotebookExecutionStateService;\n    labelParser: LabelParser;\n    onClick: () => void;\n}\n\nexport interface NotebookCodeCellStatusState {\n    currentExecution?: CellExecution;\n    executionTime: number;\n}\n\nexport class NotebookCodeCellStatus extends React.Component<NotebookCodeCellStatusProps, NotebookCodeCellStatusState> {\n\n    protected toDispose = new DisposableCollection();\n\n    protected statusBarItems: NotebookCellStatusBarItemList[] = [];\n\n    constructor(props: NotebookCodeCellStatusProps) {\n        super(props);\n\n        this.state = {\n            executionTime: 0\n        };\n\n        let currentInterval: NodeJS.Timeout | undefined;\n        if (props.executionStateService) {\n            this.toDispose.push(props.executionStateService.onDidChangeExecution(event => {\n                if (event.affectsCell(this.props.cell.uri)) {\n                    this.setState({ currentExecution: event.changed, executionTime: 0 });\n                    clearInterval(currentInterval);\n                    if (event.changed?.state === NotebookCellExecutionState.Executing) {\n                        const startTime = Date.now();\n                        // The resolution of the time display is only a single digit after the decimal point.\n                        // Therefore, we only need to update the display every 100ms.\n                        currentInterval = setInterval(() => {\n                            this.setState({\n                                executionTime: Date.now() - startTime\n                            });\n                        }, 100);\n                    }\n                }\n            }));\n        }\n\n        this.toDispose.push(props.cell.onDidChangeLanguage(() => {\n            this.forceUpdate();\n        }));\n\n        this.updateStatusBarItems();\n        this.props.cellStatusBarService.onDidChangeItems(() => this.updateStatusBarItems());\n        this.props.notebook.onContentChanged(() => this.updateStatusBarItems());\n    }\n\n    async updateStatusBarItems(): Promise<void> {\n        this.statusBarItems = await this.props.cellStatusBarService.getStatusBarItemsForCell(\n            this.props.notebook.uri,\n            this.props.notebook.cells.indexOf(this.props.cell),\n            this.props.notebook.viewType,\n            CancellationToken.None);\n        this.forceUpdate();\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return <div className='notebook-cell-status' onClick={() => this.props.onClick()}>\n            <div className='notebook-cell-status-left'>\n                {this.props.executionStateService && this.renderExecutionState()}\n                {this.statusBarItems?.length && this.renderStatusBarItems()}\n            </div>\n            <div className='notebook-cell-status-right'>\n                <span className='notebook-cell-language-label' onClick={() => {\n                    this.props.commandRegistry.executeCommand(NotebookCellCommands.CHANGE_CELL_LANGUAGE.id, this.props.notebook, this.props.cell);\n                }}>{this.props.cell.languageName}</span>\n            </div>\n        </div>;\n    }\n\n    protected renderExecutionState(): React.ReactNode {\n        const state = this.state.currentExecution?.state;\n        const { lastRunSuccess } = this.props.cell.internalMetadata;\n\n        let iconClasses: string | undefined = undefined;\n        let color: string | undefined = undefined;\n        if (!state && lastRunSuccess) {\n            iconClasses = codicon('check');\n            color = 'green';\n        } else if (!state && lastRunSuccess === false) {\n            iconClasses = codicon('error');\n            color = 'red';\n        } else if (state === NotebookCellExecutionState.Pending || state === NotebookCellExecutionState.Unconfirmed) {\n            iconClasses = codicon('clock');\n        } else if (state === NotebookCellExecutionState.Executing) {\n            iconClasses = `${codicon('sync')} theia-animation-spin`;\n        }\n        return <>\n            {iconClasses &&\n                <>\n                    <span className={`${iconClasses} notebook-cell-status-item`} style={{ color }}></span>\n                    <div className='notebook-cell-status-item'>{this.renderTime(this.getExecutionTime())}</div>\n                </>}\n        </>;\n    }\n\n    protected getExecutionTime(): number {\n        const { runStartTime, runEndTime } = this.props.cell.internalMetadata;\n        const { executionTime } = this.state;\n        if (runStartTime !== undefined && runEndTime !== undefined) {\n            return runEndTime - runStartTime;\n        }\n        return executionTime;\n    }\n\n    protected renderTime(ms: number): string {\n        return `${(ms / 1000).toLocaleString(undefined, { maximumFractionDigits: 1, minimumFractionDigits: 1 })}s`;\n    }\n\n    protected renderStatusBarItems(): React.ReactNode {\n        return <>\n            {\n                this.statusBarItems.flatMap((itemList, listIndex) =>\n                    itemList.items.map((item, index) => this.renderStatusBarItem(item, `${listIndex}-${index}`)\n                    )\n                )\n            }\n        </>;\n    }\n\n    protected renderStatusBarItem(item: NotebookCellStatusBarItem, key: string): React.ReactNode {\n        const content = this.props.labelParser.parse(item.text).map(part => {\n            if (typeof part === 'string') {\n                return part;\n            } else {\n                return <span key={part.name} className={`codicon codicon-${part.name}`}></span>;\n            }\n        });\n        return <div key={key} className={`cell-status-bar-item ${item.command ? 'cell-status-item-has-command' : ''}`} onClick={async () => {\n            if (item.command) {\n                if (typeof item.command === 'string') {\n                    this.props.commandRegistry.executeCommand(item.command);\n                } else {\n                    this.props.commandRegistry.executeCommand(item.command.id, ...(item.command.arguments ?? []));\n                }\n            }\n        }}>\n            {content}\n        </div>;\n    }\n\n}\n\ninterface NotebookCellOutputProps {\n    cell: NotebookCellModel;\n    notebook: NotebookModel;\n    outputWebview: CellOutputWebview;\n    renderSidebar: () => React.ReactNode;\n}\n\nexport class NotebookCodeCellOutputs extends React.Component<NotebookCellOutputProps> {\n\n    protected toDispose = new DisposableCollection();\n\n    protected outputHeight: number = 0;\n\n    override async componentDidMount(): Promise<void> {\n        const { cell } = this.props;\n        this.toDispose.push(cell.onDidChangeOutputs(() => this.forceUpdate()));\n        this.toDispose.push(this.props.cell.onDidChangeOutputVisibility(() => this.forceUpdate()));\n        this.toDispose.push(this.props.outputWebview.onDidRenderOutput(event => {\n            if (event.cellHandle === this.props.cell.handle) {\n                this.outputHeight = event.outputHeight;\n                this.forceUpdate();\n            }\n        }));\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        if (!this.props.cell.outputs?.length) {\n            return <></>;\n        }\n        if (this.props.cell.outputVisible) {\n            return <div style={{ minHeight: this.outputHeight }}>\n                {this.props.renderSidebar()}\n            </div>;\n        }\n        return <div className='theia-notebook-collapsed-output-container'><i className='theia-notebook-collapsed-output'>{nls.localizeByDefault('Outputs are collapsed')}</i></div>;\n    }\n\n}\n\ninterface NotebookCellExecutionOrderProps {\n    cell: NotebookCellModel;\n}\n\nfunction CodeCellExecutionOrder({ cell }: NotebookCellExecutionOrderProps): React.JSX.Element {\n    const [executionOrder, setExecutionOrder] = React.useState(cell.internalMetadata.executionOrder ?? ' ');\n\n    React.useEffect(() => {\n        const listener = cell.onDidChangeInternalMetadata(e => {\n            setExecutionOrder(cell.internalMetadata.executionOrder ?? ' ');\n        });\n        return () => listener.dispose();\n    }, []);\n\n    return <span className='theia-notebook-code-cell-execution-order'>{`[${executionOrder}]`}</span>;\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { nls } from '@theia/core';\nimport * as React from '@theia/core/shared/react';\nimport { codicon } from '@theia/core/lib/browser';\nimport debounce = require('@theia/core/shared/lodash.debounce');\n\nexport interface NotebookEditorFindMatch {\n    selected: boolean;\n    show(): void;\n    replace?(value: string): void;\n}\n\nexport interface NotebookEditorFindMatchOptions {\n    search: string;\n    matchCase: boolean;\n    wholeWord: boolean;\n    regex: boolean;\n    activeFilters: string[];\n}\n\nexport interface NotebookEditorFindFilter {\n    id: string;\n    label: string;\n    active: boolean;\n}\n\nexport interface NotebookEditorFindOptions {\n    search?: string;\n    jumpToMatch?: boolean;\n    matchCase?: boolean;\n    wholeWord?: boolean;\n    regex?: boolean;\n    modifyIndex?: (matches: NotebookEditorFindMatch[], index: number) => number;\n}\n\nexport interface NotebookFindWidgetProps {\n    hidden?: boolean;\n    filters?: NotebookEditorFindFilter[];\n    onClose(): void;\n    onSearch(options: NotebookEditorFindMatchOptions): NotebookEditorFindMatch[];\n    onReplace(matches: NotebookEditorFindMatch[], value: string): void;\n}\n\nexport interface NotebookFindWidgetState {\n    search: string;\n    replace: string;\n    expanded: boolean;\n    matchCase: boolean;\n    wholeWord: boolean;\n    regex: boolean;\n    activeFilters: string[];\n    currentMatch: number;\n    matches: NotebookEditorFindMatch[];\n}\n\nexport class NotebookFindWidget extends React.Component<NotebookFindWidgetProps, NotebookFindWidgetState> {\n\n    private searchRef = React.createRef<HTMLInputElement>();\n    private debounceSearch = debounce(this.search.bind(this), 50);\n\n    constructor(props: NotebookFindWidgetProps) {\n        super(props);\n        this.state = {\n            search: '',\n            replace: '',\n            currentMatch: 0,\n            matches: [],\n            expanded: false,\n            matchCase: false,\n            regex: false,\n            wholeWord: false,\n            activeFilters: props.filters?.filter(filter => filter.active).map(filter => filter.id) || []\n        };\n    }\n\n    override render(): React.ReactNode {\n        const hasMatches = this.hasMatches();\n        const canReplace = this.canReplace();\n        const canReplaceAll = this.canReplaceAll();\n        return (\n            <div onKeyUp={event => {\n                if (event.key === 'Escape') {\n                    this.props.onClose();\n                }\n            }} className={`theia-notebook-find-widget ${!this.state.expanded ? 'search-mode' : ''} ${this.props.hidden ? 'hidden' : ''}`}>\n                <div className='theia-notebook-find-widget-expand' title={nls.localizeByDefault('Toggle Replace')} onClick={() => {\n                    this.setState({\n                        expanded: !this.state.expanded\n                    });\n                }}>\n                    <div className={codicon(`chevron-${this.state.expanded ? 'down' : 'right'}`)}></div>\n                </div>\n                <div className='theia-notebook-find-widget-inputs'>\n                    <div className='theia-notebook-find-widget-input-wrapper'>\n                        <input\n                            ref={this.searchRef}\n                            type='text'\n                            className='theia-input theia-notebook-find-widget-input'\n                            placeholder={nls.localizeByDefault('Find')}\n                            value={this.state.search}\n                            onChange={event => {\n                                this.setState({\n                                    search: event.target.value\n                                });\n                                this.debounceSearch({});\n                            }}\n                            onKeyDown={event => {\n                                if (event.key === 'Enter') {\n                                    if (event.shiftKey) {\n                                        this.gotoPreviousMatch();\n                                    } else {\n                                        this.gotoNextMatch();\n                                    }\n                                    event.preventDefault();\n                                }\n                            }}\n                        />\n                        <div\n                            className={`${codicon('case-sensitive', true)} option ${this.state.matchCase ? 'enabled' : ''}`}\n                            title={nls.localizeByDefault('Match Case')}\n                            onClick={() => {\n                                this.search({\n                                    matchCase: !this.state.matchCase\n                                });\n                            }}></div>\n                        <div\n                            className={`${codicon('whole-word', true)} option ${this.state.wholeWord ? 'enabled' : ''}`}\n                            title={nls.localizeByDefault('Match Whole Word')}\n                            onClick={() => {\n                                this.search({\n                                    wholeWord: !this.state.wholeWord\n                                });\n                            }}></div>\n                        <div\n                            className={`${codicon('regex', true)} option ${this.state.regex ? 'enabled' : ''}`}\n                            title={nls.localizeByDefault('Use Regular Expression')}\n                            onClick={() => {\n                                this.search({\n                                    regex: !this.state.regex\n                                });\n                            }}></div>\n                        {/* <div\n                            className={`${codicon('filter', true)} option ${this.state.wholeWord ? 'enabled' : ''}`}\n                            title={nls.localizeByDefault('Find Filters')}></div> */}\n                    </div>\n                    <input\n                        type='text'\n                        className='theia-input theia-notebook-find-widget-replace'\n                        placeholder={nls.localizeByDefault('Replace')}\n                        value={this.state.replace}\n                        onChange={event => {\n                            this.setState({\n                                replace: event.target.value\n                            });\n                        }}\n                        onKeyDown={event => {\n                            if (event.key === 'Enter') {\n                                this.replaceOne();\n                                event.preventDefault();\n                            }\n                        }}\n                    />\n                </div>\n                <div className='theia-notebook-find-widget-buttons'>\n                    <div className='theia-notebook-find-widget-buttons-first'>\n                        <div className='theia-notebook-find-widget-matches-count'>\n                            {this.getMatchesCount()}\n                        </div>\n                        <div\n                            className={`${codicon('arrow-up', hasMatches)} ${hasMatches ? '' : 'disabled'}`}\n                            title={nls.localizeByDefault('Previous Match')}\n                            onClick={() => {\n                                this.gotoPreviousMatch();\n                            }}\n                        ></div>\n                        <div\n                            className={`${codicon('arrow-down', hasMatches)} ${hasMatches ? '' : 'disabled'}`}\n                            title={nls.localizeByDefault('Next Match')}\n                            onClick={() => {\n                                this.gotoNextMatch();\n                            }}\n                        ></div>\n                        <div\n                            className={codicon('close', true)}\n                            title={nls.localizeByDefault('Close')}\n                            onClick={() => {\n                                this.props.onClose();\n                            }}\n                        ></div>\n                    </div>\n                    <div className='theia-notebook-find-widget-buttons-second'>\n                        <div\n                            className={`${codicon('replace', canReplace)} ${canReplace ? '' : 'disabled'}`}\n                            title={nls.localizeByDefault('Replace')}\n                            onClick={() => {\n                                this.replaceOne();\n                            }}\n                        ></div>\n                        <div\n                            className={`${codicon('replace-all', canReplaceAll)} ${canReplaceAll ? '' : 'disabled'}`}\n                            title={nls.localizeByDefault('Replace All')}\n                            onClick={() => {\n                                this.replaceAll();\n                            }}\n                        ></div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    private hasMatches(): boolean {\n        return this.state.matches.length > 0;\n    }\n\n    private canReplace(): boolean {\n        return Boolean(this.state.matches[this.state.currentMatch]?.replace);\n    }\n\n    private canReplaceAll(): boolean {\n        return this.state.matches.some(match => Boolean(match.replace));\n    }\n\n    private getMatchesCount(): string {\n        if (this.hasMatches()) {\n            return nls.localizeByDefault('{0} of {1}', this.state.currentMatch + 1, this.state.matches.length);\n        } else {\n            return nls.localizeByDefault('No results');\n        }\n    }\n\n    private gotoNextMatch(): void {\n        this.search({\n            modifyIndex: (matches, index) => (index + 1) % matches.length,\n            jumpToMatch: true\n        });\n    }\n\n    private gotoPreviousMatch(): void {\n        this.search({\n            modifyIndex: (matches, index) => (index === 0 ? matches.length : index) - 1,\n            jumpToMatch: true\n        });\n    }\n\n    private replaceOne(): void {\n        const existingMatches = this.state.matches;\n        const match = existingMatches[this.state.currentMatch];\n        if (match) {\n            match.replace?.(this.state.replace);\n            this.search({\n                jumpToMatch: true,\n                modifyIndex: (matches, index) => {\n                    if (matches.length < existingMatches.length) {\n                        return index % matches.length;\n                    } else {\n                        const diff = matches.length - existingMatches.length;\n                        return (index + diff + 1) % matches.length;\n                    }\n                }\n            });\n        }\n    }\n\n    private replaceAll(): void {\n        this.props.onReplace(this.state.matches, this.state.replace);\n        this.search({});\n    }\n\n    override componentDidUpdate(prevProps: Readonly<NotebookFindWidgetProps>, prevState: Readonly<NotebookFindWidgetState>): void {\n        if (!this.props.hidden && prevProps.hidden) {\n            // Focus the search input when the widget switches from hidden to visible.\n            this.searchRef.current?.focus();\n        }\n    }\n\n    focusSearch(content?: string): void {\n        this.searchRef.current?.focus();\n        if (content) {\n            this.search({\n                search: content,\n                jumpToMatch: false\n            });\n        }\n    }\n\n    search(options: NotebookEditorFindOptions): void {\n        const matchCase = options.matchCase ?? this.state.matchCase;\n        const wholeWord = options.wholeWord ?? this.state.wholeWord;\n        const regex = options.regex ?? this.state.regex;\n        const search = options.search ?? this.state.search;\n        const matches = this.props.onSearch({\n            search,\n            matchCase,\n            wholeWord,\n            regex,\n            activeFilters: this.state.activeFilters\n        });\n        let currentMatch = Math.max(0, Math.min(this.state.currentMatch, matches.length - 1));\n        if (options.modifyIndex && matches.length > 0) {\n            currentMatch = options.modifyIndex(matches, currentMatch);\n        }\n        const selectedMatch = matches[currentMatch];\n        if (selectedMatch) {\n            selectedMatch.selected = true;\n            if (options.jumpToMatch) {\n                selectedMatch.show();\n            }\n        }\n        this.setState({\n            search,\n            matches,\n            currentMatch,\n            matchCase,\n            wholeWord,\n            regex\n        });\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { ArrayUtils, CommandMenu, CommandRegistry, DisposableCollection, Group, GroupImpl, MenuModelRegistry, MenuNode, MenuPath, nls } from '@theia/core';\nimport * as React from '@theia/core/shared/react';\nimport { codicon, ContextMenuRenderer } from '@theia/core/lib/browser';\nimport { NotebookCommands, NotebookMenus } from '../contributions/notebook-actions-contribution';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookKernelService } from '../service/notebook-kernel-service';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\nexport interface NotebookMainToolbarProps {\n    notebookModel: NotebookModel\n    menuRegistry: MenuModelRegistry;\n    notebookKernelService: NotebookKernelService;\n    commandRegistry: CommandRegistry;\n    contextKeyService: ContextKeyService;\n    editorNode: HTMLElement;\n    notebookContextManager: NotebookContextManager;\n    contextMenuRenderer: ContextMenuRenderer;\n}\n\n@injectable()\nexport class NotebookMainToolbarRenderer {\n    @inject(NotebookKernelService) protected readonly notebookKernelService: NotebookKernelService;\n    @inject(CommandRegistry) protected readonly commandRegistry: CommandRegistry;\n    @inject(MenuModelRegistry) protected readonly menuRegistry: MenuModelRegistry;\n    @inject(ContextKeyService) protected readonly contextKeyService: ContextKeyService;\n    @inject(NotebookContextManager) protected readonly notebookContextManager: NotebookContextManager;\n    @inject(ContextMenuRenderer) protected readonly contextMenuRenderer: ContextMenuRenderer;\n\n    render(notebookModel: NotebookModel, editorNode: HTMLElement): React.ReactNode {\n        return <NotebookMainToolbar notebookModel={notebookModel}\n            menuRegistry={this.menuRegistry}\n            notebookKernelService={this.notebookKernelService}\n            commandRegistry={this.commandRegistry}\n            contextKeyService={this.contextKeyService}\n            editorNode={editorNode}\n            notebookContextManager={this.notebookContextManager}\n            contextMenuRenderer={this.contextMenuRenderer} />;\n    }\n}\n\ninterface NotebookMainToolbarState {\n    selectedKernelLabel?: string;\n    numberOfHiddenItems: number;\n}\n\nexport class NotebookMainToolbar extends React.Component<NotebookMainToolbarProps, NotebookMainToolbarState> {\n\n    // The minimum area between items and kernel select before hiding items in a context menu\n    static readonly MIN_FREE_AREA = 10;\n\n    protected toDispose = new DisposableCollection();\n\n    protected nativeSubmenus = [\n        NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP[NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP.length - 1],\n        NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP[NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP.length - 1]];\n\n    protected gapElement: HTMLDivElement | undefined;\n    protected lastGapElementWidth: number = 0;\n\n    protected resizeObserver: ResizeObserver = new ResizeObserver(() => this.calculateItemsToHide());\n\n    constructor(props: NotebookMainToolbarProps) {\n        super(props);\n\n        this.state = {\n            selectedKernelLabel: props.notebookKernelService.getSelectedOrSuggestedKernel(props.notebookModel)?.label,\n            numberOfHiddenItems: 0,\n        };\n        this.toDispose.push(props.notebookKernelService.onDidChangeSelectedKernel(event => {\n            if (props.notebookModel.uri.isEqual(event.notebook)) {\n                this.setState({ selectedKernelLabel: props.notebookKernelService.getKernel(event.newKernel ?? '')?.label });\n            }\n        }));\n        // in case the selected kernel is added after the notebook is loaded\n        this.toDispose.push(props.notebookKernelService.onDidAddKernel(() => {\n            if (!this.state.selectedKernelLabel) {\n                this.setState({ selectedKernelLabel: props.notebookKernelService.getSelectedOrSuggestedKernel(props.notebookModel)?.label });\n            }\n        }));\n\n        // TODO maybe we need a mechanism to check for changes in the menu to update this toolbar\n        const menuItems = this.getMenuItems();\n        for (const item of menuItems) {\n            if (item.onDidChange) {\n                item.onDidChange(() => this.forceUpdate());\n            }\n        }\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override componentDidUpdate(): void {\n        this.calculateItemsToHide();\n    }\n\n    override componentDidMount(): void {\n        this.calculateItemsToHide();\n    }\n\n    protected calculateItemsToHide(): void {\n        const numberOfMenuItems = this.getMenuItems().length;\n        if (this.gapElement && this.gapElement.getBoundingClientRect().width < NotebookMainToolbar.MIN_FREE_AREA && this.state.numberOfHiddenItems < numberOfMenuItems) {\n            this.setState({ ...this.state, numberOfHiddenItems: this.state.numberOfHiddenItems + 1 });\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n        } else if (this.gapElement && this.gapElement.getBoundingClientRect().width > this.lastGapElementWidth && this.state.numberOfHiddenItems > 0) {\n            this.setState({ ...this.state, numberOfHiddenItems: 0 });\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n        }\n    }\n\n    protected renderContextMenu(event: MouseEvent, menuItems: readonly MenuNode[]): void {\n        const hiddenItems = menuItems.slice(menuItems.length - this.calculateNumberOfHiddenItems(menuItems));\n\n        const menu = new GroupImpl(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU[0]);\n\n        hiddenItems.forEach(item => menu.addNode(item));\n\n        this.props.contextMenuRenderer.render({\n            anchor: event,\n            menuPath: NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU,\n            menu: menu,\n            contextKeyService: this.props.contextKeyService,\n            context: this.props.editorNode,\n            args: [this.props.notebookModel.uri]\n        });\n    }\n\n    override render(): React.ReactNode {\n        const menuItems = this.getMenuItems();\n        return <div className='theia-notebook-main-toolbar' id='notebook-main-toolbar'>\n            {menuItems.slice(0, menuItems.length - this.calculateNumberOfHiddenItems(menuItems)).map(item => this.renderMenuItem(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR, item))}\n            {\n                this.state.numberOfHiddenItems > 0 &&\n                <span className={`${codicon('ellipsis')} action-label theia-notebook-main-toolbar-item`} onClick={e => this.renderContextMenu(e.nativeEvent, menuItems)} />\n            }\n            <div ref={element => this.gapElementChanged(element)} style={{ flexGrow: 1 }}></div>\n            <div className='theia-notebook-main-toolbar-item action-label' id={NotebookCommands.SELECT_KERNEL_COMMAND.id}\n                onClick={() => this.props.commandRegistry.executeCommand(NotebookCommands.SELECT_KERNEL_COMMAND.id, this.props.notebookModel)}>\n                <span className={codicon('server-environment')} />\n                <span className=' theia-notebook-main-toolbar-item-text' id='kernel-text'>\n                    {this.state.selectedKernelLabel ?? nls.localizeByDefault('Select Kernel')}\n                </span>\n            </div>\n        </div >;\n    }\n\n    protected gapElementChanged(element: HTMLDivElement | null): void {\n        if (this.gapElement) {\n            this.resizeObserver.unobserve(this.gapElement);\n        }\n        this.gapElement = element ?? undefined;\n        if (this.gapElement) {\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n            this.resizeObserver.observe(this.gapElement);\n        }\n    }\n\n    protected renderMenuItem<T>(itemPath: MenuPath, item: MenuNode, submenu?: string): React.ReactNode {\n        if (Group.is(item)) {\n            const itemNodes = ArrayUtils.coalesce(item.children?.map(child => this.renderMenuItem([...itemPath, child.id], child, item.id)) ?? []);\n            return <React.Fragment key={item.id}>\n                {itemNodes}\n                {itemNodes && itemNodes.length > 0 && <span key={`${item.id}-separator`} className='theia-notebook-toolbar-separator'></span>}\n            </React.Fragment>;\n        } else if (CommandMenu.is(item) && ((this.nativeSubmenus.includes(submenu ?? '')) || item.isVisible(itemPath, this.props.contextKeyService, this.props.editorNode))) {\n            return <div key={item.id} id={item.id} title={item.label} className={`theia-notebook-main-toolbar-item action-label${this.getAdditionalClasses(itemPath, item)}`}\n                onClick={() => {\n                    item.run(itemPath, this.props.notebookModel.uri);\n                }}>\n                <span className={item.icon} />\n                <span className='theia-notebook-main-toolbar-item-text'>{item.label}</span>\n            </div>;\n        }\n        return undefined;\n    }\n\n    protected getMenuItems(): readonly MenuNode[] {\n        return this.props.menuRegistry.getMenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR)!.children; // we contribute to this menu, so it exists\n    }\n\n    protected getAdditionalClasses(itemPath: MenuPath, item: CommandMenu): string {\n        return item.isEnabled(itemPath, this.props.editorNode) ? '' : ' theia-mod-disabled';\n    }\n\n    protected calculateNumberOfHiddenItems(allMenuItems: readonly MenuNode[]): number {\n        return this.state.numberOfHiddenItems >= allMenuItems.length ?\n            allMenuItems.length :\n            this.state.numberOfHiddenItems % allMenuItems.length;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { MarkdownRenderer } from '@theia/core/lib/browser/markdown-rendering/markdown-renderer';\nimport { MarkdownStringImpl } from '@theia/core/lib/common/markdown-rendering/markdown-string';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { CellRenderer, observeCellHeight } from './notebook-cell-list-view';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { CellEditor } from './notebook-cell-editor';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { CommandRegistry, nls } from '@theia/core';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\nimport { NotebookOptionsService } from '../service/notebook-options';\nimport { NotebookCodeCellStatus } from './notebook-code-cell-view';\nimport { NotebookEditorFindMatch, NotebookEditorFindMatchOptions } from './notebook-find-widget';\nimport * as mark from 'advanced-mark.js';\nimport { NotebookCellEditorService } from '../service/notebook-cell-editor-service';\nimport { NotebookCellStatusBarService } from '../service/notebook-cell-status-bar-service';\nimport { LabelParser } from '@theia/core/lib/browser/label-parser';\n\n@injectable()\nexport class NotebookMarkdownCellRenderer implements CellRenderer {\n\n    @inject(MarkdownRenderer)\n    private readonly markdownRenderer: MarkdownRenderer;\n    @inject(MonacoEditorServices)\n    protected readonly monacoServices: MonacoEditorServices;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(NotebookOptionsService)\n    protected readonly notebookOptionsService: NotebookOptionsService;\n\n    @inject(NotebookCellEditorService)\n    protected readonly notebookCellEditorService: NotebookCellEditorService;\n\n    @inject(NotebookCellStatusBarService)\n    protected readonly notebookCellStatusBarService: NotebookCellStatusBarService;\n\n    @inject(LabelParser)\n    protected readonly labelParser: LabelParser;\n\n    render(notebookModel: NotebookModel, cell: NotebookCellModel): React.ReactNode {\n        return <MarkdownCell\n            markdownRenderer={this.markdownRenderer}\n            commandRegistry={this.commandRegistry}\n            monacoServices={this.monacoServices}\n            notebookOptionsService={this.notebookOptionsService}\n            cell={cell}\n            notebookModel={notebookModel}\n            notebookContextManager={this.notebookContextManager}\n            notebookCellEditorService={this.notebookCellEditorService}\n            notebookCellStatusBarService={this.notebookCellStatusBarService}\n            labelParser={this.labelParser}\n        />;\n    }\n\n    renderSidebar(notebookModel: NotebookModel, cell: NotebookCellModel): React.ReactNode {\n        return <div className='theia-notebook-markdown-sidebar'></div>;\n    }\n\n    renderDragImage(cell: NotebookCellModel): HTMLElement {\n        const dragImage = document.createElement('div');\n        dragImage.style.width = this.notebookContextManager.context?.clientWidth + 'px';\n        const markdownString = new MarkdownStringImpl(cell.source, { supportHtml: true, isTrusted: true });\n        const markdownElement = this.markdownRenderer.render(markdownString).element;\n        dragImage.appendChild(markdownElement);\n        return dragImage;\n    }\n}\n\ninterface MarkdownCellProps {\n    markdownRenderer: MarkdownRenderer;\n    monacoServices: MonacoEditorServices;\n\n    commandRegistry: CommandRegistry;\n    cell: NotebookCellModel;\n    notebookModel: NotebookModel;\n    notebookContextManager: NotebookContextManager;\n    notebookOptionsService: NotebookOptionsService;\n    notebookCellEditorService: NotebookCellEditorService;\n    notebookCellStatusBarService: NotebookCellStatusBarService;\n    labelParser: LabelParser;\n}\n\nfunction MarkdownCell({\n    markdownRenderer, monacoServices, cell, notebookModel, notebookContextManager,\n    notebookOptionsService, commandRegistry, notebookCellEditorService, notebookCellStatusBarService,\n    labelParser\n}: MarkdownCellProps): React.JSX.Element {\n    const [editMode, setEditMode] = React.useState(cell.editing);\n    let empty = false;\n\n    React.useEffect(() => {\n        const listener = cell.onDidRequestCellEditChange(cellEdit => setEditMode(cellEdit));\n        return () => listener.dispose();\n    }, [editMode]);\n\n    React.useEffect(() => {\n        if (!editMode) {\n            const instance = new mark(markdownContent);\n            cell.onMarkdownFind = options => {\n                instance.unmark();\n                if (empty) {\n                    return [];\n                }\n                return searchInMarkdown(instance, options);\n            };\n            return () => {\n                cell.onMarkdownFind = undefined;\n                instance.unmark();\n            };\n        }\n    }, [editMode, cell.source]);\n\n    let markdownContent: HTMLElement[] = React.useMemo(() => {\n        const markdownString = new MarkdownStringImpl(cell.source, { supportHtml: true, isTrusted: true });\n        const rendered = markdownRenderer.render(markdownString).element;\n        const children: HTMLElement[] = [];\n        rendered.childNodes.forEach(child => {\n            if (child instanceof HTMLElement) {\n                children.push(child);\n            }\n        });\n        return children;\n    }, [cell.source]);\n\n    if (markdownContent.length === 0) {\n        const italic = document.createElement('i');\n        italic.className = 'theia-notebook-empty-markdown';\n        italic.innerText = nls.localizeByDefault('Empty markdown cell, double-click or press enter to edit.');\n        italic.style.pointerEvents = 'none';\n        markdownContent = [italic];\n        empty = true;\n    }\n\n    return editMode ?\n        (<div className='theia-notebook-markdown-editor-container' key=\"code\" ref={ref => observeCellHeight(ref, cell)}>\n            <CellEditor notebookModel={notebookModel} cell={cell}\n                monacoServices={monacoServices}\n                notebookContextManager={notebookContextManager}\n                notebookCellEditorService={notebookCellEditorService}\n                fontInfo={notebookOptionsService.editorFontInfo} />\n            <NotebookCodeCellStatus cell={cell} notebook={notebookModel}\n                commandRegistry={commandRegistry}\n                cellStatusBarService={notebookCellStatusBarService}\n                labelParser={labelParser}\n                onClick={() => cell.requestFocusEditor()} />\n        </div >) :\n        (<div className='theia-notebook-markdown-content' key=\"markdown\"\n            onDoubleClick={() => cell.requestEdit()}\n            ref={node => {\n                node?.replaceChildren(...markdownContent);\n                observeCellHeight(node, cell);\n            }}\n        />);\n}\n\nfunction searchInMarkdown(instance: mark, options: NotebookEditorFindMatchOptions): NotebookEditorFindMatch[] {\n    const matches: NotebookEditorFindMatch[] = [];\n    const markOptions: mark.MarkOptions & mark.RegExpOptions = {\n        className: 'theia-find-match',\n        diacritics: false,\n        caseSensitive: options.matchCase,\n        acrossElements: true,\n        separateWordSearch: false,\n        each: node => {\n            matches.push(new MarkdownEditorFindMatch(node));\n        }\n    };\n    if (options.regex || options.wholeWord) {\n        let search = options.search;\n        if (options.wholeWord) {\n            if (!options.regex) {\n                search = escapeRegExp(search);\n            }\n            search = '\\\\b' + search + '\\\\b';\n        }\n        instance.markRegExp(new RegExp(search, options.matchCase ? '' : 'i'), markOptions);\n    } else {\n        instance.mark(options.search, markOptions);\n    }\n    return matches;\n}\n\nfunction escapeRegExp(value: string): string {\n    return value.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n\nclass MarkdownEditorFindMatch implements NotebookEditorFindMatch {\n\n    constructor(readonly node: Node) { }\n\n    private _selected = false;\n\n    get selected(): boolean {\n        return this._selected;\n    }\n\n    set selected(selected: boolean) {\n        this._selected = selected;\n        const className = 'theia-find-match-selected';\n        if (this.node instanceof HTMLElement) {\n            if (selected) {\n                this.node.classList.add(className);\n            } else {\n                this.node.classList.remove(className);\n            }\n        }\n    }\n\n    show(): void {\n        if (this.node instanceof HTMLElement) {\n            this.node.scrollIntoView({\n                behavior: 'instant',\n                block: 'center'\n            });\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable } from '@theia/core';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { Emitter } from '@theia/core/shared/vscode-languageserver-protocol';\n\n/**\n * this service is for managing the viewport and scroll state of a notebook editor.\n * its used both for restoring scroll state after reopening an editor and for cell to check if they are in the viewport.\n */\n@injectable()\nexport class NotebookViewportService implements Disposable {\n\n    protected onDidChangeViewportEmitter = new Emitter<void>();\n    readonly onDidChangeViewport = this.onDidChangeViewportEmitter.event;\n\n    protected _viewportElement: HTMLDivElement | undefined;\n\n    protected resizeObserver?: ResizeObserver;\n\n    set viewportElement(element: HTMLDivElement | undefined) {\n        this._viewportElement = element;\n        if (element) {\n            this.onDidChangeViewportEmitter.fire();\n            this.resizeObserver?.disconnect();\n            this.resizeObserver = new ResizeObserver(() => this.onDidChangeViewportEmitter.fire());\n            this.resizeObserver.observe(element);\n        }\n    }\n\n    isElementInViewport(element: HTMLElement): boolean {\n        if (this._viewportElement) {\n            const rect = element.getBoundingClientRect();\n            const viewRect = this._viewportElement.getBoundingClientRect();\n            return rect.top < viewRect.top ? rect.bottom > viewRect.top : rect.top < viewRect.bottom;\n        }\n        return false;\n    }\n\n    onScroll(e: HTMLDivElement): void {\n        this.onDidChangeViewportEmitter.fire();\n    }\n\n    dispose(): void {\n        this.resizeObserver?.disconnect();\n    }\n}\n","/*!***************************************************\n* advanced-mark.js v2.7.0\n* https://github.com/angezid/advanced-mark.js\n* MIT licensed\n* Copyright (c) 2022–2025, angezid\n* Based on 'mark.js', license https://git.io/vwTVl\n*****************************************************/\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Mark = factory());\n})(this, (function () { 'use strict';\n\n  function _typeof(o) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n      return typeof o;\n    } : function (o) {\n      return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n    }, _typeof(o);\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n  function _extends() {\n    _extends = Object.assign ? Object.assign.bind() : function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    };\n    return _extends.apply(this, arguments);\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== \"object\" || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || \"default\");\n      if (typeof res !== \"object\") return res;\n      throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n    }\n    return (hint === \"string\" ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, \"string\");\n    return typeof key === \"symbol\" ? key : String(key);\n  }\n\n  var DOMIterator = /*#__PURE__*/function () {\n    function DOMIterator(ctx, opt) {\n      _classCallCheck(this, DOMIterator);\n      this.ctx = ctx;\n      this.opt = opt;\n      this.map = [];\n    }\n    _createClass(DOMIterator, [{\n      key: \"getContexts\",\n      value: function getContexts() {\n        var ctx = this.ctx,\n          win = this.opt.window,\n          sort = false;\n        if (!ctx) return [];\n        if (Array.isArray(ctx)) {\n          sort = true;\n        } else if (typeof ctx === 'string') {\n          ctx = this.toArray(win.document.querySelectorAll(ctx));\n        } else if (ctx.length >= 0) {\n          ctx = this.toArray(ctx);\n        } else {\n          ctx = [ctx];\n        }\n        var array = [];\n        ctx.forEach(function (elem) {\n          if (array.indexOf(elem) === -1 && !array.some(function (node) {\n            return node.contains(elem);\n          })) {\n            array.push(elem);\n          }\n        });\n        if (sort) {\n          array.sort(function (a, b) {\n            return (a.compareDocumentPosition(b) & win.Node.DOCUMENT_POSITION_FOLLOWING) > 0 ? -1 : 1;\n          });\n        }\n        return array;\n      }\n    }, {\n      key: \"toArray\",\n      value: function toArray(collection) {\n        var array = [];\n        for (var i = 0; i < collection.length; i++) {\n          array.push(collection[i]);\n        }\n        return array;\n      }\n    }, {\n      key: \"getIframeContents\",\n      value: function getIframeContents(iframe, successFn, errorFn) {\n        try {\n          var doc = iframe.contentWindow.document;\n          if (doc) {\n            this.map.push([iframe, 'ready']);\n            successFn({\n              iframe: iframe,\n              context: doc\n            });\n          }\n        } catch (e) {\n          errorFn({\n            iframe: iframe,\n            error: e\n          });\n        }\n      }\n    }, {\n      key: \"observeIframeLoad\",\n      value: function observeIframeLoad(ifr, successFn, errorFn) {\n        var _this = this;\n        if (this.map.some(function (arr) {\n          return arr[0] === ifr;\n        })) {\n          return;\n        }\n        var id = null;\n        var listener = function listener() {\n          clearTimeout(id);\n          ifr.removeEventListener('load', listener);\n          _this.getIframeContents(ifr, successFn, errorFn);\n        };\n        ifr.addEventListener('load', listener);\n        this.map.push([ifr, true]);\n        id = setTimeout(listener, this.opt.iframesTimeout);\n      }\n    }, {\n      key: \"onIframeReady\",\n      value: function onIframeReady(ifr, successFn, errorFn) {\n        try {\n          var bl = 'about:blank',\n            src = ifr.getAttribute('src'),\n            win = ifr.contentWindow;\n          if (win.document.readyState === 'complete') {\n            if (src && src.trim() !== bl && win.location.href === bl) {\n              this.observeIframeLoad(ifr, successFn, errorFn);\n            } else {\n              this.getIframeContents(ifr, successFn, errorFn);\n            }\n          } else {\n            this.observeIframeLoad(ifr, successFn, errorFn);\n          }\n        } catch (e) {\n          errorFn(e);\n        }\n      }\n    }, {\n      key: \"waitForIframes\",\n      value: function waitForIframes(ctx, doneCb) {\n        var _this2 = this;\n        var shadow = this.opt.shadowDOM;\n        var count = 0,\n          iframes = 0,\n          array,\n          node;\n        var collect = function collect(context) {\n          var iterator = _this2.createIterator(context, _this2.opt.window.NodeFilter.SHOW_ELEMENT);\n          while (node = iterator.nextNode()) {\n            if (_this2.isIframe(node) && !_this2.map.some(function (arr) {\n              return arr[0] === node;\n            })) {\n              array.push(node);\n              iframes++;\n            }\n            if (shadow && node.shadowRoot && node.shadowRoot.mode === 'open') {\n              collect(node.shadowRoot);\n            }\n          }\n        };\n        var loop = function loop(obj) {\n          array = [];\n          if (!obj.iframe || obj.context.location.href !== 'about:blank') {\n            collect(obj.context);\n            if (!obj.iframe && !array.length) {\n              doneCb();\n              return;\n            }\n          }\n          if (array.length) {\n            array.forEach(function (iframe) {\n              _this2.onIframeReady(iframe, function (obj) {\n                count++;\n                loop(obj);\n              }, function (obj) {\n                if (_this2.opt.debug) {\n                  console.log(obj.error || obj);\n                }\n                if (++count === iframes) doneCb();\n              });\n            });\n          } else if (count === iframes) {\n            doneCb();\n          }\n        };\n        loop({\n          context: ctx\n        });\n      }\n    }, {\n      key: \"createIterator\",\n      value: function createIterator(ctx, whatToShow) {\n        var win = this.opt.window;\n        return win.document.createNodeIterator(ctx, whatToShow, function () {\n          return win.NodeFilter.FILTER_ACCEPT;\n        }, false);\n      }\n    }, {\n      key: \"addRemoveStyle\",\n      value: function addRemoveStyle(root, style, add) {\n        if (add && !style) return;\n        var elem = root.querySelector('style[data-markjs]');\n        if (add) {\n          if (!elem) {\n            elem = this.opt.window.document.createElement('style');\n            elem.setAttribute('data-markjs', 'true');\n            root.appendChild(elem);\n          }\n          elem.textContent = style;\n        } else if (elem) {\n          root.removeChild(elem);\n        }\n      }\n    }, {\n      key: \"isIframe\",\n      value: function isIframe(node) {\n        return node.tagName === 'IFRAME' && !DOMIterator.matches(node, this.opt.exclude);\n      }\n    }, {\n      key: \"iterateThroughNodes\",\n      value: function iterateThroughNodes(ctx, whatToShow, filterCb, eachCb, doneCb) {\n        var _this3 = this;\n        var filter = this.opt.window.NodeFilter,\n          shadow = this.opt.shadowDOM,\n          iframe = this.opt.iframes;\n        if (iframe || shadow) {\n          var showElement = (whatToShow & filter.SHOW_ELEMENT) > 0,\n            showText = (whatToShow & filter.SHOW_TEXT) > 0;\n          var traverse = function traverse(node) {\n            var iterator = _this3.createIterator(node, whatToShow | filter.SHOW_ELEMENT),\n              root;\n            while (node = iterator.nextNode()) {\n              if (node.nodeType === 1) {\n                if (showElement && filterCb(node)) {\n                  eachCb(node);\n                }\n                if (iframe && _this3.isIframe(node) && _this3.map.some(function (arr) {\n                  return arr[0] === node && arr[1] === 'ready';\n                })) {\n                  var doc = node.contentWindow.document;\n                  if (doc) traverse(doc);\n                }\n                if (shadow && (root = node.shadowRoot) && root.mode === 'open') {\n                  _this3.addRemoveStyle(root, shadow.style, showText);\n                  traverse(root);\n                }\n              } else if (showText && node.nodeType === 3 && filterCb(node)) {\n                eachCb(node);\n              }\n            }\n          };\n          traverse(ctx);\n        } else {\n          var iterator = this.createIterator(ctx, whatToShow);\n          var node;\n          while (node = iterator.nextNode()) {\n            if (filterCb(node)) {\n              eachCb(node);\n            }\n          }\n        }\n        doneCb();\n      }\n    }, {\n      key: \"forEachNode\",\n      value: function forEachNode(whatToShow, each, filter) {\n        var _this4 = this;\n        var done = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function () {};\n        var contexts = this.getContexts();\n        var open = contexts.length;\n        if (!open) done();\n        var ready = function ready() {\n          contexts.forEach(function (ctx) {\n            _this4.iterateThroughNodes(ctx, whatToShow, filter, each, function () {\n              if (--open <= 0) done();\n            });\n          });\n        };\n        if (this.opt.iframes) {\n          var count = open,\n            fired = false;\n          var id = setTimeout(function () {\n            fired = true;\n            ready();\n          }, this.opt.iframesTimeout);\n          var finish = function finish() {\n            clearTimeout(id);\n            if (!fired) ready();\n          };\n          contexts.forEach(function (ctx) {\n            _this4.waitForIframes(ctx, function () {\n              if (--count <= 0) finish();\n            });\n          });\n        } else {\n          ready();\n        }\n      }\n    }], [{\n      key: \"matches\",\n      value: function matches(element, selector) {\n        if (!selector || !selector.length) {\n          return false;\n        }\n        var selectors = typeof selector === 'string' ? [selector] : selector;\n        var fn = element.matches || element.matchesSelector || element.msMatchesSelector || element.mozMatchesSelector || element.oMatchesSelector || element.webkitMatchesSelector;\n        return fn && selectors.some(function (sel) {\n          return fn.call(element, sel);\n        });\n      }\n    }]);\n    return DOMIterator;\n  }();\n\n  var RegExpCreator = /*#__PURE__*/function () {\n    function RegExpCreator(options) {\n      _classCallCheck(this, RegExpCreator);\n      this.opt = _extends({}, {\n        'diacritics': true,\n        'synonyms': {},\n        'accuracy': 'partially',\n        'caseSensitive': false,\n        'ignoreJoiners': false,\n        'ignorePunctuation': [],\n        'wildcards': 'disabled'\n      }, options);\n    }\n    _createClass(RegExpCreator, [{\n      key: \"chars\",\n      get: function get() {\n        var _this = this;\n        if (!this._chars) {\n          this._chars = [];\n          ['aàáảãạăằắẳẵặâầấẩẫậäåāą', 'cçćč', 'dđď', 'eèéẻẽẹêềếểễệëěēę', 'iìíỉĩịîïī', 'lł', 'nñňń', 'oòóỏõọôồốổỗộơởỡớờợöøōő', 'rř', 'sšśșş', 'tťțţ', 'uùúủũụưừứửữựûüůūű', 'yýỳỷỹỵÿ', 'zžżź'].forEach(function (str) {\n            _this._chars.push(str, str.toUpperCase());\n          });\n        }\n        return this._chars;\n      }\n    }, {\n      key: \"create\",\n      value: function create(str, patterns) {\n        var flags = 'g' + (this.opt.caseSensitive ? '' : 'i');\n        str = this.checkWildcardsEscape(str);\n        str = this.createSynonyms(str, flags);\n        var joiners = this.getJoinersPunctuation();\n        if (joiners) {\n          str = this.setupIgnoreJoiners(str);\n        }\n        if (this.opt.diacritics) {\n          str = this.createDiacritics(str);\n        }\n        str = str.replace(/\\s+/g, '[\\\\s]+');\n        if (joiners) {\n          str = this.createJoiners(str, joiners);\n        }\n        if (this.opt.wildcards !== 'disabled') {\n          str = this.createWildcards(str);\n        }\n        var obj = this.createAccuracy(str);\n        return patterns ? obj : new RegExp(\"\".concat(obj.lookbehind, \"(\").concat(obj.pattern, \")\").concat(obj.lookahead), flags);\n      }\n    }, {\n      key: \"createCombinePattern\",\n      value: function createCombinePattern(array, capture) {\n        var _this2 = this;\n        if (!Array.isArray(array) || !array.length) {\n          return null;\n        }\n        var group = capture ? '(' : '(?:',\n          obj = this.create(array[0], true);\n        obj.pattern = this.distinct(array.map(function (str) {\n          return \"\".concat(group).concat(_this2.create(str, true).pattern, \")\");\n        })).join('|');\n        return obj;\n      }\n    }, {\n      key: \"sortByLength\",\n      value: function sortByLength(arry) {\n        return arry.sort(function (a, b) {\n          return a.length === b.length ? a > b ? 1 : -1 : b.length - a.length;\n        });\n      }\n    }, {\n      key: \"escape\",\n      value: function escape(str) {\n        return str.replace(/[[\\]/{}()*+?.\\\\^$|]/g, '\\\\$&');\n      }\n    }, {\n      key: \"preprocess\",\n      value: function preprocess(val) {\n        if (val && val.length) {\n          return this.distinct(typeof val === 'string' ? val.split('') : val).join('').replace(/[-^\\]\\\\]/g, '\\\\$&');\n        }\n        return '';\n      }\n    }, {\n      key: \"distinct\",\n      value: function distinct(array) {\n        var result = [];\n        array.forEach(function (item) {\n          if (item.trim() && result.indexOf(item) === -1) {\n            result.push(item);\n          }\n        });\n        return result;\n      }\n    }, {\n      key: \"createSynonyms\",\n      value: function createSynonyms(str, flags) {\n        var _this3 = this;\n        var syn = this.opt.synonyms;\n        if (!Object.keys(syn).length) {\n          return str;\n        }\n        for (var key in syn) {\n          if (syn.hasOwnProperty(key)) {\n            var array = Array.isArray(syn[key]) ? syn[key] : [syn[key]];\n            array.unshift(key);\n            array = this.sortByLength(this.distinct(array)).map(function (term) {\n              return _this3.checkWildcardsEscape(term);\n            });\n            if (array.length > 1) {\n              var pattern = array.map(function (k) {\n                return _this3.escape(k);\n              }).join('|');\n              str = str.replace(new RegExp(pattern, flags), \"(?:\".concat(array.join('|'), \")\"));\n            }\n          }\n        }\n        return str;\n      }\n    }, {\n      key: \"checkWildcardsEscape\",\n      value: function checkWildcardsEscape(str) {\n        if (this.opt.wildcards !== 'disabled') {\n          str = str.replace(/(\\\\.)+|[?*]/g, function (m, gr) {\n            return gr ? m : m === '?' ? '\\x01' : '\\x02';\n          }).replace(/\\\\(?=[?*\\x01\\x02])/g, '');\n        }\n        return this.escape(str);\n      }\n    }, {\n      key: \"createWildcards\",\n      value: function createWildcards(str) {\n        var spaces = this.opt.wildcards === 'withSpaces',\n          boundary = this.opt.blockElementsBoundary,\n          anyChar = \"[^\".concat(spaces && boundary ? '\\x01' : '', \"]*?\");\n        return str.replace(/\\x01/g, spaces ? '[^]?' : '\\\\S?').replace(/\\x02/g, spaces ? anyChar : '\\\\S*');\n      }\n    }, {\n      key: \"setupIgnoreJoiners\",\n      value: function setupIgnoreJoiners(str) {\n        var reg = /((?:\\\\\\\\)+|\\x02|\\(\\?:|\\|)|\\\\?(?:[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|.)(?=([|)\\x02]|$)|.)/g;\n        return str.replace(reg, function (m, gr1, gr2) {\n          return gr1 || typeof gr2 !== 'undefined' ? m : m + '\\x00';\n        });\n      }\n    }, {\n      key: \"createJoiners\",\n      value: function createJoiners(str, joiners) {\n        return str.split(/\\x00+/).join(\"[\".concat(joiners, \"]*\"));\n      }\n    }, {\n      key: \"getJoinersPunctuation\",\n      value: function getJoinersPunctuation() {\n        var punct = this.preprocess(this.opt.ignorePunctuation),\n          str = punct ? punct : '';\n        if (this.opt.ignoreJoiners) {\n          str += \"\\\\u00ad\\\\u200b\\\\u200c\\\\u200d\";\n        }\n        return str;\n      }\n    }, {\n      key: \"createDiacritics\",\n      value: function createDiacritics(str) {\n        var _this4 = this;\n        var array = this.chars;\n        return str.split('').map(function (ch) {\n          for (var i = 0; i < array.length; i += 2) {\n            var lowerCase = array[i].indexOf(ch) !== -1;\n            if (_this4.opt.caseSensitive) {\n              if (lowerCase) {\n                return '[' + array[i] + ']';\n              } else if (array[i + 1].indexOf(ch) !== -1) {\n                return '[' + array[i + 1] + ']';\n              }\n            } else if (lowerCase || array[i + 1].indexOf(ch) !== -1) {\n              return '[' + array[i] + array[i + 1] + ']';\n            }\n          }\n          return ch;\n        }).join('');\n      }\n    }, {\n      key: \"createAccuracy\",\n      value: function createAccuracy(str) {\n        var chars = '!-/:-@[-`{-~¡¿';\n        var accuracy = this.opt.accuracy,\n          lookbehind = '()',\n          pattern = str,\n          lookahead = '',\n          limiters;\n        if (typeof accuracy !== 'string') {\n          limiters = this.preprocess(accuracy.limiters);\n          accuracy = accuracy.value;\n        }\n        if (accuracy === 'exactly') {\n          var charSet = limiters ? '[\\\\s' + limiters + ']' : '\\\\s';\n          lookbehind = \"(^|\".concat(charSet, \")\");\n          lookahead = \"(?=$|\".concat(charSet, \")\");\n        } else {\n          var chs = limiters || chars,\n            _charSet = \"[^\\\\s\".concat(chs, \"]*\");\n          if (accuracy === 'complementary') {\n            pattern = _charSet + str + _charSet;\n          } else if (accuracy === 'startsWith') {\n            lookbehind = \"(^|[\\\\s\".concat(chs, \"])\");\n            pattern = str.split(/\\[\\\\s\\]\\+/).join(_charSet + '[\\\\s]+') + _charSet;\n          }\n        }\n        return {\n          lookbehind: lookbehind,\n          pattern: pattern,\n          lookahead: lookahead\n        };\n      }\n    }]);\n    return RegExpCreator;\n  }();\n\n  var Mark$1 = /*#__PURE__*/function () {\n    function Mark(ctx) {\n      _classCallCheck(this, Mark);\n      this.ctx = ctx;\n      this.nodeNames = ['script', 'style', 'title', 'head', 'html'];\n    }\n    _createClass(Mark, [{\n      key: \"opt\",\n      get: function get() {\n        return this._opt;\n      },\n      set: function set(val) {\n        if (!(val && val.window && val.window.document) && typeof window === 'undefined') {\n          throw new Error('Mark.js: please provide a window object as an option.');\n        }\n        var win = val && val.window || window;\n        this._opt = _extends({}, {\n          'window': win,\n          'element': '',\n          'className': '',\n          'exclude': [],\n          'iframes': false,\n          'iframesTimeout': 5000,\n          'separateWordSearch': true,\n          'acrossElements': false,\n          'ignoreGroups': 0,\n          'each': function each() {},\n          'noMatch': function noMatch() {},\n          'filter': function filter() {\n            return true;\n          },\n          'done': function done() {},\n          'debug': false,\n          'log': win.console\n        }, val);\n        if (!this._opt.element) {\n          this._opt.element = 'mark';\n        }\n        this.filter = win.NodeFilter;\n        this.empty = win.document.createTextNode('');\n      }\n    }, {\n      key: \"iterator\",\n      get: function get() {\n        return new DOMIterator(this.ctx, this.opt);\n      }\n    }, {\n      key: \"log\",\n      value: function log(msg) {\n        var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'debug';\n        if (this.opt.debug) {\n          var log = this.opt.log;\n          if (_typeof(log) === 'object' && typeof log[level] === 'function') {\n            log[level](\"mark.js: \".concat(msg));\n          }\n        }\n      }\n    }, {\n      key: \"report\",\n      value: function report(array) {\n        var _this = this;\n        array.forEach(function (item) {\n          _this.log(\"\".concat(item.text, \" \").concat(JSON.stringify(item.obj)), item.level || 'debug');\n          if (!item.skip) {\n            _this.opt.noMatch(item.obj);\n          }\n        });\n      }\n    }, {\n      key: \"checkOption\",\n      value: function checkOption(opt, del) {\n        this.opt = opt;\n        var dict = this.cacheDict,\n          clear = true;\n        if (dict) {\n          if (!del && this.opt.cacheTextNodes) {\n            if (this.opt.acrossElements) {\n              if (dict.across) {\n                clear = false;\n              }\n            } else if (!dict.across) {\n              clear = false;\n            }\n          }\n          if (clear) {\n            this.cacheDict = null;\n          }\n        }\n      }\n    }, {\n      key: \"getSeachTerms\",\n      value: function getSeachTerms(sv) {\n        var search = typeof sv === 'string' ? [sv] : sv,\n          separate = this.opt.separateWordSearch,\n          array = [],\n          termStats = {},\n          split = function split(str) {\n            str.split(/ +/).forEach(function (word) {\n              return add(word);\n            });\n          },\n          add = function add(str) {\n            if (str.trim() && array.indexOf(str) === -1) {\n              array.push(str);\n              termStats[str] = 0;\n            }\n          };\n        search.forEach(function (str) {\n          if (separate) {\n            if (separate === 'preserveTerms') {\n              str.split(/\"(\"*[^\"]+\"*)\"/).forEach(function (term, i) {\n                if (i % 2 > 0) add(term);else split(term);\n              });\n            } else {\n              split(str);\n            }\n          } else {\n            add(str);\n          }\n        });\n        array.sort(function (a, b) {\n          return b.length - a.length;\n        });\n        return {\n          terms: array,\n          termStats: termStats\n        };\n      }\n    }, {\n      key: \"isNumeric\",\n      value: function isNumeric(value) {\n        return Number(parseFloat(value)) == value;\n      }\n    }, {\n      key: \"checkRanges\",\n      value: function checkRanges(array, logs, min, max) {\n        var _this2 = this;\n        var level = 'error';\n        var ranges = array.filter(function (range) {\n          if (_this2.isNumeric(range.start) && _this2.isNumeric(range.length)) {\n            range.start = parseInt(range.start);\n            range.length = parseInt(range.length);\n            if (range.start >= min && range.start < max && range.length > 0) {\n              return true;\n            }\n          }\n          logs.push({\n            text: 'Invalid range: ',\n            obj: range,\n            level: level\n          });\n          return false;\n        }).sort(function (a, b) {\n          return a.start - b.start;\n        });\n        if (this.opt.wrapAllRanges) {\n          return ranges;\n        }\n        var lastIndex = 0,\n          index;\n        return ranges.filter(function (range) {\n          index = range.start + range.length;\n          if (range.start >= lastIndex) {\n            lastIndex = index;\n            return true;\n          }\n          logs.push({\n            text: (index < lastIndex ? 'Nest' : 'Overlapp') + 'ing range: ',\n            obj: range,\n            level: level\n          });\n          return false;\n        });\n      }\n    }, {\n      key: \"setType\",\n      value: function setType(tags, boundary) {\n        var custom = Array.isArray(boundary.tagNames) && boundary.tagNames.length;\n        if (custom) {\n          boundary.tagNames.forEach(function (name) {\n            return tags[name.toLowerCase()] = 2;\n          });\n        }\n        if (!custom || boundary.extend) {\n          for (var key in tags) {\n            tags[key] = 2;\n          }\n        }\n        tags['br'] = 3;\n      }\n    }, {\n      key: \"getTextNodesAcross\",\n      value: function getTextNodesAcross(cb) {\n        var _this3 = this;\n        if (this.opt.cacheTextNodes && this.cacheDict) {\n          this.cacheDict.lastIndex = 0;\n          this.cacheDict.lastTextIndex = 0;\n          cb(this.cacheDict);\n          return;\n        }\n        var tags = {\n          div: 1,\n          p: 1,\n          li: 1,\n          td: 1,\n          tr: 1,\n          th: 1,\n          ul: 1,\n          ol: 1,\n          dd: 1,\n          dl: 1,\n          dt: 1,\n          h1: 1,\n          h2: 1,\n          h3: 1,\n          h4: 1,\n          h5: 1,\n          h6: 1,\n          hr: 1,\n          blockquote: 1,\n          figcaption: 1,\n          figure: 1,\n          pre: 1,\n          table: 1,\n          thead: 1,\n          tbody: 1,\n          tfoot: 1,\n          input: 1,\n          img: 1,\n          nav: 1,\n          details: 1,\n          label: 1,\n          form: 1,\n          select: 1,\n          menu: 1,\n          br: 3,\n          menuitem: 1,\n          main: 1,\n          section: 1,\n          article: 1,\n          aside: 1,\n          picture: 1,\n          output: 1,\n          button: 1,\n          header: 1,\n          footer: 1,\n          address: 1,\n          area: 1,\n          canvas: 1,\n          map: 1,\n          fieldset: 1,\n          textarea: 1,\n          track: 1,\n          video: 1,\n          audio: 1,\n          body: 1,\n          iframe: 1,\n          meter: 1,\n          object: 1,\n          svg: 1\n        };\n        var nodes = [],\n          boundary = this.opt.blockElementsBoundary,\n          priorityType = boundary ? 2 : 1;\n        var ch = '\\x01',\n          tempType,\n          type,\n          prevNode;\n        if (boundary) {\n          this.setType(tags, boundary);\n          if (boundary[\"char\"]) {\n            ch = boundary[\"char\"].charAt(0);\n          }\n        }\n        var obj = {\n          text: '',\n          regex: /\\s/,\n          tags: tags,\n          boundary: boundary,\n          startOffset: 0,\n          str: '',\n          ch: ch\n        };\n        this.iterator.forEachNode(this.filter.SHOW_ELEMENT | this.filter.SHOW_TEXT, function (node) {\n          if (prevNode) {\n            nodes.push(_this3.getNodeInfo(prevNode, node, type, obj));\n          }\n          type = null;\n          prevNode = node;\n        }, function (node) {\n          if (node.nodeType === 1) {\n            tempType = tags[node.nodeName.toLowerCase()];\n            if (tempType === 3) {\n              obj.str += '\\n';\n            }\n            if (!type || tempType === priorityType) {\n              type = tempType;\n            }\n            return false;\n          }\n          return !_this3.excluded(node.parentNode);\n        }, function () {\n          if (prevNode) {\n            nodes.push(_this3.getNodeInfo(prevNode, null, type, obj));\n          }\n          cb(_this3.createDict(obj.text, nodes, true));\n        });\n      }\n    }, {\n      key: \"getNodeInfo\",\n      value: function getNodeInfo(prevNode, node, type, obj) {\n        var start = obj.text.length,\n          startOffset = obj.startOffset,\n          ch = obj.ch;\n        var offset = 0,\n          str = obj.str,\n          text = prevNode.textContent;\n        if (node) {\n          var startBySpace = obj.regex.test(node.textContent[0]),\n            both = startBySpace && obj.regex.test(text[text.length - 1]);\n          if (obj.boundary || !both) {\n            var separate = type;\n            if (!type) {\n              var parent = prevNode.parentNode;\n              while (parent) {\n                type = obj.tags[parent.nodeName.toLowerCase()];\n                if (type) {\n                  separate = !(parent === node.parentNode || parent.contains(node));\n                  break;\n                }\n                parent = parent.parentNode;\n              }\n            }\n            if (separate) {\n              if (!both) {\n                str += type === 1 ? ' ' : type === 2 ? ' ' + ch + ' ' : '';\n              } else if (type === 2) {\n                str += both ? ch : startBySpace ? ' ' + ch : ch + ' ';\n              }\n            }\n          }\n        }\n        if (str) {\n          text += str;\n          offset = str.length;\n          obj.startOffset -= offset;\n          obj.str = '';\n        }\n        obj.text += text;\n        return this.createInfo(prevNode, start, obj.text.length - offset, offset, startOffset);\n      }\n    }, {\n      key: \"getTextNodes\",\n      value: function getTextNodes(cb) {\n        var _this4 = this;\n        if (this.opt.cacheTextNodes && this.cacheDict) {\n          cb(this.cacheDict);\n          return;\n        }\n        var nodes = [],\n          regex = /\\n/g,\n          newLines = [0],\n          lines = this.opt.markLines,\n          show = this.filter.SHOW_TEXT | (lines ? this.filter.SHOW_ELEMENT : 0);\n        var text = '',\n          len = 0,\n          rm;\n        this.iterator.forEachNode(show, function (node) {\n          if (lines) {\n            while ((rm = regex.exec(node.textContent)) !== null) {\n              newLines.push(len + rm.index);\n            }\n          }\n          text += node.textContent;\n          nodes.push({\n            start: len,\n            end: len = text.length,\n            offset: 0,\n            node: node\n          });\n        }, function (node) {\n          if (lines && node.nodeType === 1) {\n            if (node.tagName === 'BR') {\n              newLines.push(len);\n            }\n            return false;\n          }\n          return !_this4.excluded(node.parentNode);\n        }, function () {\n          var dict = _this4.createDict(text, nodes, false);\n          if (lines) {\n            newLines.push(len);\n            dict.newLines = newLines;\n          }\n          cb(dict);\n        });\n      }\n    }, {\n      key: \"createDict\",\n      value: function createDict(text, nodes, across) {\n        var dict = {\n          text: text,\n          nodes: nodes,\n          lastIndex: 0,\n          lastTextIndex: 0\n        };\n        if (this.opt.cacheTextNodes) {\n          this.cacheDict = dict;\n          this.cacheDict.across = across;\n        }\n        return dict;\n      }\n    }, {\n      key: \"excluded\",\n      value: function excluded(elem) {\n        return this.nodeNames.indexOf(elem.nodeName.toLowerCase()) !== -1 || DOMIterator.matches(elem, this.opt.exclude);\n      }\n    }, {\n      key: \"wrapRangeInsert\",\n      value: function wrapRangeInsert(dict, n, s, e, start, index) {\n        var ended = e === n.node.textContent.length,\n          end = n.end;\n        var type = 1,\n          splitIndex = e,\n          node = n.node;\n        if (s !== 0) {\n          node = node.splitText(s);\n          splitIndex = e - s;\n          type = ended ? 2 : 3;\n        } else if (ended) {\n          type = 0;\n        }\n        var retNode = ended ? this.empty : node.splitText(splitIndex),\n          mark = this.wrapTextNode(node),\n          markChild = mark.childNodes[0],\n          nodeInfo = this.createInfo(retNode, type === 0 || type === 2 ? end : n.start + e, end, n.offset, n.startOffset);\n        if (type === 0) {\n          n.node = markChild;\n          return {\n            mark: mark,\n            nodeInfo: nodeInfo,\n            increment: 0\n          };\n        }\n        var info = this.createInfo(markChild, type === 1 ? n.start : start, n.start + e, 0, n.startOffset);\n        if (type === 1) {\n          dict.nodes.splice(index, 1, info, nodeInfo);\n        } else {\n          if (type === 2) {\n            dict.nodes.splice(index + 1, 0, info);\n          } else {\n            dict.nodes.splice(index + 1, 0, info, nodeInfo);\n          }\n          n.end = start;\n          n.offset = 0;\n        }\n        return {\n          mark: mark,\n          nodeInfo: nodeInfo,\n          increment: type < 3 ? 1 : 2\n        };\n      }\n    }, {\n      key: \"createInfo\",\n      value: function createInfo(node, start, end, offset, startOffset) {\n        return {\n          node: node,\n          start: start,\n          end: end,\n          offset: offset,\n          startOffset: startOffset\n        };\n      }\n    }, {\n      key: \"wrapRange\",\n      value: function wrapRange(node, start, end, eachCb) {\n        var ended = end === node.textContent.length,\n          index = end,\n          retNode;\n        if (start !== 0) {\n          node = node.splitText(start);\n          index = end - start;\n        }\n        retNode = ended ? this.empty : node.splitText(index);\n        eachCb(this.wrapTextNode(node));\n        return retNode;\n      }\n    }, {\n      key: \"wrapTextNode\",\n      value: function wrapTextNode(node) {\n        var markNode = this.opt.window.document.createElement(this.opt.element);\n        markNode.setAttribute('data-markjs', 'true');\n        if (this.opt.className) {\n          markNode.setAttribute('class', this.opt.className);\n        }\n        markNode.textContent = node.textContent;\n        node.parentNode.replaceChild(markNode, node);\n        return markNode;\n      }\n    }, {\n      key: \"wrapRangeAcross\",\n      value: function wrapRangeAcross(dict, start, end, filterCb, eachCb) {\n        var i = dict.lastIndex,\n          rangeStart = true;\n        var wrapAllRanges = this.opt.wrapAllRanges || this.opt.cacheTextNodes;\n        if (wrapAllRanges) {\n          while (i > 0 && dict.nodes[i].start > start) {\n            i--;\n          }\n        } else if (start < dict.lastTextIndex) {\n          return;\n        }\n        for (i; i < dict.nodes.length; i++) {\n          if (i + 1 === dict.nodes.length || dict.nodes[i + 1].start > start) {\n            var n = dict.nodes[i];\n            if (!filterCb(n)) break;\n            var s = start - n.start,\n              e = (end > n.end ? n.end : end) - n.start;\n            if (s >= 0 && e > s) {\n              if (wrapAllRanges) {\n                var obj = this.wrapRangeInsert(dict, n, s, e, start, i);\n                n = obj.nodeInfo;\n                eachCb(obj.mark, rangeStart);\n              } else {\n                n.node = this.wrapRange(n.node, s, e, function (node) {\n                  eachCb(node, rangeStart);\n                });\n                n.start += e;\n                dict.lastTextIndex = n.start;\n              }\n              rangeStart = false;\n            }\n            if (end > n.end) {\n              start = n.end + n.offset;\n            } else {\n              break;\n            }\n          }\n        }\n        dict.lastIndex = i;\n      }\n    }, {\n      key: \"wrapGroups\",\n      value: function wrapGroups(node, match, params, filterCb, eachCb) {\n        var _this5 = this;\n        var startIndex = match.index,\n          isWrapped = false,\n          group,\n          start;\n        params.groups.forEach(function (index) {\n          group = match[index];\n          if (group) {\n            start = node.textContent.indexOf(group, startIndex);\n            if (start !== -1) {\n              if (filterCb(node, group, index)) {\n                node = _this5.wrapRange(node, start, start + group.length, function (node) {\n                  eachCb(node, index);\n                });\n                startIndex = 0;\n                isWrapped = true;\n              } else {\n                startIndex = start + group.length;\n              }\n            }\n          }\n        });\n        if (isWrapped) {\n          params.regex.lastIndex = 0;\n        }\n        return node;\n      }\n    }, {\n      key: \"wrapGroupsAcross\",\n      value: function wrapGroupsAcross(dict, match, params, filterCb, eachCb) {\n        var _this6 = this;\n        var startIndex = 0,\n          group,\n          start,\n          end;\n        var s = match.index,\n          text = match[0],\n          wrap = function wrap(start, end, index) {\n            _this6.wrapRangeAcross(dict, s + start, s + end, function (obj) {\n              return filterCb(obj, text, index);\n            }, function (node, groupStart) {\n              eachCb(node, groupStart, index);\n            });\n          };\n        if (this.opt.wrapAllRanges) {\n          wrap(0, text.length, 0);\n        }\n        params.groups.forEach(function (index) {\n          group = match[index];\n          if (group) {\n            start = text.indexOf(group, startIndex);\n            if (start !== -1) {\n              end = start + group.length;\n              wrap(start, end, index);\n              startIndex = end;\n            }\n          }\n        });\n      }\n    }, {\n      key: \"wrapGroupsDFlag\",\n      value: function wrapGroupsDFlag(node, match, params, filterCb, eachCb) {\n        var lastIndex = 0,\n          offset = 0,\n          i = 0,\n          isWrapped = false,\n          group,\n          start,\n          end = 0;\n        while (++i < match.length) {\n          group = match[i];\n          if (group) {\n            start = match.indices[i][0];\n            if (start >= lastIndex) {\n              end = match.indices[i][1];\n              if (filterCb(node, group, i)) {\n                node = this.wrapRange(node, start - offset, end - offset, function (node) {\n                  eachCb(node, i);\n                });\n                if (end > lastIndex) {\n                  lastIndex = end;\n                }\n                offset = end;\n                isWrapped = true;\n              }\n            }\n          }\n        }\n        if (isWrapped) {\n          params.regex.lastIndex = 0;\n        } else if (match[0].length === 0) {\n          this.setLastIndex(params.regex, end);\n        }\n        return node;\n      }\n    }, {\n      key: \"wrapGroupsDFlagAcross\",\n      value: function wrapGroupsDFlagAcross(dict, match, params, filterCb, eachCb) {\n        var lastIndex = 0,\n          i = 0,\n          group,\n          start,\n          end = 0,\n          isWrapped;\n        while (++i < match.length) {\n          group = match[i];\n          if (group) {\n            start = match.indices[i][0];\n            if (this.opt.wrapAllRanges || start >= lastIndex) {\n              end = match.indices[i][1];\n              isWrapped = false;\n              this.wrapRangeAcross(dict, start, end, function (obj) {\n                return filterCb(obj, group, i);\n              }, function (node, groupStart) {\n                isWrapped = true;\n                eachCb(node, groupStart, i);\n              });\n              if (isWrapped && end > lastIndex) {\n                lastIndex = end;\n              }\n            }\n          }\n        }\n        if (match[0].length === 0) {\n          this.setLastIndex(params.regex, end);\n        }\n      }\n    }, {\n      key: \"setLastIndex\",\n      value: function setLastIndex(regex, end) {\n        var index = regex.lastIndex;\n        regex.lastIndex = end > index ? end : end > 0 ? index + 1 : Infinity;\n      }\n    }, {\n      key: \"collectGroupIndexes\",\n      value: function collectGroupIndexes(regex) {\n        var groups = [],\n          stack = [],\n          index = 0,\n          brackets = 0,\n          str = regex.source,\n          rm,\n          reg = /(?:\\\\.)+|\\[(?:[^\\\\\\]]|(?:\\\\.))+\\]|(\\(\\?<(?![=!])|\\((?!\\?))|(\\()|(\\))/g;\n        while ((rm = reg.exec(str)) !== null) {\n          if (rm[1]) {\n            stack.push(1);\n            index++;\n            if (brackets++ === 0) {\n              groups.push(index);\n            }\n          } else if (rm[2]) {\n            stack.push(0);\n          } else if (rm[3] && stack.pop()) {\n            brackets--;\n          }\n        }\n        return groups;\n      }\n    }, {\n      key: \"wrapSeparateGroups\",\n      value: function wrapSeparateGroups(regex, unused, filterCb, eachCb, endCb) {\n        var _this7 = this;\n        var hasIndices = regex.hasIndices,\n          fn = hasIndices ? 'wrapGroupsDFlag' : 'wrapGroups',\n          params = {\n            regex: regex,\n            groups: hasIndices ? {} : this.collectGroupIndexes(regex)\n          },\n          execution = {\n            abort: false\n          },\n          info = {\n            execution: execution\n          };\n        var node,\n          match,\n          filterStart,\n          eachStart,\n          count = 0;\n        this.getTextNodes(function (dict) {\n          dict.nodes.every(function (obj) {\n            node = obj.node;\n            info.offset = obj.start;\n            while ((match = regex.exec(node.textContent)) !== null && (hasIndices || match[0] !== '')) {\n              info.match = match;\n              filterStart = eachStart = true;\n              node = _this7[fn](node, match, params, function (node, group, grIndex) {\n                info.matchStart = filterStart;\n                info.groupIndex = grIndex;\n                filterStart = false;\n                return filterCb(node, group, info);\n              }, function (node, grIndex) {\n                if (eachStart) {\n                  count++;\n                }\n                eachCb(node, {\n                  match: match,\n                  matchStart: eachStart,\n                  count: count,\n                  groupIndex: grIndex\n                });\n                eachStart = false;\n              });\n              if (execution.abort) break;\n            }\n            return !execution.abort;\n          });\n          endCb(count);\n        });\n      }\n    }, {\n      key: \"wrapSeparateGroupsAcross\",\n      value: function wrapSeparateGroupsAcross(regex, unused, filterCb, eachCb, endCb) {\n        var _this8 = this;\n        var hasIndices = regex.hasIndices,\n          fn = hasIndices ? 'wrapGroupsDFlagAcross' : 'wrapGroupsAcross',\n          params = {\n            regex: regex,\n            groups: hasIndices ? {} : this.collectGroupIndexes(regex)\n          },\n          execution = {\n            abort: false\n          },\n          info = {\n            execution: execution\n          };\n        var match,\n          filterStart,\n          eachStart,\n          count = 0;\n        this.getTextNodesAcross(function (dict) {\n          while ((match = regex.exec(dict.text)) !== null && (hasIndices || match[0] !== '')) {\n            info.match = match;\n            filterStart = eachStart = true;\n            _this8[fn](dict, match, params, function (obj, group, grIndex) {\n              info.matchStart = filterStart;\n              info.groupIndex = grIndex;\n              info.offset = obj.startOffset;\n              filterStart = false;\n              return filterCb(obj.node, group, info);\n            }, function (node, groupStart, grIndex) {\n              if (eachStart) {\n                count++;\n              }\n              eachCb(node, {\n                match: match,\n                matchStart: eachStart,\n                count: count,\n                groupIndex: grIndex,\n                groupStart: groupStart\n              });\n              eachStart = false;\n            });\n            if (execution.abort) break;\n          }\n          endCb(count);\n        });\n      }\n    }, {\n      key: \"wrapMatches\",\n      value: function wrapMatches(regex, ignoreGroups, filterCb, eachCb, endCb) {\n        var _this9 = this;\n        var index = ignoreGroups === 0 ? 0 : ignoreGroups + 1,\n          execution = {\n            abort: false\n          },\n          filterInfo = {\n            execution: execution\n          };\n        var info,\n          node,\n          match,\n          str,\n          count = 0;\n        this.getTextNodes(function (dict) {\n          for (var k = 0; k < dict.nodes.length; k++) {\n            info = dict.nodes[k];\n            node = info.node;\n            while ((match = regex.exec(node.textContent)) !== null && (str = match[index]) !== '') {\n              filterInfo.match = match;\n              filterInfo.offset = info.start;\n              if (!filterCb(node, str, filterInfo)) {\n                continue;\n              }\n              var i = 0,\n                start = match.index;\n              while (++i < index) {\n                if (match[i]) {\n                  start += match[i].length;\n                }\n              }\n              var end = start + str.length;\n              if (_this9.opt.cacheTextNodes) {\n                var obj = _this9.wrapRangeInsert(dict, info, start, end, info.start + start, k);\n                eachCb(obj.mark, {\n                  match: match,\n                  count: ++count\n                });\n                if (obj.increment === 0) break;\n                k += obj.increment;\n                info = obj.nodeInfo;\n                node = info.node;\n              } else {\n                node = _this9.wrapRange(node, start, end, function (node) {\n                  eachCb(node, {\n                    match: match,\n                    count: ++count\n                  });\n                });\n              }\n              regex.lastIndex = 0;\n              if (execution.abort) break;\n            }\n            if (execution.abort) break;\n          }\n          endCb(count);\n        });\n      }\n    }, {\n      key: \"wrapMatchesAcross\",\n      value: function wrapMatchesAcross(regex, ignoreGroups, filterCb, eachCb, endCb) {\n        var _this10 = this;\n        var index = ignoreGroups === 0 ? 0 : ignoreGroups + 1,\n          execution = {\n            abort: false\n          },\n          filterInfo = {\n            execution: execution\n          };\n        var match,\n          str,\n          matchStart,\n          count = 0;\n        this.getTextNodesAcross(function (dict) {\n          while ((match = regex.exec(dict.text)) !== null && (str = match[index]) !== '') {\n            filterInfo.match = match;\n            matchStart = true;\n            var i = 0,\n              start = match.index;\n            while (++i < index) {\n              if (match[i]) {\n                start += match[i].length;\n              }\n            }\n            _this10.wrapRangeAcross(dict, start, start + str.length, function (obj) {\n              filterInfo.matchStart = matchStart;\n              filterInfo.offset = obj.startOffset;\n              matchStart = false;\n              return filterCb(obj.node, str, filterInfo);\n            }, function (node, mStart) {\n              if (mStart) {\n                count++;\n              }\n              eachCb(node, {\n                match: match,\n                matchStart: mStart,\n                count: count\n              });\n            });\n            if (execution.abort) break;\n          }\n          endCb(count);\n        });\n      }\n    }, {\n      key: \"wrapRanges\",\n      value: function wrapRanges(ranges, filterCb, eachCb, endCb) {\n        var _this11 = this;\n        var lines = this.opt.markLines,\n          logs = [],\n          skipped = [],\n          level = 'warn';\n        var count = 0;\n        this.getTextNodes(function (dict) {\n          var max = lines ? dict.newLines.length : dict.text.length,\n            array = _this11.checkRanges(ranges, logs, lines ? 1 : 0, max);\n          array.forEach(function (range, index) {\n            var start = range.start,\n              end = start + range.length;\n            if (end > max) {\n              logs.push({\n                text: \"Range was limited to: \".concat(max),\n                obj: range,\n                skip: true,\n                level: level\n              });\n              end = max;\n            }\n            if (lines) {\n              start = dict.newLines[start - 1];\n              if (dict.text[start] === '\\n') {\n                start++;\n              }\n              end = dict.newLines[end - 1];\n            }\n            var substr = dict.text.substring(start, end);\n            if (substr.trim()) {\n              _this11.wrapRangeAcross(dict, start, end, function (obj) {\n                return filterCb(obj.node, range, substr, index);\n              }, function (node, rangeStart) {\n                if (rangeStart) {\n                  count++;\n                }\n                eachCb(node, range, {\n                  matchStart: rangeStart,\n                  count: count\n                });\n              });\n            } else {\n              logs.push({\n                text: 'Skipping whitespace only range: ',\n                obj: range,\n                level: level\n              });\n              skipped.push(range);\n            }\n          });\n          _this11.log(\"Valid ranges: \".concat(JSON.stringify(array.filter(function (range) {\n            return skipped.indexOf(range) === -1;\n          }))));\n          endCb(count, logs);\n        });\n      }\n    }, {\n      key: \"unwrapMatches\",\n      value: function unwrapMatches(node) {\n        var parent = node.parentNode,\n          first = node.firstChild;\n        if (node.childNodes.length === 1) {\n          if (first.nodeType === 3) {\n            var previous = node.previousSibling,\n              next = node.nextSibling;\n            if (previous && previous.nodeType === 3) {\n              if (next && next.nodeType === 3) {\n                previous.nodeValue += first.nodeValue + next.nodeValue;\n                parent.removeChild(next);\n              } else {\n                previous.nodeValue += first.nodeValue;\n              }\n            } else if (next && next.nodeType === 3) {\n              next.nodeValue = first.nodeValue + next.nodeValue;\n            } else {\n              parent.replaceChild(node.firstChild, node);\n              return;\n            }\n            parent.removeChild(node);\n          } else {\n            parent.replaceChild(node.firstChild, node);\n          }\n        } else {\n          if (!first) {\n            parent.removeChild(node);\n          } else {\n            var docFrag = this.opt.window.document.createDocumentFragment();\n            while (node.firstChild) {\n              docFrag.appendChild(node.removeChild(node.firstChild));\n            }\n            parent.replaceChild(docFrag, node);\n          }\n          parent.normalize();\n        }\n      }\n    }, {\n      key: \"markRegExp\",\n      value: function markRegExp(regexp, opt) {\n        var _this12 = this;\n        this.checkOption(opt);\n        var totalMarks = 0,\n          matchesSoFar = 0,\n          fn = this.opt.separateGroups ? 'wrapSeparateGroups' : 'wrapMatches';\n        if (this.opt.acrossElements) {\n          fn += 'Across';\n          if (!regexp.global && !regexp.sticky) {\n            var splits = regexp.toString().split('/');\n            regexp = new RegExp(regexp.source, 'g' + splits[splits.length - 1]);\n            this.log('RegExp is recompiled - it must have a `g` flag');\n          }\n        }\n        this.log(\"RegExp \\\"\".concat(regexp, \"\\\"\"));\n        this[fn](regexp, this.opt.ignoreGroups, function (node, match, filterInfo) {\n          return _this12.opt.filter(node, match, matchesSoFar, filterInfo);\n        }, function (element, eachInfo) {\n          matchesSoFar = eachInfo.count;\n          totalMarks++;\n          _this12.opt.each(element, eachInfo);\n        }, function (totalMatches) {\n          if (totalMatches === 0) {\n            _this12.opt.noMatch(regexp);\n          }\n          _this12.opt.done(totalMarks, totalMatches);\n        });\n      }\n    }, {\n      key: \"mark\",\n      value: function mark(sv, opt) {\n        var _this13 = this;\n        this.checkOption(opt);\n        var _this$getSeachTerms = this.getSeachTerms(sv),\n          terms = _this$getSeachTerms.terms,\n          termStats = _this$getSeachTerms.termStats;\n        if (!terms.length) {\n          this.opt.done(0, 0, termStats);\n          return;\n        }\n        if (this.opt.combinePatterns) {\n          this.markCombinePatterns(terms, termStats);\n          return;\n        }\n        var index = 0,\n          totalMarks = 0,\n          matches = 0,\n          totalMatches = 0,\n          termMatches;\n        var regCreator = new RegExpCreator(this.opt),\n          fn = this.opt.acrossElements ? 'wrapMatchesAcross' : 'wrapMatches';\n        var loop = function loop(term) {\n          termMatches = 0;\n          var regex = regCreator.create(term);\n          _this13.log(\"RegExp \\\"\".concat(regex, \"\\\"\"));\n          _this13[fn](regex, 1, function (node, t, filterInfo) {\n            matches = totalMatches + termMatches;\n            return _this13.opt.filter(node, term, matches, termMatches, filterInfo);\n          }, function (element, eachInfo) {\n            termMatches = eachInfo.count;\n            totalMarks++;\n            _this13.opt.each(element, eachInfo);\n          }, function (count) {\n            totalMatches += count;\n            if (count === 0) {\n              _this13.opt.noMatch(term);\n            }\n            termStats[term] = count;\n            if (++index < terms.length) {\n              loop(terms[index]);\n            } else {\n              _this13.opt.done(totalMarks, totalMatches, termStats);\n            }\n          });\n        };\n        loop(terms[index]);\n      }\n    }, {\n      key: \"markCombinePatterns\",\n      value: function markCombinePatterns(terms, termStats) {\n        var _this14 = this;\n        var index = 0,\n          totalMarks = 0,\n          totalMatches = 0,\n          term,\n          termMatches;\n        var across = this.opt.acrossElements,\n          fn = across ? 'wrapMatchesAcross' : 'wrapMatches',\n          flags = \"g\".concat(this.opt.caseSensitive ? '' : 'i'),\n          patterns = this.getPatterns(terms);\n        var loop = function loop(_ref) {\n          var pattern = _ref.pattern,\n            regTerms = _ref.regTerms;\n          var regex = new RegExp(pattern, flags);\n          _this14.log(\"RegExp \\\"\".concat(regex, \"\\\"\"));\n          _this14[fn](regex, 1, function (node, t, filterInfo) {\n            if (!across || filterInfo.matchStart) {\n              term = _this14.getCurrentTerm(filterInfo.match, regTerms);\n            }\n            termMatches = termStats[term];\n            return _this14.opt.filter(node, term, totalMatches + termMatches, termMatches, filterInfo);\n          }, function (element, eachInfo) {\n            totalMarks++;\n            if (!across || eachInfo.matchStart) {\n              termStats[term] += 1;\n            }\n            _this14.opt.each(element, eachInfo);\n          }, function (count) {\n            totalMatches += count;\n            var array = regTerms.filter(function (term) {\n              return termStats[term] === 0;\n            });\n            if (array.length) {\n              _this14.opt.noMatch(array);\n            }\n            if (++index < patterns.length) {\n              loop(patterns[index]);\n            } else {\n              _this14.opt.done(totalMarks, totalMatches, termStats);\n            }\n          });\n        };\n        loop(patterns[index]);\n      }\n    }, {\n      key: \"getCurrentTerm\",\n      value: function getCurrentTerm(match, terms) {\n        var i = match.length;\n        while (--i > 2) {\n          if (match[i]) {\n            return terms[i - 3];\n          }\n        }\n        return ' ';\n      }\n    }, {\n      key: \"getPatterns\",\n      value: function getPatterns(terms) {\n        var creator = new RegExpCreator(this.opt),\n          option = this.opt.combinePatterns,\n          length = terms.length,\n          array = [];\n        var num = 10,\n          value;\n        if (option === Infinity) {\n          num = length;\n        } else if (Number.isInteger(option) && (value = parseInt(option)) > 0) {\n          num = value;\n        }\n        for (var i = 0; i < length; i += num) {\n          var chunk = terms.slice(i, Math.min(i + num, length)),\n            obj = creator.createCombinePattern(chunk, true);\n          array.push({\n            pattern: \"\".concat(obj.lookbehind, \"(\").concat(obj.pattern, \")\").concat(obj.lookahead),\n            regTerms: chunk\n          });\n        }\n        return array;\n      }\n    }, {\n      key: \"markRanges\",\n      value: function markRanges(ranges, opt) {\n        var _this15 = this;\n        this.checkOption(opt, true);\n        if (Array.isArray(ranges)) {\n          var totalMarks = 0;\n          this.wrapRanges(ranges, function (node, range, match, index) {\n            return _this15.opt.filter(node, range, match, index);\n          }, function (elem, range, rangeInfo) {\n            totalMarks++;\n            _this15.opt.each(elem, range, rangeInfo);\n          }, function (totalRanges, logs) {\n            _this15.report(logs);\n            _this15.opt.done(totalMarks, totalRanges);\n          });\n        } else {\n          this.report([{\n            text: 'markRanges() accept an array of objects: ',\n            obj: ranges,\n            level: 'error'\n          }]);\n          this.opt.done(0, 0);\n        }\n      }\n    }, {\n      key: \"unmark\",\n      value: function unmark(opt) {\n        var _this16 = this;\n        this.checkOption(opt, true);\n        var selector = this.opt.element + '[data-markjs]';\n        if (this.opt.className) {\n          selector += \".\".concat(this.opt.className);\n        }\n        this.log(\"Removal selector \\\"\".concat(selector, \"\\\"\"));\n        this.iterator.forEachNode(this.filter.SHOW_ELEMENT, function (node) {\n          _this16.unwrapMatches(node);\n        }, function (node) {\n          return DOMIterator.matches(node, selector) && !_this16.excluded(node);\n        }, this.opt.done);\n      }\n    }]);\n    return Mark;\n  }();\n\n  function Mark(ctx) {\n    var _this = this;\n    var instance = new Mark$1(ctx);\n    this.mark = function (sv, opt) {\n      instance.mark(sv, opt);\n      return _this;\n    };\n    this.markRegExp = function (sv, opt) {\n      instance.markRegExp(sv, opt);\n      return _this;\n    };\n    this.markRanges = function (sv, opt) {\n      instance.markRanges(sv, opt);\n      return _this;\n    };\n    this.unmark = function (opt) {\n      instance.unmark(opt);\n      return _this;\n    };\n    this.getVersion = function () {\n      return '2.7.0';\n    };\n    return this;\n  }\n\n  return Mark;\n\n}));\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _scrollbar = require('./scrollbar');\n\nvar _scrollbar2 = _interopRequireDefault(_scrollbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _scrollbar2.default;\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _perfectScrollbar = require('perfect-scrollbar');\n\nvar _perfectScrollbar2 = _interopRequireDefault(_perfectScrollbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar handlerNameByEvent = {\n  'ps-scroll-y': 'onScrollY',\n  'ps-scroll-x': 'onScrollX',\n  'ps-scroll-up': 'onScrollUp',\n  'ps-scroll-down': 'onScrollDown',\n  'ps-scroll-left': 'onScrollLeft',\n  'ps-scroll-right': 'onScrollRight',\n  'ps-y-reach-start': 'onYReachStart',\n  'ps-y-reach-end': 'onYReachEnd',\n  'ps-x-reach-start': 'onXReachStart',\n  'ps-x-reach-end': 'onXReachEnd'\n};\nObject.freeze(handlerNameByEvent);\n\nvar ScrollBar = function (_Component) {\n  _inherits(ScrollBar, _Component);\n\n  function ScrollBar(props) {\n    _classCallCheck(this, ScrollBar);\n\n    var _this = _possibleConstructorReturn(this, (ScrollBar.__proto__ || Object.getPrototypeOf(ScrollBar)).call(this, props));\n\n    _this.handleRef = _this.handleRef.bind(_this);\n    _this._handlerByEvent = {};\n    return _this;\n  }\n\n  _createClass(ScrollBar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.props.option) {\n        console.warn('react-perfect-scrollbar: the \"option\" prop has been deprecated in favor of \"options\"');\n      }\n\n      this._ps = new _perfectScrollbar2.default(this._container, this.props.options || this.props.option);\n      // hook up events\n      this._updateEventHook();\n      this._updateClassName();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      this._updateEventHook(prevProps);\n\n      this.updateScroll();\n\n      if (prevProps.className !== this.props.className) {\n        this._updateClassName();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this2 = this;\n\n      // unhook up evens\n      Object.keys(this._handlerByEvent).forEach(function (key) {\n        var value = _this2._handlerByEvent[key];\n\n        if (value) {\n          _this2._container.removeEventListener(key, value, false);\n        }\n      });\n      this._handlerByEvent = {};\n      this._ps.destroy();\n      this._ps = null;\n    }\n  }, {\n    key: '_updateEventHook',\n    value: function _updateEventHook() {\n      var _this3 = this;\n\n      var prevProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      // hook up events\n      Object.keys(handlerNameByEvent).forEach(function (key) {\n        var callback = _this3.props[handlerNameByEvent[key]];\n        var prevCallback = prevProps[handlerNameByEvent[key]];\n        if (callback !== prevCallback) {\n          if (prevCallback) {\n            var prevHandler = _this3._handlerByEvent[key];\n            _this3._container.removeEventListener(key, prevHandler, false);\n            _this3._handlerByEvent[key] = null;\n          }\n          if (callback) {\n            var handler = function handler() {\n              return callback(_this3._container);\n            };\n            _this3._container.addEventListener(key, handler, false);\n            _this3._handlerByEvent[key] = handler;\n          }\n        }\n      });\n    }\n  }, {\n    key: '_updateClassName',\n    value: function _updateClassName() {\n      var className = this.props.className;\n\n\n      var psClassNames = this._container.className.split(' ').filter(function (name) {\n        return name.match(/^ps([-_].+|)$/);\n      }).join(' ');\n\n      if (this._container) {\n        this._container.className = 'scrollbar-container' + (className ? ' ' + className : '') + (psClassNames ? ' ' + psClassNames : '');\n      }\n    }\n  }, {\n    key: 'updateScroll',\n    value: function updateScroll() {\n      this.props.onSync(this._ps);\n    }\n  }, {\n    key: 'handleRef',\n    value: function handleRef(ref) {\n      this._container = ref;\n      this.props.containerRef(ref);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          style = _props.style,\n          option = _props.option,\n          options = _props.options,\n          containerRef = _props.containerRef,\n          onScrollY = _props.onScrollY,\n          onScrollX = _props.onScrollX,\n          onScrollUp = _props.onScrollUp,\n          onScrollDown = _props.onScrollDown,\n          onScrollLeft = _props.onScrollLeft,\n          onScrollRight = _props.onScrollRight,\n          onYReachStart = _props.onYReachStart,\n          onYReachEnd = _props.onYReachEnd,\n          onXReachStart = _props.onXReachStart,\n          onXReachEnd = _props.onXReachEnd,\n          component = _props.component,\n          onSync = _props.onSync,\n          children = _props.children,\n          remainProps = _objectWithoutProperties(_props, ['className', 'style', 'option', 'options', 'containerRef', 'onScrollY', 'onScrollX', 'onScrollUp', 'onScrollDown', 'onScrollLeft', 'onScrollRight', 'onYReachStart', 'onYReachEnd', 'onXReachStart', 'onXReachEnd', 'component', 'onSync', 'children']);\n\n      var Comp = component;\n\n      return _react2.default.createElement(\n        Comp,\n        _extends({ style: style, ref: this.handleRef }, remainProps),\n        children\n      );\n    }\n  }]);\n\n  return ScrollBar;\n}(_react.Component);\n\nexports.default = ScrollBar;\n\n\nScrollBar.defaultProps = {\n  className: '',\n  style: undefined,\n  option: undefined,\n  options: undefined,\n  containerRef: function containerRef() {},\n  onScrollY: undefined,\n  onScrollX: undefined,\n  onScrollUp: undefined,\n  onScrollDown: undefined,\n  onScrollLeft: undefined,\n  onScrollRight: undefined,\n  onYReachStart: undefined,\n  onYReachEnd: undefined,\n  onXReachStart: undefined,\n  onXReachEnd: undefined,\n  onSync: function onSync(ps) {\n    return ps.update();\n  },\n  component: 'div'\n};\n\nScrollBar.propTypes = {\n  children: _propTypes.PropTypes.node.isRequired,\n  className: _propTypes.PropTypes.string,\n  style: _propTypes.PropTypes.object,\n  option: _propTypes.PropTypes.object,\n  options: _propTypes.PropTypes.object,\n  containerRef: _propTypes.PropTypes.func,\n  onScrollY: _propTypes.PropTypes.func,\n  onScrollX: _propTypes.PropTypes.func,\n  onScrollUp: _propTypes.PropTypes.func,\n  onScrollDown: _propTypes.PropTypes.func,\n  onScrollLeft: _propTypes.PropTypes.func,\n  onScrollRight: _propTypes.PropTypes.func,\n  onYReachStart: _propTypes.PropTypes.func,\n  onYReachEnd: _propTypes.PropTypes.func,\n  onXReachStart: _propTypes.PropTypes.func,\n  onXReachEnd: _propTypes.PropTypes.func,\n  onSync: _propTypes.PropTypes.func,\n  component: _propTypes.PropTypes.string\n};\nmodule.exports = exports['default'];"],"names":[],"sourceRoot":""}